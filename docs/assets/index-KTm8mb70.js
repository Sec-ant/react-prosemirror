(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}})();function j1(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Zp={exports:{}},Wl={},em={exports:{}},B={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _o=Symbol.for("react.element"),K1=Symbol.for("react.portal"),q1=Symbol.for("react.fragment"),Q1=Symbol.for("react.strict_mode"),Y1=Symbol.for("react.profiler"),G1=Symbol.for("react.provider"),X1=Symbol.for("react.context"),Z1=Symbol.for("react.forward_ref"),eS=Symbol.for("react.suspense"),tS=Symbol.for("react.memo"),nS=Symbol.for("react.lazy"),gd=Symbol.iterator;function rS(n){return n===null||typeof n!="object"?null:(n=gd&&n[gd]||n["@@iterator"],typeof n=="function"?n:null)}var tm={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},nm=Object.assign,rm={};function ui(n,e,t){this.props=n,this.context=e,this.refs=rm,this.updater=t||tm}ui.prototype.isReactComponent={};ui.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};ui.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function im(){}im.prototype=ui.prototype;function Jc(n,e,t){this.props=n,this.context=e,this.refs=rm,this.updater=t||tm}var _c=Jc.prototype=new im;_c.constructor=Jc;nm(_c,ui.prototype);_c.isPureReactComponent=!0;var yd=Array.isArray,om=Object.prototype.hasOwnProperty,Wc={current:null},sm={key:!0,ref:!0,__self:!0,__source:!0};function lm(n,e,t){var r,i={},o=null,s=null;if(e!=null)for(r in e.ref!==void 0&&(s=e.ref),e.key!==void 0&&(o=""+e.key),e)om.call(e,r)&&!sm.hasOwnProperty(r)&&(i[r]=e[r]);var l=arguments.length-2;if(l===1)i.children=t;else if(1<l){for(var a=Array(l),u=0;u<l;u++)a[u]=arguments[u+2];i.children=a}if(n&&n.defaultProps)for(r in l=n.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:_o,type:n,key:o,ref:s,props:i,_owner:Wc.current}}function iS(n,e){return{$$typeof:_o,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function Uc(n){return typeof n=="object"&&n!==null&&n.$$typeof===_o}function oS(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var Sd=/\/+/g;function ha(n,e){return typeof n=="object"&&n!==null&&n.key!=null?oS(""+n.key):e.toString(36)}function Rs(n,e,t,r,i){var o=typeof n;(o==="undefined"||o==="boolean")&&(n=null);var s=!1;if(n===null)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(n.$$typeof){case _o:case K1:s=!0}}if(s)return s=n,i=i(s),n=r===""?"."+ha(s,0):r,yd(i)?(t="",n!=null&&(t=n.replace(Sd,"$&/")+"/"),Rs(i,e,t,"",function(u){return u})):i!=null&&(Uc(i)&&(i=iS(i,t+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(Sd,"$&/")+"/")+n)),e.push(i)),1;if(s=0,r=r===""?".":r+":",yd(n))for(var l=0;l<n.length;l++){o=n[l];var a=r+ha(o,l);s+=Rs(o,e,t,a,i)}else if(a=rS(n),typeof a=="function")for(n=a.call(n),l=0;!(o=n.next()).done;)o=o.value,a=r+ha(o,l++),s+=Rs(o,e,t,a,i);else if(o==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return s}function rs(n,e,t){if(n==null)return n;var r=[],i=0;return Rs(n,r,"","",function(o){return e.call(t,o,i++)}),r}function sS(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var be={current:null},As={transition:null},lS={ReactCurrentDispatcher:be,ReactCurrentBatchConfig:As,ReactCurrentOwner:Wc};B.Children={map:rs,forEach:function(n,e,t){rs(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return rs(n,function(){e++}),e},toArray:function(n){return rs(n,function(e){return e})||[]},only:function(n){if(!Uc(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};B.Component=ui;B.Fragment=q1;B.Profiler=Y1;B.PureComponent=Jc;B.StrictMode=Q1;B.Suspense=eS;B.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=lS;B.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=nm({},n.props),i=n.key,o=n.ref,s=n._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,s=Wc.current),e.key!==void 0&&(i=""+e.key),n.type&&n.type.defaultProps)var l=n.type.defaultProps;for(a in e)om.call(e,a)&&!sm.hasOwnProperty(a)&&(r[a]=e[a]===void 0&&l!==void 0?l[a]:e[a])}var a=arguments.length-2;if(a===1)r.children=t;else if(1<a){l=Array(a);for(var u=0;u<a;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:_o,type:n.type,key:i,ref:o,props:r,_owner:s}};B.createContext=function(n){return n={$$typeof:X1,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:G1,_context:n},n.Consumer=n};B.createElement=lm;B.createFactory=function(n){var e=lm.bind(null,n);return e.type=n,e};B.createRef=function(){return{current:null}};B.forwardRef=function(n){return{$$typeof:Z1,render:n}};B.isValidElement=Uc;B.lazy=function(n){return{$$typeof:nS,_payload:{_status:-1,_result:n},_init:sS}};B.memo=function(n,e){return{$$typeof:tS,type:n,compare:e===void 0?null:e}};B.startTransition=function(n){var e=As.transition;As.transition={};try{n()}finally{As.transition=e}};B.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};B.useCallback=function(n,e){return be.current.useCallback(n,e)};B.useContext=function(n){return be.current.useContext(n)};B.useDebugValue=function(){};B.useDeferredValue=function(n){return be.current.useDeferredValue(n)};B.useEffect=function(n,e){return be.current.useEffect(n,e)};B.useId=function(){return be.current.useId()};B.useImperativeHandle=function(n,e,t){return be.current.useImperativeHandle(n,e,t)};B.useInsertionEffect=function(n,e){return be.current.useInsertionEffect(n,e)};B.useLayoutEffect=function(n,e){return be.current.useLayoutEffect(n,e)};B.useMemo=function(n,e){return be.current.useMemo(n,e)};B.useReducer=function(n,e,t){return be.current.useReducer(n,e,t)};B.useRef=function(n){return be.current.useRef(n)};B.useState=function(n){return be.current.useState(n)};B.useSyncExternalStore=function(n,e,t){return be.current.useSyncExternalStore(n,e,t)};B.useTransition=function(){return be.current.useTransition()};B.version="18.2.0";em.exports=B;var C=em.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aS=C,uS=Symbol.for("react.element"),cS=Symbol.for("react.fragment"),fS=Object.prototype.hasOwnProperty,dS=aS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,hS={key:!0,ref:!0,__self:!0,__source:!0};function am(n,e,t){var r,i={},o=null,s=null;t!==void 0&&(o=""+t),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(s=e.ref);for(r in e)fS.call(e,r)&&!hS.hasOwnProperty(r)&&(i[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:uS,type:n,key:o,ref:s,props:i,_owner:dS.current}}Wl.Fragment=cS;Wl.jsx=am;Wl.jsxs=am;Zp.exports=Wl;var I=Zp.exports;function de(n){this.content=n}de.prototype={constructor:de,find:function(n){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===n)return e;return-1},get:function(n){var e=this.find(n);return e==-1?void 0:this.content[e+1]},update:function(n,e,t){var r=t&&t!=n?this.remove(t):this,i=r.find(n),o=r.content.slice();return i==-1?o.push(t||n,e):(o[i+1]=e,t&&(o[i]=t)),new de(o)},remove:function(n){var e=this.find(n);if(e==-1)return this;var t=this.content.slice();return t.splice(e,2),new de(t)},addToStart:function(n,e){return new de([n,e].concat(this.remove(n).content))},addToEnd:function(n,e){var t=this.remove(n).content.slice();return t.push(n,e),new de(t)},addBefore:function(n,e,t){var r=this.remove(e),i=r.content.slice(),o=r.find(n);return i.splice(o==-1?i.length:o,0,e,t),new de(i)},forEach:function(n){for(var e=0;e<this.content.length;e+=2)n(this.content[e],this.content[e+1])},prepend:function(n){return n=de.from(n),n.size?new de(n.content.concat(this.subtract(n).content)):this},append:function(n){return n=de.from(n),n.size?new de(this.subtract(n).content.concat(n.content)):this},subtract:function(n){var e=this;n=de.from(n);for(var t=0;t<n.content.length;t+=2)e=e.remove(n.content[t]);return e},toObject:function(){var n={};return this.forEach(function(e,t){n[e]=t}),n},get size(){return this.content.length>>1}};de.from=function(n){if(n instanceof de)return n;var e=[];if(n)for(var t in n)e.push(t,n[t]);return new de(e)};function um(n,e,t){for(let r=0;;r++){if(r==n.childCount||r==e.childCount)return n.childCount==e.childCount?null:t;let i=n.child(r),o=e.child(r);if(i==o){t+=i.nodeSize;continue}if(!i.sameMarkup(o))return t;if(i.isText&&i.text!=o.text){for(let s=0;i.text[s]==o.text[s];s++)t++;return t}if(i.content.size||o.content.size){let s=um(i.content,o.content,t+1);if(s!=null)return s}t+=i.nodeSize}}function cm(n,e,t,r){for(let i=n.childCount,o=e.childCount;;){if(i==0||o==0)return i==o?null:{a:t,b:r};let s=n.child(--i),l=e.child(--o),a=s.nodeSize;if(s==l){t-=a,r-=a;continue}if(!s.sameMarkup(l))return{a:t,b:r};if(s.isText&&s.text!=l.text){let u=0,c=Math.min(s.text.length,l.text.length);for(;u<c&&s.text[s.text.length-u-1]==l.text[l.text.length-u-1];)u++,t--,r--;return{a:t,b:r}}if(s.content.size||l.content.size){let u=cm(s.content,l.content,t-1,r-1);if(u)return u}t-=a,r-=a}}class v{constructor(e,t){if(this.content=e,this.size=t||0,t==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,t,r,i=0,o){for(let s=0,l=0;l<t;s++){let a=this.content[s],u=l+a.nodeSize;if(u>e&&r(a,i+l,o||null,s)!==!1&&a.content.size){let c=l+1;a.nodesBetween(Math.max(0,e-c),Math.min(a.content.size,t-c),r,i+c)}l=u}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,r,i){let o="",s=!0;return this.nodesBetween(e,t,(l,a)=>{let u=l.isText?l.text.slice(Math.max(e,a)-a,t-a):l.isLeaf?i?typeof i=="function"?i(l):i:l.type.spec.leafText?l.type.spec.leafText(l):"":"";l.isBlock&&(l.isLeaf&&u||l.isTextblock)&&r&&(s?s=!1:o+=r),o+=u},0),o}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,r=e.firstChild,i=this.content.slice(),o=0;for(t.isText&&t.sameMarkup(r)&&(i[i.length-1]=t.withText(t.text+r.text),o=1);o<e.content.length;o++)i.push(e.content[o]);return new v(i,this.size+e.size)}cut(e,t=this.size){if(e==0&&t==this.size)return this;let r=[],i=0;if(t>e)for(let o=0,s=0;s<t;o++){let l=this.content[o],a=s+l.nodeSize;a>e&&((s<e||a>t)&&(l.isText?l=l.cut(Math.max(0,e-s),Math.min(l.text.length,t-s)):l=l.cut(Math.max(0,e-s-1),Math.min(l.content.size,t-s-1))),r.push(l),i+=l.nodeSize),s=a}return new v(r,i)}cutByIndex(e,t){return e==t?v.empty:e==0&&t==this.content.length?this:new v(this.content.slice(e,t))}replaceChild(e,t){let r=this.content[e];if(r==t)return this;let i=this.content.slice(),o=this.size+t.nodeSize-r.nodeSize;return i[e]=t,new v(i,o)}addToStart(e){return new v([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new v(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,r=0;t<this.content.length;t++){let i=this.content[t];e(i,r,t),r+=i.nodeSize}}findDiffStart(e,t=0){return um(this,e,t)}findDiffEnd(e,t=this.size,r=e.size){return cm(this,e,t,r)}findIndex(e,t=-1){if(e==0)return is(0,e);if(e==this.size)return is(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let r=0,i=0;;r++){let o=this.child(r),s=i+o.nodeSize;if(s>=e)return s==e||t>0?is(r+1,s):is(r,i);i=s}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return v.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new v(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return v.empty;let t,r=0;for(let i=0;i<e.length;i++){let o=e[i];r+=o.nodeSize,i&&o.isText&&e[i-1].sameMarkup(o)?(t||(t=e.slice(0,i)),t[t.length-1]=o.withText(t[t.length-1].text+o.text)):t&&t.push(o)}return new v(t||e,r)}static from(e){if(!e)return v.empty;if(e instanceof v)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new v([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}v.empty=new v([],0);const pa={index:0,offset:0};function is(n,e){return pa.index=n,pa.offset=e,pa}function ol(n,e){if(n===e)return!0;if(!(n&&typeof n=="object")||!(e&&typeof e=="object"))return!1;let t=Array.isArray(n);if(Array.isArray(e)!=t)return!1;if(t){if(n.length!=e.length)return!1;for(let r=0;r<n.length;r++)if(!ol(n[r],e[r]))return!1}else{for(let r in n)if(!(r in e)||!ol(n[r],e[r]))return!1;for(let r in e)if(!(r in n))return!1}return!0}class _{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,r=!1;for(let i=0;i<e.length;i++){let o=e[i];if(this.eq(o))return e;if(this.type.excludes(o.type))t||(t=e.slice(0,i));else{if(o.type.excludes(this.type))return e;!r&&o.type.rank>this.type.rank&&(t||(t=e.slice(0,i)),t.push(this),r=!0),t&&t.push(o)}}return t||(t=e.slice()),r||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&ol(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[t.type];if(!r)throw new RangeError(`There is no mark type ${t.type} in this schema`);return r.create(t.attrs)}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(t[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return _.none;if(e instanceof _)return[e];let t=e.slice();return t.sort((r,i)=>r.type.rank-i.type.rank),t}}_.none=[];class En extends Error{}class w{constructor(e,t,r){this.content=e,this.openStart=t,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let r=dm(this.content,e+this.openStart,t);return r&&new w(r,this.openStart,this.openEnd)}removeBetween(e,t){return new w(fm(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return w.empty;let r=t.openStart||0,i=t.openEnd||0;if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new w(v.fromJSON(e,t.content),r,i)}static maxOpen(e,t=!0){let r=0,i=0;for(let o=e.firstChild;o&&!o.isLeaf&&(t||!o.type.spec.isolating);o=o.firstChild)r++;for(let o=e.lastChild;o&&!o.isLeaf&&(t||!o.type.spec.isolating);o=o.lastChild)i++;return new w(e,r,i)}}w.empty=new w(v.empty,0,0);function fm(n,e,t){let{index:r,offset:i}=n.findIndex(e),o=n.maybeChild(r),{index:s,offset:l}=n.findIndex(t);if(i==e||o.isText){if(l!=t&&!n.child(s).isText)throw new RangeError("Removing non-flat range");return n.cut(0,e).append(n.cut(t))}if(r!=s)throw new RangeError("Removing non-flat range");return n.replaceChild(r,o.copy(fm(o.content,e-i-1,t-i-1)))}function dm(n,e,t,r){let{index:i,offset:o}=n.findIndex(e),s=n.maybeChild(i);if(o==e||s.isText)return n.cut(0,e).append(t).append(n.cut(e));let l=dm(s.content,e-o-1,t);return l&&n.replaceChild(i,s.copy(l))}function pS(n,e,t){if(t.openStart>n.depth)throw new En("Inserted content deeper than insertion position");if(n.depth-t.openStart!=e.depth-t.openEnd)throw new En("Inconsistent open depths");return hm(n,e,t,0)}function hm(n,e,t,r){let i=n.index(r),o=n.node(r);if(i==e.index(r)&&r<n.depth-t.openStart){let s=hm(n,e,t,r+1);return o.copy(o.content.replaceChild(i,s))}else if(t.content.size)if(!t.openStart&&!t.openEnd&&n.depth==r&&e.depth==r){let s=n.parent,l=s.content;return Gn(s,l.cut(0,n.parentOffset).append(t.content).append(l.cut(e.parentOffset)))}else{let{start:s,end:l}=mS(t,n);return Gn(o,mm(n,s,l,e,r))}else return Gn(o,sl(n,e,r))}function pm(n,e){if(!e.type.compatibleContent(n.type))throw new En("Cannot join "+e.type.name+" onto "+n.type.name)}function gu(n,e,t){let r=n.node(t);return pm(r,e.node(t)),r}function Yn(n,e){let t=e.length-1;t>=0&&n.isText&&n.sameMarkup(e[t])?e[t]=n.withText(e[t].text+n.text):e.push(n)}function Qi(n,e,t,r){let i=(e||n).node(t),o=0,s=e?e.index(t):i.childCount;n&&(o=n.index(t),n.depth>t?o++:n.textOffset&&(Yn(n.nodeAfter,r),o++));for(let l=o;l<s;l++)Yn(i.child(l),r);e&&e.depth==t&&e.textOffset&&Yn(e.nodeBefore,r)}function Gn(n,e){return n.type.checkContent(e),n.copy(e)}function mm(n,e,t,r,i){let o=n.depth>i&&gu(n,e,i+1),s=r.depth>i&&gu(t,r,i+1),l=[];return Qi(null,n,i,l),o&&s&&e.index(i)==t.index(i)?(pm(o,s),Yn(Gn(o,mm(n,e,t,r,i+1)),l)):(o&&Yn(Gn(o,sl(n,e,i+1)),l),Qi(e,t,i,l),s&&Yn(Gn(s,sl(t,r,i+1)),l)),Qi(r,null,i,l),new v(l)}function sl(n,e,t){let r=[];if(Qi(null,n,t,r),n.depth>t){let i=gu(n,e,t+1);Yn(Gn(i,sl(n,e,t+1)),r)}return Qi(e,null,t,r),new v(r)}function mS(n,e){let t=e.depth-n.openStart,i=e.node(t).copy(n.content);for(let o=t-1;o>=0;o--)i=e.node(o).copy(v.from(i));return{start:i.resolveNoCache(n.openStart+t),end:i.resolveNoCache(i.content.size-n.openEnd-t)}}class fo{constructor(e,t,r){this.pos=e,this.path=t,this.parentOffset=r,this.depth=t.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],i=e.child(t);return r?e.child(t).cut(r):i}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):e==0?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let r=this.path[t*3],i=t==0?0:this.path[t*3-1]+1;for(let o=0;o<e;o++)i+=r.child(o).nodeSize;return i}marks(){let e=this.parent,t=this.index();if(e.content.size==0)return _.none;if(this.textOffset)return e.child(t).marks;let r=e.maybeChild(t-1),i=e.maybeChild(t);if(!r){let l=r;r=i,i=l}let o=r.marks;for(var s=0;s<o.length;s++)o[s].type.spec.inclusive===!1&&(!i||!o[s].isInSet(i.marks))&&(o=o[s--].removeFromSet(o));return o}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let r=t.marks,i=e.parent.maybeChild(e.index());for(var o=0;o<r.length;o++)r[o].type.spec.inclusive===!1&&(!i||!r[o].isInSet(i.marks))&&(r=r[o--].removeFromSet(r));return r}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!t||t(this.node(r))))return new yS(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let r=[],i=0,o=t;for(let s=e;;){let{index:l,offset:a}=s.content.findIndex(o),u=o-a;if(r.push(s,l,i+a),!u||(s=s.child(l),s.isText))break;o=u-1,i+=a+1}return new fo(t,r,o)}static resolveCached(e,t){for(let i=0;i<ma.length;i++){let o=ma[i];if(o.pos==t&&o.doc==e)return o}let r=ma[ga]=fo.resolve(e,t);return ga=(ga+1)%gS,r}}let ma=[],ga=0,gS=12;class yS{constructor(e,t,r){this.$from=e,this.$to=t,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const SS=Object.create(null);class Ot{constructor(e,t,r,i=_.none){this.type=e,this.attrs=t,this.marks=i,this.content=r||v.empty}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,r,i=0){this.content.nodesBetween(e,t,r,i,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,r,i){return this.content.textBetween(e,t,r,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,r){return this.type==e&&ol(this.attrs,t||e.defaultAttrs||SS)&&_.sameSet(this.marks,r||_.none)}copy(e=null){return e==this.content?this:new Ot(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new Ot(this.type,this.attrs,this.content,e)}cut(e,t=this.content.size){return e==0&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,r=!1){if(e==t)return w.empty;let i=this.resolve(e),o=this.resolve(t),s=r?0:i.sharedDepth(t),l=i.start(s),u=i.node(s).content.cut(i.pos-l,o.pos-l);return new w(u,i.depth-s,o.depth-s)}replace(e,t,r){return pS(this.resolve(e),this.resolve(t),r)}nodeAt(e){for(let t=this;;){let{index:r,offset:i}=t.content.findIndex(e);if(t=t.maybeChild(r),!t)return null;if(i==e||t.isText)return t;e-=i+1}}childAfter(e){let{index:t,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:t,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(t),index:t,offset:r};let i=this.content.child(t-1);return{node:i,index:t-1,offset:r-i.nodeSize}}resolve(e){return fo.resolveCached(this,e)}resolveNoCache(e){return fo.resolve(this,e)}rangeHasMark(e,t,r){let i=!1;return t>e&&this.nodesBetween(e,t,o=>(r.isInSet(o.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),gm(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,r=v.empty,i=0,o=r.childCount){let s=this.contentMatchAt(e).matchFragment(r,i,o),l=s&&s.matchFragment(this.content,t);if(!l||!l.validEnd)return!1;for(let a=i;a<o;a++)if(!this.type.allowsMarks(r.child(a).marks))return!1;return!0}canReplaceWith(e,t,r,i){if(i&&!this.type.allowsMarks(i))return!1;let o=this.contentMatchAt(e).matchType(r),s=o&&o.matchFragment(this.content,t);return s?s.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content);let e=_.none;for(let t=0;t<this.marks.length;t++)e=this.marks[t].addToSet(e);if(!_.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(t=>t.type.name)}`);this.content.forEach(t=>t.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(t=>t.toJSON())),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let r=null;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=t.marks.map(e.markFromJSON)}if(t.type=="text"){if(typeof t.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(t.text,r)}let i=v.fromJSON(e,t.content);return e.nodeType(t.type).create(t.attrs,i,r)}}Ot.prototype.text=void 0;class ll extends Ot{constructor(e,t,r,i){if(super(e,t,null,i),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):gm(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new ll(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new ll(this.type,this.attrs,e,this.marks)}cut(e=0,t=this.text.length){return e==0&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function gm(n,e){for(let t=n.length-1;t>=0;t--)e=n[t].type.name+"("+e+")";return e}class nr{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){let r=new kS(e,t);if(r.next==null)return nr.empty;let i=ym(r);r.next&&r.err("Unexpected trailing text");let o=ES(MS(i));return OS(o,r),o}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,r=e.childCount){let i=this;for(let o=t;i&&o<r;o++)i=i.matchType(e.child(o).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!(t.isText||t.hasRequiredAttrs()))return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let r=0;r<e.next.length;r++)if(this.next[t].type==e.next[r].type)return!0;return!1}fillBefore(e,t=!1,r=0){let i=[this];function o(s,l){let a=s.matchFragment(e,r);if(a&&(!t||a.validEnd))return v.from(l.map(u=>u.createAndFill()));for(let u=0;u<s.next.length;u++){let{type:c,next:f}=s.next[u];if(!(c.isText||c.hasRequiredAttrs())&&i.indexOf(f)==-1){i.push(f);let d=o(f,l.concat(c));if(d)return d}}return null}return o(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let i=r.shift(),o=i.match;if(o.matchType(e)){let s=[];for(let l=i;l.type;l=l.via)s.push(l.type);return s.reverse()}for(let s=0;s<o.next.length;s++){let{type:l,next:a}=o.next[s];!l.isLeaf&&!l.hasRequiredAttrs()&&!(l.name in t)&&(!i.type||a.validEnd)&&(r.push({match:l.contentMatch,type:l,via:i}),t[l.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function t(r){e.push(r);for(let i=0;i<r.next.length;i++)e.indexOf(r.next[i].next)==-1&&t(r.next[i].next)}return t(this),e.map((r,i)=>{let o=i+(r.validEnd?"*":" ")+" ";for(let s=0;s<r.next.length;s++)o+=(s?", ":"")+r.next[s].type.name+"->"+e.indexOf(r.next[s].next);return o}).join(`
`)}}nr.empty=new nr(!0);class kS{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function ym(n){let e=[];do e.push(wS(n));while(n.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function wS(n){let e=[];do e.push(vS(n));while(n.next&&n.next!=")"&&n.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function vS(n){let e=NS(n);for(;;)if(n.eat("+"))e={type:"plus",expr:e};else if(n.eat("*"))e={type:"star",expr:e};else if(n.eat("?"))e={type:"opt",expr:e};else if(n.eat("{"))e=xS(n,e);else break;return e}function kd(n){/\D/.test(n.next)&&n.err("Expected number, got '"+n.next+"'");let e=Number(n.next);return n.pos++,e}function xS(n,e){let t=kd(n),r=t;return n.eat(",")&&(n.next!="}"?r=kd(n):r=-1),n.eat("}")||n.err("Unclosed braced range"),{type:"range",min:t,max:r,expr:e}}function CS(n,e){let t=n.nodeTypes,r=t[e];if(r)return[r];let i=[];for(let o in t){let s=t[o];s.groups.indexOf(e)>-1&&i.push(s)}return i.length==0&&n.err("No node type or group '"+e+"' found"),i}function NS(n){if(n.eat("(")){let e=ym(n);return n.eat(")")||n.err("Missing closing paren"),e}else if(/\W/.test(n.next))n.err("Unexpected token '"+n.next+"'");else{let e=CS(n,n.next).map(t=>(n.inline==null?n.inline=t.isInline:n.inline!=t.isInline&&n.err("Mixing inline and block content"),{type:"name",value:t}));return n.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function MS(n){let e=[[]];return i(o(n,0),t()),e;function t(){return e.push([])-1}function r(s,l,a){let u={term:a,to:l};return e[s].push(u),u}function i(s,l){s.forEach(a=>a.to=l)}function o(s,l){if(s.type=="choice")return s.exprs.reduce((a,u)=>a.concat(o(u,l)),[]);if(s.type=="seq")for(let a=0;;a++){let u=o(s.exprs[a],l);if(a==s.exprs.length-1)return u;i(u,l=t())}else if(s.type=="star"){let a=t();return r(l,a),i(o(s.expr,a),a),[r(a)]}else if(s.type=="plus"){let a=t();return i(o(s.expr,l),a),i(o(s.expr,a),a),[r(a)]}else{if(s.type=="opt")return[r(l)].concat(o(s.expr,l));if(s.type=="range"){let a=l;for(let u=0;u<s.min;u++){let c=t();i(o(s.expr,a),c),a=c}if(s.max==-1)i(o(s.expr,a),a);else for(let u=s.min;u<s.max;u++){let c=t();r(a,c),i(o(s.expr,a),c),a=c}return[r(a)]}else{if(s.type=="name")return[r(l,void 0,s.value)];throw new Error("Unknown expr type")}}}}function Sm(n,e){return e-n}function wd(n,e){let t=[];return r(e),t.sort(Sm);function r(i){let o=n[i];if(o.length==1&&!o[0].term)return r(o[0].to);t.push(i);for(let s=0;s<o.length;s++){let{term:l,to:a}=o[s];!l&&t.indexOf(a)==-1&&r(a)}}}function ES(n){let e=Object.create(null);return t(wd(n,0));function t(r){let i=[];r.forEach(s=>{n[s].forEach(({term:l,to:a})=>{if(!l)return;let u;for(let c=0;c<i.length;c++)i[c][0]==l&&(u=i[c][1]);wd(n,a).forEach(c=>{u||i.push([l,u=[]]),u.indexOf(c)==-1&&u.push(c)})})});let o=e[r.join(",")]=new nr(r.indexOf(n.length-1)>-1);for(let s=0;s<i.length;s++){let l=i[s][1].sort(Sm);o.next.push({type:i[s][0],next:e[l.join(",")]||t(l)})}return o}}function OS(n,e){for(let t=0,r=[n];t<r.length;t++){let i=r[t],o=!i.validEnd,s=[];for(let l=0;l<i.next.length;l++){let{type:a,next:u}=i.next[l];s.push(a.name),o&&!(a.isText||a.hasRequiredAttrs())&&(o=!1),r.indexOf(u)==-1&&r.push(u)}o&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function km(n){let e=Object.create(null);for(let t in n){let r=n[t];if(!r.hasDefault)return null;e[t]=r.default}return e}function wm(n,e){let t=Object.create(null);for(let r in n){let i=e&&e[r];if(i===void 0){let o=n[r];if(o.hasDefault)i=o.default;else throw new RangeError("No value supplied for attribute "+r)}t[r]=i}return t}function vm(n){let e=Object.create(null);if(n)for(let t in n)e[t]=new DS(n[t]);return e}let vd=class xm{constructor(e,t,r){this.name=e,this.schema=t,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=vm(r.attrs),this.defaultAttrs=km(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==nr.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:wm(this.attrs,e)}create(e=null,t,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Ot(this,this.computeAttrs(e),v.from(t),_.setFrom(r))}createChecked(e=null,t,r){return t=v.from(t),this.checkContent(t),new Ot(this,this.computeAttrs(e),t,_.setFrom(r))}createAndFill(e=null,t,r){if(e=this.computeAttrs(e),t=v.from(t),t.size){let s=this.contentMatch.fillBefore(t);if(!s)return null;t=s.append(t)}let i=this.contentMatch.matchFragment(t),o=i&&i.fillBefore(v.empty,!0);return o?new Ot(this,e,t.append(o),_.setFrom(r)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let t;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?t&&t.push(e[r]):t||(t=e.slice(0,r));return t?t.length?t:_.none:e}static compile(e,t){let r=Object.create(null);e.forEach((o,s)=>r[o]=new xm(o,t,s));let i=t.spec.topNode||"doc";if(!r[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let o in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};class DS{constructor(e){this.hasDefault=Object.prototype.hasOwnProperty.call(e,"default"),this.default=e.default}get isRequired(){return!this.hasDefault}}class Wo{constructor(e,t,r,i){this.name=e,this.rank=t,this.schema=r,this.spec=i,this.attrs=vm(i.attrs),this.excluded=null;let o=km(this.attrs);this.instance=o?new _(this,o):null}create(e=null){return!e&&this.instance?this.instance:new _(this,wm(this.attrs,e))}static compile(e,t){let r=Object.create(null),i=0;return e.forEach((o,s)=>r[o]=new Wo(o,i++,t,s)),r}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}excludes(e){return this.excluded.indexOf(e)>-1}}class Cm{constructor(e){this.cached=Object.create(null);let t=this.spec={};for(let i in e)t[i]=e[i];t.nodes=de.from(e.nodes),t.marks=de.from(e.marks||{}),this.nodes=vd.compile(this.spec.nodes,this),this.marks=Wo.compile(this.spec.marks,this);let r=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let o=this.nodes[i],s=o.spec.content||"",l=o.spec.marks;o.contentMatch=r[s]||(r[s]=nr.parse(s,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.markSet=l=="_"?null:l?xd(this,l.split(" ")):l==""||!o.inlineContent?[]:null}for(let i in this.marks){let o=this.marks[i],s=o.spec.excludes;o.excluded=s==null?[o]:s==""?[]:xd(this,s.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,r,i){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof vd){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(t,r,i)}text(e,t){let r=this.nodes.text;return new ll(r,r.defaultAttrs,e,_.setFrom(t))}mark(e,t){return typeof e=="string"&&(e=this.marks[e]),e.create(t)}nodeFromJSON(e){return Ot.fromJSON(this,e)}markFromJSON(e){return _.fromJSON(this,e)}nodeType(e){let t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}}function xd(n,e){let t=[];for(let r=0;r<e.length;r++){let i=e[r],o=n.marks[i],s=o;if(o)t.push(o);else for(let l in n.marks){let a=n.marks[l];(i=="_"||a.spec.group&&a.spec.group.split(" ").indexOf(i)>-1)&&t.push(s=a)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return t}class ho{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[],t.forEach(r=>{r.tag?this.tags.push(r):r.style&&this.styles.push(r)}),this.normalizeLists=!this.tags.some(r=>{if(!/^(ul|ol)\b/.test(r.tag)||!r.node)return!1;let i=e.nodes[r.node];return i.contentMatch.matchType(i)})}parse(e,t={}){let r=new Nd(this,t,!1);return r.addAll(e,t.from,t.to),r.finish()}parseSlice(e,t={}){let r=new Nd(this,t,!0);return r.addAll(e,t.from,t.to),w.maxOpen(r.finish())}matchTag(e,t,r){for(let i=r?this.tags.indexOf(r)+1:0;i<this.tags.length;i++){let o=this.tags[i];if(AS(e,o.tag)&&(o.namespace===void 0||e.namespaceURI==o.namespace)&&(!o.context||t.matchesContext(o.context))){if(o.getAttrs){let s=o.getAttrs(e);if(s===!1)continue;o.attrs=s||void 0}return o}}}matchStyle(e,t,r,i){for(let o=i?this.styles.indexOf(i)+1:0;o<this.styles.length;o++){let s=this.styles[o],l=s.style;if(!(l.indexOf(e)!=0||s.context&&!r.matchesContext(s.context)||l.length>e.length&&(l.charCodeAt(e.length)!=61||l.slice(e.length+1)!=t))){if(s.getAttrs){let a=s.getAttrs(t);if(a===!1)continue;s.attrs=a||void 0}return s}}}static schemaRules(e){let t=[];function r(i){let o=i.priority==null?50:i.priority,s=0;for(;s<t.length;s++){let l=t[s];if((l.priority==null?50:l.priority)<o)break}t.splice(s,0,i)}for(let i in e.marks){let o=e.marks[i].spec.parseDOM;o&&o.forEach(s=>{r(s=Md(s)),s.mark||s.ignore||s.clearMark||(s.mark=i)})}for(let i in e.nodes){let o=e.nodes[i].spec.parseDOM;o&&o.forEach(s=>{r(s=Md(s)),s.node||s.ignore||s.mark||(s.node=i)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new ho(e,ho.schemaRules(e)))}}const Nm={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},TS={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Mm={ol:!0,ul:!0},al=1,ul=2,Yi=4;function Cd(n,e,t){return e!=null?(e?al:0)|(e==="full"?ul:0):n&&n.whitespace=="pre"?al|ul:t&~Yi}class ss{constructor(e,t,r,i,o,s,l){this.type=e,this.attrs=t,this.marks=r,this.pendingMarks=i,this.solid=o,this.options=l,this.content=[],this.activeMarks=_.none,this.stashMarks=[],this.match=s||(l&Yi?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(v.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{let r=this.type.contentMatch,i;return(i=r.findWrapping(e.type))?(this.match=r,i):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&al)){let r=this.content[this.content.length-1],i;if(r&&r.isText&&(i=/[ \t\r\n\u000c]+$/.exec(r.text))){let o=r;r.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=o.withText(o.text.slice(0,o.text.length-i[0].length))}}let t=v.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(v.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}popFromStashMark(e){for(let t=this.stashMarks.length-1;t>=0;t--)if(e.eq(this.stashMarks[t]))return this.stashMarks.splice(t,1)[0]}applyPending(e){for(let t=0,r=this.pendingMarks;t<r.length;t++){let i=r[t];(this.type?this.type.allowsMarkType(i.type):bS(i.type,e))&&!i.isInSet(this.activeMarks)&&(this.activeMarks=i.addToSet(this.activeMarks),this.pendingMarks=i.removeFromSet(this.pendingMarks))}}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!Nm.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class Nd{constructor(e,t,r){this.parser=e,this.options=t,this.isOpen=r,this.open=0;let i=t.topNode,o,s=Cd(null,t.preserveWhitespace,0)|(r?Yi:0);i?o=new ss(i.type,i.attrs,_.none,_.none,!0,t.topMatch||i.type.contentMatch,s):r?o=new ss(null,null,_.none,_.none,!0,null,s):o=new ss(e.schema.topNodeType,null,_.none,_.none,!0,null,s),this.nodes=[o],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e){e.nodeType==3?this.addTextNode(e):e.nodeType==1&&this.addElement(e)}withStyleRules(e,t){let r=e.getAttribute("style");if(!r)return t();let i=this.readStyles(IS(r));if(!i)return;let[o,s]=i,l=this.top;for(let a=0;a<s.length;a++)this.removePendingMark(s[a],l);for(let a=0;a<o.length;a++)this.addPendingMark(o[a]);t();for(let a=0;a<o.length;a++)this.removePendingMark(o[a],l);for(let a=0;a<s.length;a++)this.addPendingMark(s[a])}addTextNode(e){let t=e.nodeValue,r=this.top;if(r.options&ul||r.inlineContext(e)||/[^ \t\r\n\u000c]/.test(t)){if(r.options&al)r.options&ul?t=t.replace(/\r\n?/g,`
`):t=t.replace(/\r?\n|\r/g," ");else if(t=t.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(t)&&this.open==this.nodes.length-1){let i=r.content[r.content.length-1],o=e.previousSibling;(!i||o&&o.nodeName=="BR"||i.isText&&/[ \t\r\n\u000c]$/.test(i.text))&&(t=t.slice(1))}t&&this.insertNode(this.parser.schema.text(t)),this.findInText(e)}else this.findInside(e)}addElement(e,t){let r=e.nodeName.toLowerCase(),i;Mm.hasOwnProperty(r)&&this.parser.normalizeLists&&RS(e);let o=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(i=this.parser.matchTag(e,this,t));if(o?o.ignore:TS.hasOwnProperty(r))this.findInside(e),this.ignoreFallback(e);else if(!o||o.skip||o.closeParent){o&&o.closeParent?this.open=Math.max(0,this.open-1):o&&o.skip.nodeType&&(e=o.skip);let s,l=this.top,a=this.needsBlock;if(Nm.hasOwnProperty(r))l.content.length&&l.content[0].isInline&&this.open&&(this.open--,l=this.top),s=!0,l.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e);return}o&&o.skip?this.addAll(e):this.withStyleRules(e,()=>this.addAll(e)),s&&this.sync(l),this.needsBlock=a}else this.withStyleRules(e,()=>{this.addElementByRule(e,o,o.consuming===!1?i:void 0)})}leafFallback(e){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`))}ignoreFallback(e){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"))}readStyles(e){let t=_.none,r=_.none;for(let i=0;i<e.length;i+=2)for(let o=void 0;;){let s=this.parser.matchStyle(e[i],e[i+1],this,o);if(!s)break;if(s.ignore)return null;if(s.clearMark?this.top.pendingMarks.concat(this.top.activeMarks).forEach(l=>{s.clearMark(l)&&(r=l.addToSet(r))}):t=this.parser.schema.marks[s.mark].create(s.attrs).addToSet(t),s.consuming===!1)o=s;else break}return[t,r]}addElementByRule(e,t,r){let i,o,s;t.node?(o=this.parser.schema.nodes[t.node],o.isLeaf?this.insertNode(o.create(t.attrs))||this.leafFallback(e):i=this.enter(o,t.attrs||null,t.preserveWhitespace)):(s=this.parser.schema.marks[t.mark].create(t.attrs),this.addPendingMark(s));let l=this.top;if(o&&o.isLeaf)this.findInside(e);else if(r)this.addElement(e,r);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(a=>this.insertNode(a));else{let a=e;typeof t.contentElement=="string"?a=e.querySelector(t.contentElement):typeof t.contentElement=="function"?a=t.contentElement(e):t.contentElement&&(a=t.contentElement),this.findAround(e,a,!0),this.addAll(a)}i&&this.sync(l)&&this.open--,s&&this.removePendingMark(s,l)}addAll(e,t,r){let i=t||0;for(let o=t?e.childNodes[t]:e.firstChild,s=r==null?null:e.childNodes[r];o!=s;o=o.nextSibling,++i)this.findAtPoint(e,i),this.addDOM(o);this.findAtPoint(e,i)}findPlace(e){let t,r;for(let i=this.open;i>=0;i--){let o=this.nodes[i],s=o.findWrapping(e);if(s&&(!t||t.length>s.length)&&(t=s,r=o,!s.length)||o.solid)break}if(!t)return!1;this.sync(r);for(let i=0;i<t.length;i++)this.enterInner(t[i],null,!1);return!0}insertNode(e){if(e.isInline&&this.needsBlock&&!this.top.type){let t=this.textblockFromContext();t&&this.enterInner(t)}if(this.findPlace(e)){this.closeExtra();let t=this.top;t.applyPending(e.type),t.match&&(t.match=t.match.matchType(e.type));let r=t.activeMarks;for(let i=0;i<e.marks.length;i++)(!t.type||t.type.allowsMarkType(e.marks[i].type))&&(r=e.marks[i].addToSet(r));return t.content.push(e.mark(r)),!0}return!1}enter(e,t,r){let i=this.findPlace(e.create(t));return i&&this.enterInner(e,t,!0,r),i}enterInner(e,t=null,r=!1,i){this.closeExtra();let o=this.top;o.applyPending(e),o.match=o.match&&o.match.matchType(e);let s=Cd(e,i,o.options);o.options&Yi&&o.content.length==0&&(s|=Yi),this.nodes.push(new ss(e,t,o.activeMarks,o.pendingMarks,r,null,s)),this.open++}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}sync(e){for(let t=this.open;t>=0;t--)if(this.nodes[t]==e)return this.open=t,!0;return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let r=this.nodes[t].content;for(let i=r.length-1;i>=0;i--)e+=r[i].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==t&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].pos==null&&e.nodeType==1&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,r){if(e!=t&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&e.nodeType==1&&e.contains(this.find[i].node)&&t.compareDocumentPosition(this.find[i].node)&(r?2:4)&&(this.find[i].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),r=this.options.context,i=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),o=-(r?r.depth+1:0)+(i?0:1),s=(l,a)=>{for(;l>=0;l--){let u=t[l];if(u==""){if(l==t.length-1||l==0)continue;for(;a>=o;a--)if(s(l-1,a))return!0;return!1}else{let c=a>0||a==0&&i?this.nodes[a].type:r&&a>=o?r.node(a-o).type:null;if(!c||c.name!=u&&c.groups.indexOf(u)==-1)return!1;a--}}return!0};return s(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let r=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let t in this.parser.schema.nodes){let r=this.parser.schema.nodes[t];if(r.isTextblock&&r.defaultAttrs)return r}}addPendingMark(e){let t=zS(e,this.top.pendingMarks);t&&this.top.stashMarks.push(t),this.top.pendingMarks=e.addToSet(this.top.pendingMarks)}removePendingMark(e,t){for(let r=this.open;r>=0;r--){let i=this.nodes[r];if(i.pendingMarks.lastIndexOf(e)>-1)i.pendingMarks=e.removeFromSet(i.pendingMarks);else{i.activeMarks=e.removeFromSet(i.activeMarks);let s=i.popFromStashMark(e);s&&i.type&&i.type.allowsMarkType(s.type)&&(i.activeMarks=s.addToSet(i.activeMarks))}if(i==t)break}}}function RS(n){for(let e=n.firstChild,t=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&Mm.hasOwnProperty(r)&&t?(t.appendChild(e),e=t):r=="li"?t=e:r&&(t=null)}}function AS(n,e){return(n.matches||n.msMatchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector).call(n,e)}function IS(n){let e=/\s*([\w-]+)\s*:\s*([^;]+)/g,t,r=[];for(;t=e.exec(n);)r.push(t[1],t[2].trim());return r}function Md(n){let e={};for(let t in n)e[t]=n[t];return e}function bS(n,e){let t=e.schema.nodes;for(let r in t){let i=t[r];if(!i.allowsMarkType(n))continue;let o=[],s=l=>{o.push(l);for(let a=0;a<l.edgeCount;a++){let{type:u,next:c}=l.edge(a);if(u==e||o.indexOf(c)<0&&s(c))return!0}};if(s(i.contentMatch))return!0}}function zS(n,e){for(let t=0;t<e.length;t++)if(n.eq(e[t]))return e[t]}class Ut{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},r){r||(r=ya(t).createDocumentFragment());let i=r,o=[];return e.forEach(s=>{if(o.length||s.marks.length){let l=0,a=0;for(;l<o.length&&a<s.marks.length;){let u=s.marks[a];if(!this.marks[u.type.name]){a++;continue}if(!u.eq(o[l][0])||u.type.spec.spanning===!1)break;l++,a++}for(;l<o.length;)i=o.pop()[1];for(;a<s.marks.length;){let u=s.marks[a++],c=this.serializeMark(u,s.isInline,t);c&&(o.push([u,i]),i.appendChild(c.dom),i=c.contentDOM||c.dom)}}i.appendChild(this.serializeNodeInner(s,t))}),r}serializeNodeInner(e,t){let{dom:r,contentDOM:i}=Ut.renderSpec(ya(t),this.nodes[e.type.name](e));if(i){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,i)}return r}serializeNode(e,t={}){let r=this.serializeNodeInner(e,t);for(let i=e.marks.length-1;i>=0;i--){let o=this.serializeMark(e.marks[i],e.isInline,t);o&&((o.contentDOM||o.dom).appendChild(r),r=o.dom)}return r}serializeMark(e,t,r={}){let i=this.marks[e.type.name];return i&&Ut.renderSpec(ya(r),i(e,t))}static renderSpec(e,t,r=null){if(typeof t=="string")return{dom:e.createTextNode(t)};if(t.nodeType!=null)return{dom:t};if(t.dom&&t.dom.nodeType!=null)return t;let i=t[0],o=i.indexOf(" ");o>0&&(r=i.slice(0,o),i=i.slice(o+1));let s,l=r?e.createElementNS(r,i):e.createElement(i),a=t[1],u=1;if(a&&typeof a=="object"&&a.nodeType==null&&!Array.isArray(a)){u=2;for(let c in a)if(a[c]!=null){let f=c.indexOf(" ");f>0?l.setAttributeNS(c.slice(0,f),c.slice(f+1),a[c]):l.setAttribute(c,a[c])}}for(let c=u;c<t.length;c++){let f=t[c];if(f===0){if(c<t.length-1||c>u)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}else{let{dom:d,contentDOM:p}=Ut.renderSpec(e,f,r);if(l.appendChild(d),p){if(s)throw new RangeError("Multiple content holes");s=p}}}return{dom:l,contentDOM:s}}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new Ut(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=Ed(e.nodes);return t.text||(t.text=r=>r.text),t}static marksFromSchema(e){return Ed(e.marks)}}function Ed(n){let e={};for(let t in n){let r=n[t].spec.toDOM;r&&(e[t]=r)}return e}function ya(n){return n.document||window.document}const Em=65535,Om=Math.pow(2,16);function PS(n,e){return n+e*Om}function Od(n){return n&Em}function FS(n){return(n-(n&Em))/Om}const Dm=1,Tm=2,Is=4,Rm=8;let Dd=class{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&Rm)>0}get deletedBefore(){return(this.delInfo&(Dm|Is))>0}get deletedAfter(){return(this.delInfo&(Tm|Is))>0}get deletedAcross(){return(this.delInfo&Is)>0}},Ur=class gr{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&gr.empty)return gr.empty}recover(e){let t=0,r=Od(e);if(!this.inverted)for(let i=0;i<r;i++)t+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+t+FS(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let i=0,o=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?i:0);if(a>e)break;let u=this.ranges[l+o],c=this.ranges[l+s],f=a+u;if(e<=f){let d=u?e==a?-1:e==f?1:t:t,p=a+i+(d<0?0:c);if(r)return p;let h=e==(t<0?a:f)?null:PS(l/3,e-a),m=e==a?Tm:e==f?Dm:Is;return(t<0?e!=a:e!=f)&&(m|=Rm),new Dd(p,m,h)}i+=c-u}return r?e+i:new Dd(e+i,0,null)}touches(e,t){let r=0,i=Od(t),o=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?r:0);if(a>e)break;let u=this.ranges[l+o],c=a+u;if(e<=c&&l==i*3)return!0;r+=this.ranges[l+s]-u}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,o=0;i<this.ranges.length;i+=3){let s=this.ranges[i],l=s-(this.inverted?o:0),a=s+(this.inverted?0:o),u=this.ranges[i+t],c=this.ranges[i+r];e(l,l+u,a,a+c),o+=c-u}}invert(){return new gr(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?gr.empty:new gr(e<0?[0,-e,0]:[0,0,e])}};Ur.empty=new Ur([]);const Sa=Object.create(null);let He=class{getMap(){return Ur.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=Sa[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in Sa)throw new RangeError("Duplicate use of step JSON ID "+e);return Sa[e]=t,t.prototype.jsonID=e,t}},Fe=class xi{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new xi(e,null)}static fail(e){return new xi(null,e)}static fromReplace(e,t,r,i){try{return xi.ok(e.replace(t,r,i))}catch(o){if(o instanceof En)return xi.fail(o.message);throw o}}};function Hc(n,e,t){let r=[];for(let i=0;i<n.childCount;i++){let o=n.child(i);o.content.size&&(o=o.copy(Hc(o.content,e,o))),o.isInline&&(o=e(o,t,i)),r.push(o)}return v.fromArray(r)}let Am=class Ci extends He{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),o=new w(Hc(t.content,(s,l)=>!s.isAtom||!l.type.allowsMarkType(this.mark.type)?s:s.mark(this.mark.addToSet(s.marks)),i),t.openStart,t.openEnd);return Fe.fromReplace(e,this.from,this.to,o)}invert(){return new Im(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Ci(t.pos,r.pos,this.mark)}merge(e){return e instanceof Ci&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Ci(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Ci(t.from,t.to,e.markFromJSON(t.mark))}};He.jsonID("addMark",Am);let Im=class Ni extends He{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new w(Hc(t.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),t.openStart,t.openEnd);return Fe.fromReplace(e,this.from,this.to,r)}invert(){return new Am(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Ni(t.pos,r.pos,this.mark)}merge(e){return e instanceof Ni&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Ni(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Ni(t.from,t.to,e.markFromJSON(t.mark))}};He.jsonID("removeMark",Im);let bm=class Mi extends He{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Fe.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return Fe.fromReplace(e,this.pos,this.pos+1,new w(v.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let i=0;i<t.marks.length;i++)if(!t.marks[i].isInSet(r))return new Mi(this.pos,t.marks[i]);return new Mi(this.pos,this.mark)}}return new zm(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Mi(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Mi(t.pos,e.markFromJSON(t.mark))}};He.jsonID("addNodeMark",bm);let zm=class yu extends He{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Fe.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return Fe.fromReplace(e,this.pos,this.pos+1,new w(v.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new bm(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new yu(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new yu(t.pos,e.markFromJSON(t.mark))}};He.jsonID("removeNodeMark",zm);let jc=class Ln extends He{constructor(e,t,r,i=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=i}apply(e){return this.structure&&Su(e,this.from,this.to)?Fe.fail("Structure replace would overwrite content"):Fe.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Ur([this.from,this.to-this.from,this.slice.size])}invert(e){return new Ln(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new Ln(t.pos,Math.max(t.pos,r.pos),this.slice)}merge(e){if(!(e instanceof Ln)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?w.empty:new w(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new Ln(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?w.empty:new w(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new Ln(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Ln(t.from,t.to,w.fromJSON(e,t.slice),!!t.structure)}};He.jsonID("replace",jc);let cl=class bs extends He{constructor(e,t,r,i,o,s,l=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=i,this.slice=o,this.insert=s,this.structure=l}apply(e){if(this.structure&&(Su(e,this.from,this.gapFrom)||Su(e,this.gapTo,this.to)))return Fe.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return Fe.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?Fe.fromReplace(e,this.from,this.to,r):Fe.fail("Content does not fit in gap")}getMap(){return new Ur([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new bs(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=e.map(this.gapFrom,-1),o=e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||i<t.pos||o>r.pos?null:new bs(t.pos,r.pos,i,o,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new bs(t.from,t.to,t.gapFrom,t.gapTo,w.fromJSON(e,t.slice),t.insert,!!t.structure)}};He.jsonID("replaceAround",cl);function Su(n,e,t){let r=n.resolve(e),i=t-e,o=r.depth;for(;i>0&&o>0&&r.indexAfter(o)==r.node(o).childCount;)o--,i--;if(i>0){let s=r.node(o).maybeChild(r.indexAfter(o));for(;i>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,i--}}return!1}function LS(n,e,t){return(e==0||n.canReplace(e,n.childCount))&&(t==n.childCount||n.canReplace(0,t))}function Kc(n){let t=n.parent.content.cutByIndex(n.startIndex,n.endIndex);for(let r=n.depth;;--r){let i=n.$from.node(r),o=n.$from.index(r),s=n.$to.indexAfter(r);if(r<n.depth&&i.canReplace(o,s,t))return r;if(r==0||i.type.spec.isolating||!LS(i,o,s))break}return null}function zs(n,e,t=1,r){let i=n.resolve(e),o=i.depth-t,s=r&&r[r.length-1]||i.parent;if(o<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!s.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let u=i.depth-1,c=t-2;u>o;u--,c--){let f=i.node(u),d=i.index(u);if(f.type.spec.isolating)return!1;let p=f.content.cutByIndex(d,f.childCount),h=r&&r[c]||f;if(h!=f&&(p=p.replaceChild(0,h.type.create(h.attrs))),!f.canReplace(d+1,f.childCount)||!h.type.validContent(p))return!1}let l=i.indexAfter(o),a=r&&r[0];return i.node(o).canReplaceWith(l,l,a?a.type:i.node(o+1).type)}function Pm(n,e){let t=n.resolve(e),r=t.index();return $S(t.nodeBefore,t.nodeAfter)&&t.parent.canReplace(r,r+1)}function $S(n,e){return!!(n&&e&&!n.isLeaf&&n.canAppend(e))}function Fm(n,e,t=e,r=w.empty){if(e==t&&!r.size)return null;let i=n.resolve(e),o=n.resolve(t);return BS(i,o,r)?new jc(e,t,r):new VS(i,o,r).fit()}function BS(n,e,t){return!t.openStart&&!t.openEnd&&n.start()==e.start()&&n.parent.canReplace(n.index(),e.index(),t.content)}let VS=class{constructor(e,t,r){this.$from=e,this.$to=t,this.unplaced=r,this.frontier=[],this.placed=v.empty;for(let i=0;i<=e.depth;i++){let o=e.node(i);this.frontier.push({type:o.type,match:o.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=v.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let u=this.findFittable();u?this.placeNodes(u):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(e<0?this.$to:r.doc.resolve(e));if(!i)return null;let o=this.placed,s=r.depth,l=i.depth;for(;s&&l&&o.childCount==1;)o=o.firstChild.content,s--,l--;let a=new w(o,s,l);return e>-1?new cl(r.pos,e,this.$to.pos,this.$to.end(),a,t):a.size||r.pos!=this.$to.pos?new jc(r.pos,i.pos,a):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,r=0,i=this.unplaced.openEnd;r<e;r++){let o=t.firstChild;if(t.childCount>1&&(i=0),o.type.spec.isolating&&i<=r){e=r;break}t=o.content}for(let t=1;t<=2;t++)for(let r=t==1?e:this.unplaced.openStart;r>=0;r--){let i,o=null;r?(o=ka(this.unplaced.content,r-1).firstChild,i=o.content):i=this.unplaced.content;let s=i.firstChild;for(let l=this.depth;l>=0;l--){let{type:a,match:u}=this.frontier[l],c,f=null;if(t==1&&(s?u.matchType(s.type)||(f=u.fillBefore(v.from(s),!1)):o&&a.compatibleContent(o.type)))return{sliceDepth:r,frontierDepth:l,parent:o,inject:f};if(t==2&&s&&(c=u.findWrapping(s.type)))return{sliceDepth:r,frontierDepth:l,parent:o,wrap:c};if(o&&u.matchType(o.type))break}}}openMore(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=ka(e,t);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new w(e,t+1,Math.max(r,i.size+t>=e.size-r?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=ka(e,t);if(i.childCount<=1&&t>0){let o=e.size-t<=t+i.size;this.unplaced=new w(Ei(e,t-1,1),t-1,o?t-1:r)}else this.unplaced=new w(Ei(e,t,1),t,r)}placeNodes({sliceDepth:e,frontierDepth:t,parent:r,inject:i,wrap:o}){for(;this.depth>t;)this.closeFrontierNode();if(o)for(let m=0;m<o.length;m++)this.openFrontierNode(o[m]);let s=this.unplaced,l=r?r.content:s.content,a=s.openStart-e,u=0,c=[],{match:f,type:d}=this.frontier[t];if(i){for(let m=0;m<i.childCount;m++)c.push(i.child(m));f=f.matchFragment(i)}let p=l.size+e-(s.content.size-s.openEnd);for(;u<l.childCount;){let m=l.child(u),k=f.matchType(m.type);if(!k)break;u++,(u>1||a==0||m.content.size)&&(f=k,c.push(Lm(m.mark(d.allowedMarks(m.marks)),u==1?a:0,u==l.childCount?p:-1)))}let h=u==l.childCount;h||(p=-1),this.placed=Oi(this.placed,t,v.from(c)),this.frontier[t].match=f,h&&p<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let m=0,k=l;m<p;m++){let g=k.lastChild;this.frontier.push({type:g.type,match:g.contentMatchAt(g.childCount)}),k=g.content}this.unplaced=h?e==0?w.empty:new w(Ei(s.content,e-1,1),e-1,p<0?s.openEnd:e-1):new w(Ei(s.content,e,u),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!wa(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:r,type:i}=this.frontier[t],o=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),s=wa(e,t,i,r,o);if(s){for(let l=t-1;l>=0;l--){let{match:a,type:u}=this.frontier[l],c=wa(e,l,u,a,!0);if(!c||c.childCount)continue e}return{depth:t,fit:s,move:o?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=Oi(this.placed,t.depth,t.fit)),e=t.move;for(let r=t.depth+1;r<=e.depth;r++){let i=e.node(r),o=i.type.contentMatch.fillBefore(i.content,!0,e.index(r));this.openFrontierNode(i.type,i.attrs,o)}return e}openFrontierNode(e,t=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=Oi(this.placed,this.depth,v.from(e.create(t,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(v.empty,!0);t.childCount&&(this.placed=Oi(this.placed,this.frontier.length,t))}};function Ei(n,e,t){return e==0?n.cutByIndex(t,n.childCount):n.replaceChild(0,n.firstChild.copy(Ei(n.firstChild.content,e-1,t)))}function Oi(n,e,t){return e==0?n.append(t):n.replaceChild(n.childCount-1,n.lastChild.copy(Oi(n.lastChild.content,e-1,t)))}function ka(n,e){for(let t=0;t<e;t++)n=n.firstChild.content;return n}function Lm(n,e,t){if(e<=0)return n;let r=n.content;return e>1&&(r=r.replaceChild(0,Lm(r.firstChild,e-1,r.childCount==1?t-1:0))),e>0&&(r=n.type.contentMatch.fillBefore(r).append(r),t<=0&&(r=r.append(n.type.contentMatch.matchFragment(r).fillBefore(v.empty,!0)))),n.copy(r)}function wa(n,e,t,r,i){let o=n.node(e),s=i?n.indexAfter(e):n.index(e);if(s==o.childCount&&!t.compatibleContent(o.type))return null;let l=r.fillBefore(o.content,!0,s);return l&&!JS(t,o.content,s)?l:null}function JS(n,e,t){for(let r=t;r<e.childCount;r++)if(!n.allowsMarks(e.child(r).marks))return!0;return!1}let _S=class Ps extends He{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return Fe.fail("No node at attribute step's position");let r=Object.create(null);for(let o in t.attrs)r[o]=t.attrs[o];r[this.attr]=this.value;let i=t.type.create(r,null,t.marks);return Fe.fromReplace(e,this.pos,this.pos+1,new w(v.from(i),0,t.isLeaf?0:1))}getMap(){return Ur.empty}invert(e){return new Ps(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Ps(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Ps(t.pos,t.attr,t.value)}};He.jsonID("attr",_S);let po=class extends Error{};po=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};po.prototype=Object.create(Error.prototype);po.prototype.constructor=po;po.prototype.name="TransformError";const $m=65535,Bm=Math.pow(2,16);function WS(n,e){return n+e*Bm}function Td(n){return n&$m}function US(n){return(n-(n&$m))/Bm}const Vm=1,Jm=2,Fs=4,_m=8;let ku=class{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&_m)>0}get deletedBefore(){return(this.delInfo&(Vm|Fs))>0}get deletedAfter(){return(this.delInfo&(Jm|Fs))>0}get deletedAcross(){return(this.delInfo&Fs)>0}},Hr=class yr{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&yr.empty)return yr.empty}recover(e){let t=0,r=Td(e);if(!this.inverted)for(let i=0;i<r;i++)t+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+t+US(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let i=0,o=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?i:0);if(a>e)break;let u=this.ranges[l+o],c=this.ranges[l+s],f=a+u;if(e<=f){let d=u?e==a?-1:e==f?1:t:t,p=a+i+(d<0?0:c);if(r)return p;let h=e==(t<0?a:f)?null:WS(l/3,e-a),m=e==a?Jm:e==f?Vm:Fs;return(t<0?e!=a:e!=f)&&(m|=_m),new ku(p,m,h)}i+=c-u}return r?e+i:new ku(e+i,0,null)}touches(e,t){let r=0,i=Td(t),o=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?r:0);if(a>e)break;let u=this.ranges[l+o],c=a+u;if(e<=c&&l==i*3)return!0;r+=this.ranges[l+s]-u}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,o=0;i<this.ranges.length;i+=3){let s=this.ranges[i],l=s-(this.inverted?o:0),a=s+(this.inverted?0:o),u=this.ranges[i+t],c=this.ranges[i+r];e(l,l+u,a,a+c),o+=c-u}}invert(){return new yr(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?yr.empty:new yr(e<0?[0,-e,0]:[0,0,e])}};Hr.empty=new Hr([]);let HS=class Ls{constructor(e=[],t,r=0,i=e.length){this.maps=e,this.mirror=t,this.from=r,this.to=i}slice(e=0,t=this.maps.length){return new Ls(this.maps,this.mirror,e,t)}copy(){return new Ls(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(e,t){this.to=this.maps.push(e),t!=null&&this.setMirror(this.maps.length-1,t)}appendMapping(e){for(let t=0,r=this.maps.length;t<e.maps.length;t++){let i=e.getMirror(t);this.appendMap(e.maps[t],i!=null&&i<t?r+i:void 0)}}getMirror(e){if(this.mirror){for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,r=this.maps.length+e.maps.length;t>=0;t--){let i=e.getMirror(t);this.appendMap(e.maps[t].invert(),i!=null&&i>t?r-i-1:void 0)}}invert(){let e=new Ls;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let r=this.from;r<this.to;r++)e=this.maps[r].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,r){let i=0;for(let o=this.from;o<this.to;o++){let s=this.maps[o],l=s.mapResult(e,t);if(l.recover!=null){let a=this.getMirror(o);if(a!=null&&a>o&&a<this.to){o=a,e=this.maps[a].recover(l.recover);continue}}i|=l.delInfo,e=l.pos}return r?e:new ku(e,i,null)}};const va=Object.create(null);let je=class{getMap(){return Hr.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=va[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in va)throw new RangeError("Duplicate use of step JSON ID "+e);return va[e]=t,t.prototype.jsonID=e,t}},Le=class Di{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new Di(e,null)}static fail(e){return new Di(null,e)}static fromReplace(e,t,r,i){try{return Di.ok(e.replace(t,r,i))}catch(o){if(o instanceof En)return Di.fail(o.message);throw o}}};function qc(n,e,t){let r=[];for(let i=0;i<n.childCount;i++){let o=n.child(i);o.content.size&&(o=o.copy(qc(o.content,e,o))),o.isInline&&(o=e(o,t,i)),r.push(o)}return v.fromArray(r)}let Qc=class Ti extends je{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),o=new w(qc(t.content,(s,l)=>!s.isAtom||!l.type.allowsMarkType(this.mark.type)?s:s.mark(this.mark.addToSet(s.marks)),i),t.openStart,t.openEnd);return Le.fromReplace(e,this.from,this.to,o)}invert(){return new Uo(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Ti(t.pos,r.pos,this.mark)}merge(e){return e instanceof Ti&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Ti(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Ti(t.from,t.to,e.markFromJSON(t.mark))}};je.jsonID("addMark",Qc);let Uo=class Ri extends je{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new w(qc(t.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),t.openStart,t.openEnd);return Le.fromReplace(e,this.from,this.to,r)}invert(){return new Qc(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Ri(t.pos,r.pos,this.mark)}merge(e){return e instanceof Ri&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Ri(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Ri(t.from,t.to,e.markFromJSON(t.mark))}};je.jsonID("removeMark",Uo);let Yc=class Ai extends je{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Le.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return Le.fromReplace(e,this.pos,this.pos+1,new w(v.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let i=0;i<t.marks.length;i++)if(!t.marks[i].isInSet(r))return new Ai(this.pos,t.marks[i]);return new Ai(this.pos,this.mark)}}return new Gc(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Ai(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Ai(t.pos,e.markFromJSON(t.mark))}};je.jsonID("addNodeMark",Yc);let Gc=class wu extends je{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Le.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return Le.fromReplace(e,this.pos,this.pos+1,new w(v.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new Yc(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new wu(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new wu(t.pos,e.markFromJSON(t.mark))}};je.jsonID("removeNodeMark",Gc);let Tn=class $n extends je{constructor(e,t,r,i=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=i}apply(e){return this.structure&&vu(e,this.from,this.to)?Le.fail("Structure replace would overwrite content"):Le.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Hr([this.from,this.to-this.from,this.slice.size])}invert(e){return new $n(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new $n(t.pos,Math.max(t.pos,r.pos),this.slice)}merge(e){if(!(e instanceof $n)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?w.empty:new w(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new $n(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?w.empty:new w(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new $n(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new $n(t.from,t.to,w.fromJSON(e,t.slice),!!t.structure)}};je.jsonID("replace",Tn);let ur=class $s extends je{constructor(e,t,r,i,o,s,l=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=i,this.slice=o,this.insert=s,this.structure=l}apply(e){if(this.structure&&(vu(e,this.from,this.gapFrom)||vu(e,this.gapTo,this.to)))return Le.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return Le.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?Le.fromReplace(e,this.from,this.to,r):Le.fail("Content does not fit in gap")}getMap(){return new Hr([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new $s(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=e.map(this.gapFrom,-1),o=e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||i<t.pos||o>r.pos?null:new $s(t.pos,r.pos,i,o,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new $s(t.from,t.to,t.gapFrom,t.gapTo,w.fromJSON(e,t.slice),t.insert,!!t.structure)}};je.jsonID("replaceAround",ur);function vu(n,e,t){let r=n.resolve(e),i=t-e,o=r.depth;for(;i>0&&o>0&&r.indexAfter(o)==r.node(o).childCount;)o--,i--;if(i>0){let s=r.node(o).maybeChild(r.indexAfter(o));for(;i>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,i--}}return!1}function jS(n,e,t,r){let i=[],o=[],s,l;n.doc.nodesBetween(e,t,(a,u,c)=>{if(!a.isInline)return;let f=a.marks;if(!r.isInSet(f)&&c.type.allowsMarkType(r.type)){let d=Math.max(u,e),p=Math.min(u+a.nodeSize,t),h=r.addToSet(f);for(let m=0;m<f.length;m++)f[m].isInSet(h)||(s&&s.to==d&&s.mark.eq(f[m])?s.to=p:i.push(s=new Uo(d,p,f[m])));l&&l.to==d?l.to=p:o.push(l=new Qc(d,p,r))}}),i.forEach(a=>n.step(a)),o.forEach(a=>n.step(a))}function KS(n,e,t,r){let i=[],o=0;n.doc.nodesBetween(e,t,(s,l)=>{if(!s.isInline)return;o++;let a=null;if(r instanceof Wo){let u=s.marks,c;for(;c=r.isInSet(u);)(a||(a=[])).push(c),u=c.removeFromSet(u)}else r?r.isInSet(s.marks)&&(a=[r]):a=s.marks;if(a&&a.length){let u=Math.min(l+s.nodeSize,t);for(let c=0;c<a.length;c++){let f=a[c],d;for(let p=0;p<i.length;p++){let h=i[p];h.step==o-1&&f.eq(i[p].style)&&(d=h)}d?(d.to=u,d.step=o):i.push({style:f,from:Math.max(l,e),to:u,step:o})}}}),i.forEach(s=>n.step(new Uo(s.from,s.to,s.style)))}function qS(n,e,t,r=t.contentMatch){let i=n.doc.nodeAt(e),o=[],s=e+1;for(let l=0;l<i.childCount;l++){let a=i.child(l),u=s+a.nodeSize,c=r.matchType(a.type);if(!c)o.push(new Tn(s,u,w.empty));else{r=c;for(let f=0;f<a.marks.length;f++)t.allowsMarkType(a.marks[f].type)||n.step(new Uo(s,u,a.marks[f]))}s=u}if(!r.validEnd){let l=r.fillBefore(v.empty,!0);n.replace(s,s,new w(l,0,0))}for(let l=o.length-1;l>=0;l--)n.step(o[l])}function QS(n,e,t){let{$from:r,$to:i,depth:o}=e,s=r.before(o+1),l=i.after(o+1),a=s,u=l,c=v.empty,f=0;for(let h=o,m=!1;h>t;h--)m||r.index(h)>0?(m=!0,c=v.from(r.node(h).copy(c)),f++):a--;let d=v.empty,p=0;for(let h=o,m=!1;h>t;h--)m||i.after(h+1)<i.end(h)?(m=!0,d=v.from(i.node(h).copy(d)),p++):u++;n.step(new ur(a,u,s,l,new w(c.append(d),f,p),c.size-f,!0))}function YS(n,e,t){let r=v.empty;for(let s=t.length-1;s>=0;s--){if(r.size){let l=t[s].type.contentMatch.matchFragment(r);if(!l||!l.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=v.from(t[s].type.create(t[s].attrs,r))}let i=e.start,o=e.end;n.step(new ur(i,o,i,o,new w(r,0,0),t.length,!0))}function GS(n,e,t,r,i){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let o=n.steps.length;n.doc.nodesBetween(e,t,(s,l)=>{if(s.isTextblock&&!s.hasMarkup(r,i)&&XS(n.doc,n.mapping.slice(o).map(l),r)){n.clearIncompatible(n.mapping.slice(o).map(l,1),r);let a=n.mapping.slice(o),u=a.map(l,1),c=a.map(l+s.nodeSize,1);return n.step(new ur(u,c,u+1,c-1,new w(v.from(r.create(i,null,s.marks)),0,0),1,!0)),!1}})}function XS(n,e,t){let r=n.resolve(e),i=r.index();return r.parent.canReplaceWith(i,i+1,t)}function ZS(n,e,t,r,i){let o=n.doc.nodeAt(e);if(!o)throw new RangeError("No node at given position");t||(t=o.type);let s=t.create(r,null,i||o.marks);if(o.isLeaf)return n.replaceWith(e,e+o.nodeSize,s);if(!t.validContent(o.content))throw new RangeError("Invalid content for node type "+t.name);n.step(new ur(e,e+o.nodeSize,e+1,e+o.nodeSize-1,new w(v.from(s),0,0),1,!0))}function ek(n,e,t=1,r){let i=n.doc.resolve(e),o=v.empty,s=v.empty;for(let l=i.depth,a=i.depth-t,u=t-1;l>a;l--,u--){o=v.from(i.node(l).copy(o));let c=r&&r[u];s=v.from(c?c.type.create(c.attrs,s):i.node(l).copy(s))}n.step(new Tn(e,e,new w(o.append(s),t,t),!0))}function tk(n,e,t){let r=new Tn(e-t,e+t,w.empty,!0);n.step(r)}function nk(n,e,t){let r=n.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),t))return e;if(r.parentOffset==0)for(let i=r.depth-1;i>=0;i--){let o=r.index(i);if(r.node(i).canReplaceWith(o,o,t))return r.before(i+1);if(o>0)return null}if(r.parentOffset==r.parent.content.size)for(let i=r.depth-1;i>=0;i--){let o=r.indexAfter(i);if(r.node(i).canReplaceWith(o,o,t))return r.after(i+1);if(o<r.node(i).childCount)return null}return null}function rk(n,e,t=e,r=w.empty){if(e==t&&!r.size)return null;let i=n.resolve(e),o=n.resolve(t);return Wm(i,o,r)?new Tn(e,t,r):new ik(i,o,r).fit()}function Wm(n,e,t){return!t.openStart&&!t.openEnd&&n.start()==e.start()&&n.parent.canReplace(n.index(),e.index(),t.content)}let ik=class{constructor(e,t,r){this.$from=e,this.$to=t,this.unplaced=r,this.frontier=[],this.placed=v.empty;for(let i=0;i<=e.depth;i++){let o=e.node(i);this.frontier.push({type:o.type,match:o.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=v.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let u=this.findFittable();u?this.placeNodes(u):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(e<0?this.$to:r.doc.resolve(e));if(!i)return null;let o=this.placed,s=r.depth,l=i.depth;for(;s&&l&&o.childCount==1;)o=o.firstChild.content,s--,l--;let a=new w(o,s,l);return e>-1?new ur(r.pos,e,this.$to.pos,this.$to.end(),a,t):a.size||r.pos!=this.$to.pos?new Tn(r.pos,i.pos,a):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,r=0,i=this.unplaced.openEnd;r<e;r++){let o=t.firstChild;if(t.childCount>1&&(i=0),o.type.spec.isolating&&i<=r){e=r;break}t=o.content}for(let t=1;t<=2;t++)for(let r=t==1?e:this.unplaced.openStart;r>=0;r--){let i,o=null;r?(o=xa(this.unplaced.content,r-1).firstChild,i=o.content):i=this.unplaced.content;let s=i.firstChild;for(let l=this.depth;l>=0;l--){let{type:a,match:u}=this.frontier[l],c,f=null;if(t==1&&(s?u.matchType(s.type)||(f=u.fillBefore(v.from(s),!1)):o&&a.compatibleContent(o.type)))return{sliceDepth:r,frontierDepth:l,parent:o,inject:f};if(t==2&&s&&(c=u.findWrapping(s.type)))return{sliceDepth:r,frontierDepth:l,parent:o,wrap:c};if(o&&u.matchType(o.type))break}}}openMore(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=xa(e,t);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new w(e,t+1,Math.max(r,i.size+t>=e.size-r?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=xa(e,t);if(i.childCount<=1&&t>0){let o=e.size-t<=t+i.size;this.unplaced=new w(Ii(e,t-1,1),t-1,o?t-1:r)}else this.unplaced=new w(Ii(e,t,1),t,r)}placeNodes({sliceDepth:e,frontierDepth:t,parent:r,inject:i,wrap:o}){for(;this.depth>t;)this.closeFrontierNode();if(o)for(let m=0;m<o.length;m++)this.openFrontierNode(o[m]);let s=this.unplaced,l=r?r.content:s.content,a=s.openStart-e,u=0,c=[],{match:f,type:d}=this.frontier[t];if(i){for(let m=0;m<i.childCount;m++)c.push(i.child(m));f=f.matchFragment(i)}let p=l.size+e-(s.content.size-s.openEnd);for(;u<l.childCount;){let m=l.child(u),k=f.matchType(m.type);if(!k)break;u++,(u>1||a==0||m.content.size)&&(f=k,c.push(Um(m.mark(d.allowedMarks(m.marks)),u==1?a:0,u==l.childCount?p:-1)))}let h=u==l.childCount;h||(p=-1),this.placed=bi(this.placed,t,v.from(c)),this.frontier[t].match=f,h&&p<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let m=0,k=l;m<p;m++){let g=k.lastChild;this.frontier.push({type:g.type,match:g.contentMatchAt(g.childCount)}),k=g.content}this.unplaced=h?e==0?w.empty:new w(Ii(s.content,e-1,1),e-1,p<0?s.openEnd:e-1):new w(Ii(s.content,e,u),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!Ca(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:r,type:i}=this.frontier[t],o=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),s=Ca(e,t,i,r,o);if(s){for(let l=t-1;l>=0;l--){let{match:a,type:u}=this.frontier[l],c=Ca(e,l,u,a,!0);if(!c||c.childCount)continue e}return{depth:t,fit:s,move:o?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=bi(this.placed,t.depth,t.fit)),e=t.move;for(let r=t.depth+1;r<=e.depth;r++){let i=e.node(r),o=i.type.contentMatch.fillBefore(i.content,!0,e.index(r));this.openFrontierNode(i.type,i.attrs,o)}return e}openFrontierNode(e,t=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=bi(this.placed,this.depth,v.from(e.create(t,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(v.empty,!0);t.childCount&&(this.placed=bi(this.placed,this.frontier.length,t))}};function Ii(n,e,t){return e==0?n.cutByIndex(t,n.childCount):n.replaceChild(0,n.firstChild.copy(Ii(n.firstChild.content,e-1,t)))}function bi(n,e,t){return e==0?n.append(t):n.replaceChild(n.childCount-1,n.lastChild.copy(bi(n.lastChild.content,e-1,t)))}function xa(n,e){for(let t=0;t<e;t++)n=n.firstChild.content;return n}function Um(n,e,t){if(e<=0)return n;let r=n.content;return e>1&&(r=r.replaceChild(0,Um(r.firstChild,e-1,r.childCount==1?t-1:0))),e>0&&(r=n.type.contentMatch.fillBefore(r).append(r),t<=0&&(r=r.append(n.type.contentMatch.matchFragment(r).fillBefore(v.empty,!0)))),n.copy(r)}function Ca(n,e,t,r,i){let o=n.node(e),s=i?n.indexAfter(e):n.index(e);if(s==o.childCount&&!t.compatibleContent(o.type))return null;let l=r.fillBefore(o.content,!0,s);return l&&!ok(t,o.content,s)?l:null}function ok(n,e,t){for(let r=t;r<e.childCount;r++)if(!n.allowsMarks(e.child(r).marks))return!0;return!1}function sk(n){return n.spec.defining||n.spec.definingForContent}function lk(n,e,t,r){if(!r.size)return n.deleteRange(e,t);let i=n.doc.resolve(e),o=n.doc.resolve(t);if(Wm(i,o,r))return n.step(new Tn(e,t,r));let s=jm(i,n.doc.resolve(t));s[s.length-1]==0&&s.pop();let l=-(i.depth+1);s.unshift(l);for(let d=i.depth,p=i.pos-1;d>0;d--,p--){let h=i.node(d).type.spec;if(h.defining||h.definingAsContext||h.isolating)break;s.indexOf(d)>-1?l=d:i.before(d)==p&&s.splice(1,0,-d)}let a=s.indexOf(l),u=[],c=r.openStart;for(let d=r.content,p=0;;p++){let h=d.firstChild;if(u.push(h),p==r.openStart)break;d=h.content}for(let d=c-1;d>=0;d--){let p=u[d].type,h=sk(p);if(h&&i.node(a).type!=p)c=d;else if(h||!p.isTextblock)break}for(let d=r.openStart;d>=0;d--){let p=(d+c+1)%(r.openStart+1),h=u[p];if(h)for(let m=0;m<s.length;m++){let k=s[(m+a)%s.length],g=!0;k<0&&(g=!1,k=-k);let y=i.node(k-1),S=i.index(k-1);if(y.canReplaceWith(S,S,h.type,h.marks))return n.replace(i.before(k),g?o.after(k):t,new w(Hm(r.content,0,r.openStart,p),p,r.openEnd))}}let f=n.steps.length;for(let d=s.length-1;d>=0&&(n.replace(e,t,r),!(n.steps.length>f));d--){let p=s[d];p<0||(e=i.before(p),t=o.after(p))}}function Hm(n,e,t,r,i){if(e<t){let o=n.firstChild;n=n.replaceChild(0,o.copy(Hm(o.content,e+1,t,r,o)))}if(e>r){let o=i.contentMatchAt(0),s=o.fillBefore(n).append(n);n=s.append(o.matchFragment(s).fillBefore(v.empty,!0))}return n}function ak(n,e,t,r){if(!r.isInline&&e==t&&n.doc.resolve(e).parent.content.size){let i=nk(n.doc,e,r.type);i!=null&&(e=t=i)}n.replaceRange(e,t,new w(v.from(r),0,0))}function uk(n,e,t){let r=n.doc.resolve(e),i=n.doc.resolve(t),o=jm(r,i);for(let s=0;s<o.length;s++){let l=o[s],a=s==o.length-1;if(a&&l==0||r.node(l).type.contentMatch.validEnd)return n.delete(r.start(l),i.end(l));if(l>0&&(a||r.node(l-1).canReplace(r.index(l-1),i.indexAfter(l-1))))return n.delete(r.before(l),i.after(l))}for(let s=1;s<=r.depth&&s<=i.depth;s++)if(e-r.start(s)==r.depth-s&&t>r.end(s)&&i.end(s)-t!=i.depth-s)return n.delete(r.before(s),t);n.delete(e,t)}function jm(n,e){let t=[],r=Math.min(n.depth,e.depth);for(let i=r;i>=0;i--){let o=n.start(i);if(o<n.pos-(n.depth-i)||e.end(i)>e.pos+(e.depth-i)||n.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(o==e.start(i)||i==n.depth&&i==e.depth&&n.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==o-1)&&t.push(i)}return t}let Km=class Bs extends je{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return Le.fail("No node at attribute step's position");let r=Object.create(null);for(let o in t.attrs)r[o]=t.attrs[o];r[this.attr]=this.value;let i=t.type.create(r,null,t.marks);return Le.fromReplace(e,this.pos,this.pos+1,new w(v.from(i),0,t.isLeaf?0:1))}getMap(){return Hr.empty}invert(e){return new Bs(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Bs(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Bs(t.pos,t.attr,t.value)}};je.jsonID("attr",Km);let jr=class extends Error{};jr=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};jr.prototype=Object.create(Error.prototype);jr.prototype.constructor=jr;jr.prototype.name="TransformError";let ck=class{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new HS}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new jr(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,r=w.empty){let i=rk(this.doc,e,t,r);return i&&this.step(i),this}replaceWith(e,t,r){return this.replace(e,t,new w(v.from(r),0,0))}delete(e,t){return this.replace(e,t,w.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,r){return lk(this,e,t,r),this}replaceRangeWith(e,t,r){return ak(this,e,t,r),this}deleteRange(e,t){return uk(this,e,t),this}lift(e,t){return QS(this,e,t),this}join(e,t=1){return tk(this,e,t),this}wrap(e,t){return YS(this,e,t),this}setBlockType(e,t=e,r,i=null){return GS(this,e,t,r,i),this}setNodeMarkup(e,t,r=null,i){return ZS(this,e,t,r,i),this}setNodeAttribute(e,t,r){return this.step(new Km(e,t,r)),this}addNodeMark(e,t){return this.step(new Yc(e,t)),this}removeNodeMark(e,t){if(!(t instanceof _)){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(t=t.isInSet(r.marks),!t)return this}return this.step(new Gc(e,t)),this}split(e,t=1,r){return ek(this,e,t,r),this}addMark(e,t,r){return jS(this,e,t,r),this}removeMark(e,t,r){return KS(this,e,t,r),this}clearIncompatible(e,t,r){return qS(this,e,t,r),this}};const Na=Object.create(null);class P{constructor(e,t,r){this.$anchor=e,this.$head=t,this.ranges=r||[new qm(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=w.empty){let r=t.content.lastChild,i=null;for(let l=0;l<t.openEnd;l++)i=r,r=r.lastChild;let o=e.steps.length,s=this.ranges;for(let l=0;l<s.length;l++){let{$from:a,$to:u}=s[l],c=e.mapping.slice(o);e.replaceRange(c.map(a.pos),c.map(u.pos),l?w.empty:t),l==0&&Id(e,o,(r?r.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,t){let r=e.steps.length,i=this.ranges;for(let o=0;o<i.length;o++){let{$from:s,$to:l}=i[o],a=e.mapping.slice(r),u=a.map(s.pos),c=a.map(l.pos);o?e.deleteRange(u,c):(e.replaceRangeWith(u,c,t),Id(e,r,t.isInline?-1:1))}}static findFrom(e,t,r=!1){let i=e.parent.inlineContent?new $(e):Sr(e.node(0),e.parent,e.pos,e.index(),t,r);if(i)return i;for(let o=e.depth-1;o>=0;o--){let s=t<0?Sr(e.node(0),e.node(o),e.before(o+1),e.index(o),t,r):Sr(e.node(0),e.node(o),e.after(o+1),e.index(o)+1,t,r);if(s)return s}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new Xe(e.node(0))}static atStart(e){return Sr(e,e,0,0,1)||new Xe(e)}static atEnd(e){return Sr(e,e,e.content.size,e.childCount,-1)||new Xe(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=Na[t.type];if(!r)throw new RangeError(`No selection type ${t.type} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in Na)throw new RangeError("Duplicate use of selection JSON ID "+e);return Na[e]=t,t.prototype.jsonID=e,t}getBookmark(){return $.between(this.$anchor,this.$head).getBookmark()}}P.prototype.visible=!0;class qm{constructor(e,t){this.$from=e,this.$to=t}}let Rd=!1;function Ad(n){!Rd&&!n.parent.inlineContent&&(Rd=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+n.parent.type.name+")"))}class $ extends P{constructor(e,t=e){Ad(e),Ad(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let r=e.resolve(t.map(this.head));if(!r.parent.inlineContent)return P.near(r);let i=e.resolve(t.map(this.anchor));return new $(i.parent.inlineContent?i:r,r)}replace(e,t=w.empty){if(super.replace(e,t),t==w.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof $&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new Ul(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if(typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new $(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,r=t){let i=e.resolve(t);return new this(i,r==t?i:e.resolve(r))}static between(e,t,r){let i=e.pos-t.pos;if((!r||i)&&(r=i>=0?1:-1),!t.parent.inlineContent){let o=P.findFrom(t,r,!0)||P.findFrom(t,-r,!0);if(o)t=o.$head;else return P.near(t,r)}return e.parent.inlineContent||(i==0?e=t:(e=(P.findFrom(e,-r,!0)||P.findFrom(e,r,!0)).$anchor,e.pos<t.pos!=i<0&&(e=t))),new $(e,t)}}P.jsonID("text",$);class Ul{constructor(e,t){this.anchor=e,this.head=t}map(e){return new Ul(e.map(this.anchor),e.map(this.head))}resolve(e){return $.between(e.resolve(this.anchor),e.resolve(this.head))}}class z extends P{constructor(e){let t=e.nodeAfter,r=e.node(0).resolve(e.pos+t.nodeSize);super(e,r),this.node=t}map(e,t){let{deleted:r,pos:i}=t.mapResult(this.anchor),o=e.resolve(i);return r?P.near(o):new z(o)}content(){return new w(v.from(this.node),0,0)}eq(e){return e instanceof z&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new Xc(this.anchor)}static fromJSON(e,t){if(typeof t.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new z(e.resolve(t.anchor))}static create(e,t){return new z(e.resolve(t))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}z.prototype.visible=!1;P.jsonID("node",z);class Xc{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:r}=e.mapResult(this.anchor);return t?new Ul(r,r):new Xc(r)}resolve(e){let t=e.resolve(this.anchor),r=t.nodeAfter;return r&&z.isSelectable(r)?new z(t):P.near(t)}}class Xe extends P{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=w.empty){if(t==w.empty){e.delete(0,e.doc.content.size);let r=P.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new Xe(e)}map(e){return new Xe(e)}eq(e){return e instanceof Xe}getBookmark(){return fk}}P.jsonID("all",Xe);const fk={map(){return this},resolve(n){return new Xe(n)}};function Sr(n,e,t,r,i,o=!1){if(e.inlineContent)return $.create(n,t);for(let s=r-(i>0?0:1);i>0?s<e.childCount:s>=0;s+=i){let l=e.child(s);if(l.isAtom){if(!o&&z.isSelectable(l))return z.create(n,t-(i<0?l.nodeSize:0))}else{let a=Sr(n,l,t+i,i<0?l.childCount:0,i,o);if(a)return a}t+=l.nodeSize*i}return null}function Id(n,e,t){let r=n.steps.length-1;if(r<e)return;let i=n.steps[r];if(!(i instanceof Tn||i instanceof ur))return;let o=n.mapping.maps[r],s;o.forEach((l,a,u,c)=>{s==null&&(s=c)}),n.setSelection(P.near(n.doc.resolve(s),t))}const bd=1,ls=2,zd=4;class dk extends ck{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|bd)&~ls,this.storedMarks=null,this}get selectionSet(){return(this.updated&bd)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=ls,this}ensureMarks(e){return _.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&ls)>0}addStep(e,t){super.addStep(e,t),this.updated=this.updated&~ls,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,t=!0){let r=this.selection;return t&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||_.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,r){let i=this.doc.type.schema;if(t==null)return e?this.replaceSelectionWith(i.text(e),!0):this.deleteSelection();{if(r==null&&(r=t),r=r??t,!e)return this.deleteRange(t,r);let o=this.storedMarks;if(!o){let s=this.doc.resolve(t);o=r==t?s.marks():s.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(t,r,i.text(e,o)),this.selection.empty||this.setSelection(P.near(this.selection.$to)),this}}setMeta(e,t){return this.meta[typeof e=="string"?e:e.key]=t,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=zd,this}get scrolledIntoView(){return(this.updated&zd)>0}}function Pd(n,e){return!e||!n?n:n.bind(e)}class zi{constructor(e,t,r){this.name=e,this.init=Pd(t.init,r),this.apply=Pd(t.apply,r)}}const hk=[new zi("doc",{init(n){return n.doc||n.schema.topNodeType.createAndFill()},apply(n){return n.doc}}),new zi("selection",{init(n,e){return n.selection||P.atStart(e.doc)},apply(n){return n.selection}}),new zi("storedMarks",{init(n){return n.storedMarks||null},apply(n,e,t,r){return r.selection.$cursor?n.storedMarks:null}}),new zi("scrollToSelection",{init(){return 0},apply(n,e){return n.scrolledIntoView?e+1:e}})];class Ma{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=hk.slice(),t&&t.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new zi(r.key,r.spec.state,r))})}}class cn{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,t=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=t){let i=this.config.plugins[r];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],r=this.applyInner(e),i=null;for(;;){let o=!1;for(let s=0;s<this.config.plugins.length;s++){let l=this.config.plugins[s];if(l.spec.appendTransaction){let a=i?i[s].n:0,u=i?i[s].state:this,c=a<t.length&&l.spec.appendTransaction.call(l,a?t.slice(a):t,u,r);if(c&&r.filterTransaction(c,s)){if(c.setMeta("appendedTransaction",e),!i){i=[];for(let f=0;f<this.config.plugins.length;f++)i.push(f<s?{state:r,n:t.length}:{state:this,n:0})}t.push(c),r=r.applyInner(c),o=!0}i&&(i[s]={state:r,n:t.length})}}if(!o)return{state:r,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let t=new cn(this.config),r=this.config.fields;for(let i=0;i<r.length;i++){let o=r[i];t[o.name]=o.apply(e,this[o.name],this,t)}return t}get tr(){return new dk(this)}static create(e){let t=new Ma(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new cn(t);for(let i=0;i<t.fields.length;i++)r[t.fields[i].name]=t.fields[i].init(e,r);return r}reconfigure(e){let t=new Ma(this.schema,e.plugins),r=t.fields,i=new cn(t);for(let o=0;o<r.length;o++){let s=r[o].name;i[s]=this.hasOwnProperty(s)?this[s]:r[o].init(e,i)}return i}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=e[r],o=i.spec.state;o&&o.toJSON&&(t[r]=o.toJSON.call(i,this[i.key]))}return t}static fromJSON(e,t,r){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let i=new Ma(e.schema,e.plugins),o=new cn(i);return i.fields.forEach(s=>{if(s.name=="doc")o.doc=Ot.fromJSON(e.schema,t.doc);else if(s.name=="selection")o.selection=P.fromJSON(o.doc,t.selection);else if(s.name=="storedMarks")t.storedMarks&&(o.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let l in r){let a=r[l],u=a.spec.state;if(a.key==s.name&&u&&u.fromJSON&&Object.prototype.hasOwnProperty.call(t,l)){o[s.name]=u.fromJSON.call(a,e,t[l],o);return}}o[s.name]=s.init(e,o)}}),o}}function Qm(n,e,t){for(let r in n){let i=n[r];i instanceof Function?i=i.bind(e):r=="handleDOMEvents"&&(i=Qm(i,e,{})),t[r]=i}return t}class Ft{constructor(e){this.spec=e,this.props={},e.props&&Qm(e.props,this,this.props),this.key=e.key?e.key.key:Ym("plugin")}getState(e){return e[this.key]}}const Ea=Object.create(null);function Ym(n){return n in Ea?n+"$"+ ++Ea[n]:(Ea[n]=0,n+"$")}class Ho{constructor(e="key"){this.key=Ym(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const Gm=(n,e)=>n.selection.empty?!1:(e&&e(n.tr.deleteSelection().scrollIntoView()),!0);function pk(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("backward",n):t.parentOffset>0)?null:t}const mk=(n,e,t)=>{let r=pk(n,t);if(!r)return!1;let i=Xm(r);if(!i){let s=r.blockRange(),l=s&&Kc(s);return l==null?!1:(e&&e(n.tr.lift(s,l).scrollIntoView()),!0)}let o=i.nodeBefore;if(!o.type.spec.isolating&&eg(n,i,e))return!0;if(r.parent.content.size==0&&(Kr(o,"end")||z.isSelectable(o))){let s=Fm(n.doc,r.before(),r.after(),w.empty);if(s&&s.slice.size<s.to-s.from){if(e){let l=n.tr.step(s);l.setSelection(Kr(o,"end")?P.findFrom(l.doc.resolve(l.mapping.map(i.pos,-1)),-1):z.create(l.doc,i.pos-o.nodeSize)),e(l.scrollIntoView())}return!0}}return o.isAtom&&i.depth==r.depth-1?(e&&e(n.tr.delete(i.pos-o.nodeSize,i.pos).scrollIntoView()),!0):!1};function Kr(n,e,t=!1){for(let r=n;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(t&&r.childCount!=1)return!1}return!1}const gk=(n,e,t)=>{let{$head:r,empty:i}=n.selection,o=r;if(!i)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("backward",n):r.parentOffset>0)return!1;o=Xm(r)}let s=o&&o.nodeBefore;return!s||!z.isSelectable(s)?!1:(e&&e(n.tr.setSelection(z.create(n.doc,o.pos-s.nodeSize)).scrollIntoView()),!0)};function Xm(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){if(n.index(e)>0)return n.doc.resolve(n.before(e+1));if(n.node(e).type.spec.isolating)break}return null}function yk(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("forward",n):t.parentOffset<t.parent.content.size)?null:t}const Sk=(n,e,t)=>{let r=yk(n,t);if(!r)return!1;let i=Zm(r);if(!i)return!1;let o=i.nodeAfter;if(eg(n,i,e))return!0;if(r.parent.content.size==0&&(Kr(o,"start")||z.isSelectable(o))){let s=Fm(n.doc,r.before(),r.after(),w.empty);if(s&&s.slice.size<s.to-s.from){if(e){let l=n.tr.step(s);l.setSelection(Kr(o,"start")?P.findFrom(l.doc.resolve(l.mapping.map(i.pos)),1):z.create(l.doc,l.mapping.map(i.pos))),e(l.scrollIntoView())}return!0}}return o.isAtom&&i.depth==r.depth-1?(e&&e(n.tr.delete(i.pos,i.pos+o.nodeSize).scrollIntoView()),!0):!1},kk=(n,e,t)=>{let{$head:r,empty:i}=n.selection,o=r;if(!i)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("forward",n):r.parentOffset<r.parent.content.size)return!1;o=Zm(r)}let s=o&&o.nodeAfter;return!s||!z.isSelectable(s)?!1:(e&&e(n.tr.setSelection(z.create(n.doc,o.pos)).scrollIntoView()),!0)};function Zm(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){let t=n.node(e);if(n.index(e)+1<t.childCount)return n.doc.resolve(n.after(e+1));if(t.type.spec.isolating)break}return null}const wk=(n,e)=>{let{$head:t,$anchor:r}=n.selection;return!t.parent.type.spec.code||!t.sameParent(r)?!1:(e&&e(n.tr.insertText(`
`).scrollIntoView()),!0)};function Zc(n){for(let e=0;e<n.edgeCount;e++){let{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}const vk=(n,e)=>{let{$head:t,$anchor:r}=n.selection;if(!t.parent.type.spec.code||!t.sameParent(r))return!1;let i=t.node(-1),o=t.indexAfter(-1),s=Zc(i.contentMatchAt(o));if(!s||!i.canReplaceWith(o,o,s))return!1;if(e){let l=t.after(),a=n.tr.replaceWith(l,l,s.createAndFill());a.setSelection(P.near(a.doc.resolve(l),1)),e(a.scrollIntoView())}return!0},xk=(n,e)=>{let t=n.selection,{$from:r,$to:i}=t;if(t instanceof Xe||r.parent.inlineContent||i.parent.inlineContent)return!1;let o=Zc(i.parent.contentMatchAt(i.indexAfter()));if(!o||!o.isTextblock)return!1;if(e){let s=(!r.parentOffset&&i.index()<i.parent.childCount?r:i).pos,l=n.tr.insert(s,o.createAndFill());l.setSelection($.create(l.doc,s+1)),e(l.scrollIntoView())}return!0},Ck=(n,e)=>{let{$cursor:t}=n.selection;if(!t||t.parent.content.size)return!1;if(t.depth>1&&t.after()!=t.end(-1)){let o=t.before();if(zs(n.doc,o))return e&&e(n.tr.split(o).scrollIntoView()),!0}let r=t.blockRange(),i=r&&Kc(r);return i==null?!1:(e&&e(n.tr.lift(r,i).scrollIntoView()),!0)};function Nk(n){return(e,t)=>{let{$from:r,$to:i}=e.selection;if(e.selection instanceof z&&e.selection.node.isBlock)return!r.parentOffset||!zs(e.doc,r.pos)?!1:(t&&t(e.tr.split(r.pos).scrollIntoView()),!0);if(!r.parent.isBlock)return!1;if(t){let o=i.parentOffset==i.parent.content.size,s=e.tr;(e.selection instanceof $||e.selection instanceof Xe)&&s.deleteSelection();let l=r.depth==0?null:Zc(r.node(-1).contentMatchAt(r.indexAfter(-1))),a=o&&l?[{type:l}]:void 0,u=zs(s.doc,s.mapping.map(r.pos),1,a);if(!a&&!u&&zs(s.doc,s.mapping.map(r.pos),1,l?[{type:l}]:void 0)&&(l&&(a=[{type:l}]),u=!0),u&&(s.split(s.mapping.map(r.pos),1,a),!o&&!r.parentOffset&&r.parent.type!=l)){let c=s.mapping.map(r.before()),f=s.doc.resolve(c);l&&r.node(-1).canReplaceWith(f.index(),f.index()+1,l)&&s.setNodeMarkup(s.mapping.map(r.before()),l)}t(s.scrollIntoView())}return!0}}const Mk=Nk(),Ek=(n,e)=>(e&&e(n.tr.setSelection(new Xe(n.doc))),!0);function Ok(n,e,t){let r=e.nodeBefore,i=e.nodeAfter,o=e.index();return!r||!i||!r.type.compatibleContent(i.type)?!1:!r.content.size&&e.parent.canReplace(o-1,o)?(t&&t(n.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(o,o+1)||!(i.isTextblock||Pm(n.doc,e.pos))?!1:(t&&t(n.tr.clearIncompatible(e.pos,r.type,r.contentMatchAt(r.childCount)).join(e.pos).scrollIntoView()),!0)}function eg(n,e,t){let r=e.nodeBefore,i=e.nodeAfter,o,s;if(r.type.spec.isolating||i.type.spec.isolating)return!1;if(Ok(n,e,t))return!0;let l=e.parent.canReplace(e.index(),e.index()+1);if(l&&(o=(s=r.contentMatchAt(r.childCount)).findWrapping(i.type))&&s.matchType(o[0]||i.type).validEnd){if(t){let f=e.pos+i.nodeSize,d=v.empty;for(let m=o.length-1;m>=0;m--)d=v.from(o[m].create(null,d));d=v.from(r.copy(d));let p=n.tr.step(new cl(e.pos-1,f,e.pos,f,new w(d,1,0),o.length,!0)),h=f+2*o.length;Pm(p.doc,h)&&p.join(h),t(p.scrollIntoView())}return!0}let a=P.findFrom(e,1),u=a&&a.$from.blockRange(a.$to),c=u&&Kc(u);if(c!=null&&c>=e.depth)return t&&t(n.tr.lift(u,c).scrollIntoView()),!0;if(l&&Kr(i,"start",!0)&&Kr(r,"end")){let f=r,d=[];for(;d.push(f),!f.isTextblock;)f=f.lastChild;let p=i,h=1;for(;!p.isTextblock;p=p.firstChild)h++;if(f.canReplace(f.childCount,f.childCount,p.content)){if(t){let m=v.empty;for(let g=d.length-1;g>=0;g--)m=v.from(d[g].copy(m));let k=n.tr.step(new cl(e.pos-d.length,e.pos+i.nodeSize,e.pos+h,e.pos+i.nodeSize-h,new w(m,d.length,0),0,!0));t(k.scrollIntoView())}return!0}}return!1}function tg(n){return function(e,t){let r=e.selection,i=n<0?r.$from:r.$to,o=i.depth;for(;i.node(o).isInline;){if(!o)return!1;o--}return i.node(o).isTextblock?(t&&t(e.tr.setSelection($.create(e.doc,n<0?i.start(o):i.end(o)))),!0):!1}}const Dk=tg(-1),Tk=tg(1);function Rk(n,e,t){for(let r=0;r<e.length;r++){let{$from:i,$to:o}=e[r],s=i.depth==0?n.inlineContent&&n.type.allowsMarkType(t):!1;if(n.nodesBetween(i.pos,o.pos,l=>{if(s)return!1;s=l.inlineContent&&l.type.allowsMarkType(t)}),s)return!0}return!1}function Fd(n,e=null){return function(t,r){let{empty:i,$cursor:o,ranges:s}=t.selection;if(i&&!o||!Rk(t.doc,s,n))return!1;if(r)if(o)n.isInSet(t.storedMarks||o.marks())?r(t.tr.removeStoredMark(n)):r(t.tr.addStoredMark(n.create(e)));else{let l=!1,a=t.tr;for(let u=0;!l&&u<s.length;u++){let{$from:c,$to:f}=s[u];l=t.doc.rangeHasMark(c.pos,f.pos,n)}for(let u=0;u<s.length;u++){let{$from:c,$to:f}=s[u];if(l)a.removeMark(c.pos,f.pos,n);else{let d=c.pos,p=f.pos,h=c.nodeAfter,m=f.nodeBefore,k=h&&h.isText?/^\s*/.exec(h.text)[0].length:0,g=m&&m.isText?/\s*$/.exec(m.text)[0].length:0;d+k<p&&(d+=k,p-=g),a.addMark(d,p,n.create(e))}}r(a.scrollIntoView())}return!0}}function ef(...n){return function(e,t,r){for(let i=0;i<n.length;i++)if(n[i](e,t,r))return!0;return!1}}let Oa=ef(Gm,mk,gk),Ld=ef(Gm,Sk,kk);const _t={Enter:ef(wk,xk,Ck,Mk),"Mod-Enter":vk,Backspace:Oa,"Mod-Backspace":Oa,"Shift-Backspace":Oa,Delete:Ld,"Mod-Delete":Ld,"Mod-a":Ek},ng={"Ctrl-h":_t.Backspace,"Alt-Backspace":_t["Mod-Backspace"],"Ctrl-d":_t.Delete,"Ctrl-Alt-Backspace":_t["Mod-Delete"],"Alt-Delete":_t["Mod-Delete"],"Alt-d":_t["Mod-Delete"],"Ctrl-a":Dk,"Ctrl-e":Tk};for(let n in _t)ng[n]=_t[n];const Ak=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform?os.platform()=="darwin":!1,Ik=Ak?ng:_t;var At={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},fl={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},$d=typeof navigator<"u"&&/Chrome\/(\d+)/.exec(navigator.userAgent),bk=typeof navigator<"u"&&/Mac/.test(navigator.platform),zk=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Pk=bk||$d&&+$d[1]<57;for(var pe=0;pe<10;pe++)At[48+pe]=At[96+pe]=String(pe);for(var pe=1;pe<=24;pe++)At[pe+111]="F"+pe;for(var pe=65;pe<=90;pe++)At[pe]=String.fromCharCode(pe+32),fl[pe]=String.fromCharCode(pe);for(var Da in At)fl.hasOwnProperty(Da)||(fl[Da]=At[Da]);function tf(n){var e=Pk&&(n.ctrlKey||n.altKey||n.metaKey)||zk&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",t=!e&&n.key||(n.shiftKey?fl:At)[n.keyCode]||n.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}const Fk=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!1;function Lk(n){let e=n.split(/-(?!$)/),t=e[e.length-1];t=="Space"&&(t=" ");let r,i,o,s;for(let l=0;l<e.length-1;l++){let a=e[l];if(/^(cmd|meta|m)$/i.test(a))s=!0;else if(/^a(lt)?$/i.test(a))r=!0;else if(/^(c|ctrl|control)$/i.test(a))i=!0;else if(/^s(hift)?$/i.test(a))o=!0;else if(/^mod$/i.test(a))Fk?s=!0:i=!0;else throw new Error("Unrecognized modifier name: "+a)}return r&&(t="Alt-"+t),i&&(t="Ctrl-"+t),s&&(t="Meta-"+t),o&&(t="Shift-"+t),t}function $k(n){let e=Object.create(null);for(let t in n)e[Lk(t)]=n[t];return e}function Ta(n,e,t=!0){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t&&e.shiftKey&&(n="Shift-"+n),n}function Bk(n){let e=$k(n);return function(t,r){let i=tf(r),o,s=e[Ta(i,r)];if(s&&s(t.state,t.dispatch,t))return!0;if(i.length==1&&i!=" "){if(r.shiftKey){let l=e[Ta(i,r,!1)];if(l&&l(t.state,t.dispatch,t))return!0}if((r.shiftKey||r.altKey||r.metaKey||i.charCodeAt(0)>127)&&(o=At[r.keyCode])&&o!=i){let l=e[Ta(o,r)];if(l&&l(t.state,t.dispatch,t))return!0}}return!1}}const rg=65535,ig=Math.pow(2,16);function Vk(n,e){return n+e*ig}function Bd(n){return n&rg}function Jk(n){return(n-(n&rg))/ig}const og=1,sg=2,Vs=4,lg=8;let Vd=class{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&lg)>0}get deletedBefore(){return(this.delInfo&(og|Vs))>0}get deletedAfter(){return(this.delInfo&(sg|Vs))>0}get deletedAcross(){return(this.delInfo&Vs)>0}},qr=class kr{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&kr.empty)return kr.empty}recover(e){let t=0,r=Bd(e);if(!this.inverted)for(let i=0;i<r;i++)t+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+t+Jk(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let i=0,o=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?i:0);if(a>e)break;let u=this.ranges[l+o],c=this.ranges[l+s],f=a+u;if(e<=f){let d=u?e==a?-1:e==f?1:t:t,p=a+i+(d<0?0:c);if(r)return p;let h=e==(t<0?a:f)?null:Vk(l/3,e-a),m=e==a?sg:e==f?og:Vs;return(t<0?e!=a:e!=f)&&(m|=lg),new Vd(p,m,h)}i+=c-u}return r?e+i:new Vd(e+i,0,null)}touches(e,t){let r=0,i=Bd(t),o=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?r:0);if(a>e)break;let u=this.ranges[l+o],c=a+u;if(e<=c&&l==i*3)return!0;r+=this.ranges[l+s]-u}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,o=0;i<this.ranges.length;i+=3){let s=this.ranges[i],l=s-(this.inverted?o:0),a=s+(this.inverted?0:o),u=this.ranges[i+t],c=this.ranges[i+r];e(l,l+u,a,a+c),o+=c-u}}invert(){return new kr(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?kr.empty:new kr(e<0?[0,-e,0]:[0,0,e])}};qr.empty=new qr([]);const Ra=Object.create(null);let Ke=class{getMap(){return qr.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=Ra[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in Ra)throw new RangeError("Duplicate use of step JSON ID "+e);return Ra[e]=t,t.prototype.jsonID=e,t}},$e=class Pi{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new Pi(e,null)}static fail(e){return new Pi(null,e)}static fromReplace(e,t,r,i){try{return Pi.ok(e.replace(t,r,i))}catch(o){if(o instanceof En)return Pi.fail(o.message);throw o}}};function nf(n,e,t){let r=[];for(let i=0;i<n.childCount;i++){let o=n.child(i);o.content.size&&(o=o.copy(nf(o.content,e,o))),o.isInline&&(o=e(o,t,i)),r.push(o)}return v.fromArray(r)}let ag=class Fi extends Ke{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),o=new w(nf(t.content,(s,l)=>!s.isAtom||!l.type.allowsMarkType(this.mark.type)?s:s.mark(this.mark.addToSet(s.marks)),i),t.openStart,t.openEnd);return $e.fromReplace(e,this.from,this.to,o)}invert(){return new ug(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Fi(t.pos,r.pos,this.mark)}merge(e){return e instanceof Fi&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Fi(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Fi(t.from,t.to,e.markFromJSON(t.mark))}};Ke.jsonID("addMark",ag);let ug=class Li extends Ke{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new w(nf(t.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),t.openStart,t.openEnd);return $e.fromReplace(e,this.from,this.to,r)}invert(){return new ag(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Li(t.pos,r.pos,this.mark)}merge(e){return e instanceof Li&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Li(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Li(t.from,t.to,e.markFromJSON(t.mark))}};Ke.jsonID("removeMark",ug);let cg=class $i extends Ke{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return $e.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return $e.fromReplace(e,this.pos,this.pos+1,new w(v.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let i=0;i<t.marks.length;i++)if(!t.marks[i].isInSet(r))return new $i(this.pos,t.marks[i]);return new $i(this.pos,this.mark)}}return new fg(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new $i(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new $i(t.pos,e.markFromJSON(t.mark))}};Ke.jsonID("addNodeMark",cg);let fg=class xu extends Ke{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return $e.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return $e.fromReplace(e,this.pos,this.pos+1,new w(v.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new cg(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new xu(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new xu(t.pos,e.markFromJSON(t.mark))}};Ke.jsonID("removeNodeMark",fg);let _k=class Bn extends Ke{constructor(e,t,r,i=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=i}apply(e){return this.structure&&Cu(e,this.from,this.to)?$e.fail("Structure replace would overwrite content"):$e.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new qr([this.from,this.to-this.from,this.slice.size])}invert(e){return new Bn(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new Bn(t.pos,Math.max(t.pos,r.pos),this.slice)}merge(e){if(!(e instanceof Bn)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?w.empty:new w(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new Bn(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?w.empty:new w(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new Bn(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Bn(t.from,t.to,w.fromJSON(e,t.slice),!!t.structure)}};Ke.jsonID("replace",_k);let Wk=class Js extends Ke{constructor(e,t,r,i,o,s,l=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=i,this.slice=o,this.insert=s,this.structure=l}apply(e){if(this.structure&&(Cu(e,this.from,this.gapFrom)||Cu(e,this.gapTo,this.to)))return $e.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return $e.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?$e.fromReplace(e,this.from,this.to,r):$e.fail("Content does not fit in gap")}getMap(){return new qr([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new Js(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=e.map(this.gapFrom,-1),o=e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||i<t.pos||o>r.pos?null:new Js(t.pos,r.pos,i,o,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Js(t.from,t.to,t.gapFrom,t.gapTo,w.fromJSON(e,t.slice),t.insert,!!t.structure)}};Ke.jsonID("replaceAround",Wk);function Cu(n,e,t){let r=n.resolve(e),i=t-e,o=r.depth;for(;i>0&&o>0&&r.indexAfter(o)==r.node(o).childCount;)o--,i--;if(i>0){let s=r.node(o).maybeChild(r.indexAfter(o));for(;i>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,i--}}return!1}function Uk(n,e,t){let r=n.resolve(e);if(!t.content.size)return e;let i=t.content;for(let o=0;o<t.openStart;o++)i=i.firstChild.content;for(let o=1;o<=(t.openStart==0&&t.size?2:1);o++)for(let s=r.depth;s>=0;s--){let l=s==r.depth?0:r.pos<=(r.start(s+1)+r.end(s+1))/2?-1:1,a=r.index(s)+(l>0?1:0),u=r.node(s),c=!1;if(o==1)c=u.canReplace(a,a,i);else{let f=u.contentMatchAt(a).findWrapping(i.firstChild.type);c=f&&u.canReplaceWith(a,a,f[0])}if(c)return l==0?r.pos:l<0?r.before(s+1):r.after(s+1)}return null}let Hk=class _s extends Ke{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return $e.fail("No node at attribute step's position");let r=Object.create(null);for(let o in t.attrs)r[o]=t.attrs[o];r[this.attr]=this.value;let i=t.type.create(r,null,t.marks);return $e.fromReplace(e,this.pos,this.pos+1,new w(v.from(i),0,t.isLeaf?0:1))}getMap(){return qr.empty}invert(e){return new _s(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new _s(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new _s(t.pos,t.attr,t.value)}};Ke.jsonID("attr",Hk);let mo=class extends Error{};mo=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};mo.prototype=Object.create(Error.prototype);mo.prototype.constructor=mo;mo.prototype.name="TransformError";const Oe=function(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e},go=function(n){let e=n.assignedSlot||n.parentNode;return e&&e.nodeType==11?e.host:e};let Jd=null;const Vt=function(n,e,t){let r=Jd||(Jd=document.createRange());return r.setEnd(n,t??n.nodeValue.length),r.setStart(n,e||0),r},rr=function(n,e,t,r){return t&&(_d(n,e,t,r,-1)||_d(n,e,t,r,1))},jk=/^(img|br|input|textarea|hr)$/i;function _d(n,e,t,r,i){for(;;){if(n==t&&e==r)return!0;if(e==(i<0?0:Nt(n))){let o=n.parentNode;if(!o||o.nodeType!=1||rf(n)||jk.test(n.nodeName)||n.contentEditable=="false")return!1;e=Oe(n)+(i<0?0:1),n=o}else if(n.nodeType==1){if(n=n.childNodes[e+(i<0?-1:0)],n.contentEditable=="false")return!1;e=i<0?Nt(n):0}else return!1}}function Nt(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function Kk(n,e,t){for(let r=e==0,i=e==Nt(n);r||i;){if(n==t)return!0;let o=Oe(n);if(n=n.parentNode,!n)return!1;r=r&&o==0,i=i&&o==Nt(n)}}function rf(n){let e;for(let t=n;t&&!(e=t.pmViewDesc);t=t.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==n||e.contentDOM==n)}const Hl=function(n){return n.focusNode&&rr(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)};function Wn(n,e){let t=document.createEvent("Event");return t.initEvent("keydown",!0,!0),t.keyCode=n,t.key=t.code=e,t}function qk(n){let e=n.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function Qk(n,e,t){if(n.caretPositionFromPoint)try{let r=n.caretPositionFromPoint(e,t);if(r)return{node:r.offsetNode,offset:r.offset}}catch{}if(n.caretRangeFromPoint){let r=n.caretRangeFromPoint(e,t);if(r)return{node:r.startContainer,offset:r.startOffset}}}const It=typeof navigator<"u"?navigator:null,Wd=typeof document<"u"?document:null,Rn=It&&It.userAgent||"",Nu=/Edge\/(\d+)/.exec(Rn),dg=/MSIE \d/.exec(Rn),Mu=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Rn),Je=!!(dg||Mu||Nu),gn=dg?document.documentMode:Mu?+Mu[1]:Nu?+Nu[1]:0,wt=!Je&&/gecko\/(\d+)/i.test(Rn);wt&&+(/Firefox\/(\d+)/.exec(Rn)||[0,0])[1];const Eu=!Je&&/Chrome\/(\d+)/.exec(Rn),xe=!!Eu,Yk=Eu?+Eu[1]:0,Re=!Je&&!!It&&/Apple Computer/.test(It.vendor),Qr=Re&&(/Mobile\/\w+/.test(Rn)||!!It&&It.maxTouchPoints>2),rt=Qr||(It?/Mac/.test(It.platform):!1),Gk=It?/Win/.test(It.platform):!1,gt=/Android \d/.test(Rn),jo=!!Wd&&"webkitFontSmoothing"in Wd.documentElement.style,Xk=jo?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function Zk(n){return{left:0,right:n.documentElement.clientWidth,top:0,bottom:n.documentElement.clientHeight}}function $t(n,e){return typeof n=="number"?n:n[e]}function ew(n){let e=n.getBoundingClientRect(),t=e.width/n.offsetWidth||1,r=e.height/n.offsetHeight||1;return{left:e.left,right:e.left+n.clientWidth*t,top:e.top,bottom:e.top+n.clientHeight*r}}function Ud(n,e,t){let r=n.someProp("scrollThreshold")||0,i=n.someProp("scrollMargin")||5,o=n.dom.ownerDocument;for(let s=t||n.dom;s;s=go(s)){if(s.nodeType!=1)continue;let l=s,a=l==o.body,u=a?Zk(o):ew(l),c=0,f=0;if(e.top<u.top+$t(r,"top")?f=-(u.top-e.top+$t(i,"top")):e.bottom>u.bottom-$t(r,"bottom")&&(f=e.bottom-e.top>u.bottom-u.top?e.top+$t(i,"top")-u.top:e.bottom-u.bottom+$t(i,"bottom")),e.left<u.left+$t(r,"left")?c=-(u.left-e.left+$t(i,"left")):e.right>u.right-$t(r,"right")&&(c=e.right-u.right+$t(i,"right")),c||f)if(a)o.defaultView.scrollBy(c,f);else{let d=l.scrollLeft,p=l.scrollTop;f&&(l.scrollTop+=f),c&&(l.scrollLeft+=c);let h=l.scrollLeft-d,m=l.scrollTop-p;e={left:e.left-h,top:e.top-m,right:e.right-h,bottom:e.bottom-m}}if(a||/^(fixed|sticky)$/.test(getComputedStyle(s).position))break}}function tw(n){let e=n.dom.getBoundingClientRect(),t=Math.max(0,e.top),r,i;for(let o=(e.left+e.right)/2,s=t+1;s<Math.min(innerHeight,e.bottom);s+=5){let l=n.root.elementFromPoint(o,s);if(!l||l==n.dom||!n.dom.contains(l))continue;let a=l.getBoundingClientRect();if(a.top>=t-20){r=l,i=a.top;break}}return{refDOM:r,refTop:i,stack:hg(n.dom)}}function hg(n){let e=[],t=n.ownerDocument;for(let r=n;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),n!=t);r=go(r));return e}function nw({refDOM:n,refTop:e,stack:t}){let r=n?n.getBoundingClientRect().top:0;pg(t,r==0?0:r-e)}function pg(n,e){for(let t=0;t<n.length;t++){let{dom:r,top:i,left:o}=n[t];r.scrollTop!=i+e&&(r.scrollTop=i+e),r.scrollLeft!=o&&(r.scrollLeft=o)}}let hr=null;function rw(n){if(n.setActive)return n.setActive();if(hr)return n.focus(hr);let e=hg(n);n.focus(hr==null?{get preventScroll(){return hr={preventScroll:!0},!0}}:void 0),hr||(hr=!1,pg(e,0))}function mg(n,e){let t,r=2e8,i,o=0,s=e.top,l=e.top,a,u;for(let c=n.firstChild,f=0;c;c=c.nextSibling,f++){let d;if(c.nodeType==1)d=c.getClientRects();else if(c.nodeType==3)d=Vt(c).getClientRects();else continue;for(let p=0;p<d.length;p++){let h=d[p];if(h.top<=s&&h.bottom>=l){s=Math.max(h.bottom,s),l=Math.min(h.top,l);let m=h.left>e.left?h.left-e.left:h.right<e.left?e.left-h.right:0;if(m<r){t=c,r=m,i=m&&t.nodeType==3?{left:h.right<e.left?h.right:h.left,top:e.top}:e,c.nodeType==1&&m&&(o=f+(e.left>=(h.left+h.right)/2?1:0));continue}}else h.top>e.top&&!a&&h.left<=e.left&&h.right>=e.left&&(a=c,u={left:Math.max(h.left,Math.min(h.right,e.left)),top:h.top});!t&&(e.left>=h.right&&e.top>=h.top||e.left>=h.left&&e.top>=h.bottom)&&(o=f+1)}}return!t&&a&&(t=a,i=u,r=0),t&&t.nodeType==3?iw(t,i):!t||r&&t.nodeType==1?{node:n,offset:o}:mg(t,i)}function iw(n,e){let t=n.nodeValue.length,r=document.createRange();for(let i=0;i<t;i++){r.setEnd(n,i+1),r.setStart(n,i);let o=tn(r,1);if(o.top!=o.bottom&&of(e,o))return{node:n,offset:i+(e.left>=(o.left+o.right)/2?1:0)}}return{node:n,offset:0}}function of(n,e){return n.left>=e.left-1&&n.left<=e.right+1&&n.top>=e.top-1&&n.top<=e.bottom+1}function ow(n,e){let t=n.parentNode;return t&&/^li$/i.test(t.nodeName)&&e.left<n.getBoundingClientRect().left?t:n}function sw(n,e,t){let{node:r,offset:i}=mg(e,t),o=-1;if(r.nodeType==1&&!r.firstChild){let s=r.getBoundingClientRect();o=s.left!=s.right&&t.left>(s.left+s.right)/2?1:-1}return n.docView.posFromDOM(r,i,o)}function lw(n,e,t,r){let i=-1;for(let o=e,s=!1;o!=n.dom;){let l=n.docView.nearestDesc(o,!0);if(!l)return null;if(l.dom.nodeType==1&&(l.node.isBlock&&l.parent&&!s||!l.contentDOM)){let a=l.dom.getBoundingClientRect();if(l.node.isBlock&&l.parent&&!s&&(s=!0,a.left>r.left||a.top>r.top?i=l.posBefore:(a.right<r.left||a.bottom<r.top)&&(i=l.posAfter)),!l.contentDOM&&i<0&&!l.node.isText)return(l.node.isBlock?r.top<(a.top+a.bottom)/2:r.left<(a.left+a.right)/2)?l.posBefore:l.posAfter}o=l.dom.parentNode}return i>-1?i:n.docView.posFromDOM(e,t,-1)}function gg(n,e,t){let r=n.childNodes.length;if(r&&t.top<t.bottom)for(let i=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-t.top)/(t.bottom-t.top))-2)),o=i;;){let s=n.childNodes[o];if(s.nodeType==1){let l=s.getClientRects();for(let a=0;a<l.length;a++){let u=l[a];if(of(e,u))return gg(s,e,u)}}if((o=(o+1)%r)==i)break}return n}function aw(n,e){let t=n.dom.ownerDocument,r,i=0,o=Qk(t,e.left,e.top);o&&({node:r,offset:i}=o);let s=(n.root.elementFromPoint?n.root:t).elementFromPoint(e.left,e.top),l;if(!s||!n.dom.contains(s.nodeType!=1?s.parentNode:s)){let u=n.dom.getBoundingClientRect();if(!of(e,u)||(s=gg(n.dom,e,u),!s))return null}if(Re)for(let u=s;r&&u;u=go(u))u.draggable&&(r=void 0);if(s=ow(s,e),r){if(wt&&r.nodeType==1&&(i=Math.min(i,r.childNodes.length),i<r.childNodes.length)){let c=r.childNodes[i],f;c.nodeName=="IMG"&&(f=c.getBoundingClientRect()).right<=e.left&&f.bottom>e.top&&i++}let u;jo&&i&&r.nodeType==1&&(u=r.childNodes[i-1]).nodeType==1&&u.contentEditable=="false"&&u.getBoundingClientRect().top>=e.top&&i--,r==n.dom&&i==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?l=n.state.doc.content.size:(i==0||r.nodeType!=1||r.childNodes[i-1].nodeName!="BR")&&(l=lw(n,r,i,e))}l==null&&(l=sw(n,s,e));let a=n.docView.nearestDesc(s,!0);return{pos:l,inside:a?a.posAtStart-a.border:-1}}function Hd(n){return n.top<n.bottom||n.left<n.right}function tn(n,e){let t=n.getClientRects();if(t.length){let r=t[e<0?0:t.length-1];if(Hd(r))return r}return Array.prototype.find.call(t,Hd)||n.getBoundingClientRect()}const uw=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function yg(n,e,t){let{node:r,offset:i,atom:o}=n.docView.domFromPos(e,t<0?-1:1),s=jo||wt;if(r.nodeType==3)if(s&&(uw.test(r.nodeValue)||(t<0?!i:i==r.nodeValue.length))){let a=tn(Vt(r,i,i),t);if(wt&&i&&/\s/.test(r.nodeValue[i-1])&&i<r.nodeValue.length){let u=tn(Vt(r,i-1,i-1),-1);if(u.top==a.top){let c=tn(Vt(r,i,i+1),-1);if(c.top!=a.top)return hi(c,c.left<u.left)}}return a}else{let a=i,u=i,c=t<0?1:-1;return t<0&&!i?(u++,c=-1):t>=0&&i==r.nodeValue.length?(a--,c=1):t<0?a--:u++,hi(tn(Vt(r,a,u),c),c<0)}if(!n.state.doc.resolve(e-(o||0)).parent.inlineContent){if(o==null&&i&&(t<0||i==Nt(r))){let a=r.childNodes[i-1];if(a.nodeType==1)return Aa(a.getBoundingClientRect(),!1)}if(o==null&&i<Nt(r)){let a=r.childNodes[i];if(a.nodeType==1)return Aa(a.getBoundingClientRect(),!0)}return Aa(r.getBoundingClientRect(),t>=0)}if(o==null&&i&&(t<0||i==Nt(r))){let a=r.childNodes[i-1],u=a.nodeType==3?Vt(a,Nt(a)-(s?0:1)):a.nodeType==1&&(a.nodeName!="BR"||!a.nextSibling)?a:null;if(u)return hi(tn(u,1),!1)}if(o==null&&i<Nt(r)){let a=r.childNodes[i];for(;a.pmViewDesc&&a.pmViewDesc.ignoreForCoords;)a=a.nextSibling;let u=a?a.nodeType==3?Vt(a,0,s?0:1):a.nodeType==1?a:null:null;if(u)return hi(tn(u,-1),!0)}return hi(tn(r.nodeType==3?Vt(r):r,-t),t>=0)}function hi(n,e){if(n.width==0)return n;let t=e?n.left:n.right;return{top:n.top,bottom:n.bottom,left:t,right:t}}function Aa(n,e){if(n.height==0)return n;let t=e?n.top:n.bottom;return{top:t,bottom:t,left:n.left,right:n.right}}function Sg(n,e,t){let r=n.state,i=n.root.activeElement;r!=e&&n.updateState(e),i!=n.dom&&n.focus();try{return t()}finally{r!=e&&n.updateState(r),i!=n.dom&&i&&i.focus()}}function cw(n,e,t){let r=e.selection,i=t=="up"?r.$from:r.$to;return Sg(n,e,()=>{let{node:o}=n.docView.domFromPos(i.pos,t=="up"?-1:1);for(;;){let l=n.docView.nearestDesc(o,!0);if(!l)break;if(l.node.isBlock){o=l.contentDOM||l.dom;break}o=l.dom.parentNode}let s=yg(n,i.pos,1);for(let l=o.firstChild;l;l=l.nextSibling){let a;if(l.nodeType==1)a=l.getClientRects();else if(l.nodeType==3)a=Vt(l,0,l.nodeValue.length).getClientRects();else continue;for(let u=0;u<a.length;u++){let c=a[u];if(c.bottom>c.top+1&&(t=="up"?s.top-c.top>(c.bottom-s.top)*2:c.bottom-s.bottom>(s.bottom-c.top)*2))return!1}}return!0})}const fw=/[\u0590-\u08ac]/;function dw(n,e,t){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let i=r.parentOffset,o=!i,s=i==r.parent.content.size,l=n.domSelection();return!fw.test(r.parent.textContent)||!l.modify?t=="left"||t=="backward"?o:s:Sg(n,e,()=>{let{focusNode:a,focusOffset:u,anchorNode:c,anchorOffset:f}=n.domSelectionRange(),d=l.caretBidiLevel;l.modify("move",t,"character");let p=r.depth?n.docView.domAfterPos(r.before()):n.dom,{focusNode:h,focusOffset:m}=n.domSelectionRange(),k=h&&!p.contains(h.nodeType==1?h:h.parentNode)||a==h&&u==m;try{l.collapse(c,f),a&&(a!=c||u!=f)&&l.extend&&l.extend(a,u)}catch{}return d!=null&&(l.caretBidiLevel=d),k})}let jd=null,Kd=null,qd=!1;function hw(n,e,t){return jd==e&&Kd==t?qd:(jd=e,Kd=t,qd=t=="up"||t=="down"?cw(n,e,t):dw(n,e,t))}const at=0,Qd=1,Hn=2,bt=3;let Ko=class{constructor(e,t,r,i){this.parent=e,this.children=t,this.dom=r,this.contentDOM=i,this.dirty=at,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,r=this.posAtStart;;t++){let i=this.children[t];if(i==e)return r;r+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let o,s;if(e==this.contentDOM)o=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.previousSibling}for(;o&&!((s=o.pmViewDesc)&&s.parent==this);)o=o.previousSibling;return o?this.posBeforeChild(s)+s.size:this.posAtStart}else{let o,s;if(e==this.contentDOM)o=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.nextSibling}for(;o&&!((s=o.pmViewDesc)&&s.parent==this);)o=o.nextSibling;return o?this.posBeforeChild(s):this.posAtEnd}let i;if(e==this.dom&&this.contentDOM)i=t>Oe(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(t==0)for(let o=e;;o=o.parentNode){if(o==this.dom){i=!1;break}if(o.previousSibling)break}if(i==null&&t==e.childNodes.length)for(let o=e;;o=o.parentNode){if(o==this.dom){i=!0;break}if(o.nextSibling)break}}return i??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,t=!1){for(let r=!0,i=e;i;i=i.parentNode){let o=this.getDesc(i),s;if(o&&(!t||o.node))if(r&&(s=o.nodeDOM)&&!(s.nodeType==1?s.contains(e.nodeType==1?e:e.parentNode):s==e))r=!1;else return o}}getDesc(e){let t=e.pmViewDesc;for(let r=t;r;r=r.parent)if(r==this)return t}posFromDOM(e,t,r){for(let i=e;i;i=i.parentNode){let o=this.getDesc(i);if(o)return o.localPosFromDOM(e,t,r)}return-1}descAt(e){for(let t=0,r=0;t<this.children.length;t++){let i=this.children[t],o=r+i.size;if(r==e&&o!=r){for(;!i.border&&i.children.length;)i=i.children[0];return i}if(e<o)return i.descAt(e-r-i.border);r=o}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,i=0;for(let o=0;r<this.children.length;r++){let s=this.children[r],l=o+s.size;if(l>e||s instanceof Cg){i=e-o;break}o=l}if(i)return this.children[r].domFromPos(i-this.children[r].border,t);for(let o;r&&!(o=this.children[r-1]).size&&o instanceof kg&&o.side>=0;r--);if(t<=0){let o,s=!0;for(;o=r?this.children[r-1]:null,!(!o||o.dom.parentNode==this.contentDOM);r--,s=!1);return o&&t&&s&&!o.border&&!o.domAtom?o.domFromPos(o.size,t):{node:this.contentDOM,offset:o?Oe(o.dom)+1:0}}else{let o,s=!0;for(;o=r<this.children.length?this.children[r]:null,!(!o||o.dom.parentNode==this.contentDOM);r++,s=!1);return o&&s&&!o.border&&!o.domAtom?o.domFromPos(0,t):{node:this.contentDOM,offset:o?Oe(o.dom):this.contentDOM.childNodes.length}}}parseRange(e,t,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,o=-1;for(let s=r,l=0;;l++){let a=this.children[l],u=s+a.size;if(i==-1&&e<=u){let c=s+a.border;if(e>=c&&t<=u-a.border&&a.node&&a.contentDOM&&this.contentDOM.contains(a.contentDOM))return a.parseRange(e,t,c);e=s;for(let f=l;f>0;f--){let d=this.children[f-1];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(1)){i=Oe(d.dom)+1;break}e-=d.size}i==-1&&(i=0)}if(i>-1&&(u>t||l==this.children.length-1)){t=u;for(let c=l+1;c<this.children.length;c++){let f=this.children[c];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(-1)){o=Oe(f.dom);break}t+=f.size}o==-1&&(o=this.contentDOM.childNodes.length);break}s=u}return{node:this.contentDOM,from:e,to:t,fromOffset:i,toOffset:o}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return t.size==0||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:r}=this.domFromPos(e,0);if(t.nodeType!=1||r==t.childNodes.length)throw new RangeError("No node after pos "+e);return t.childNodes[r]}setSelection(e,t,r,i=!1){let o=Math.min(e,t),s=Math.max(e,t);for(let d=0,p=0;d<this.children.length;d++){let h=this.children[d],m=p+h.size;if(o>p&&s<m)return h.setSelection(e-p-h.border,t-p-h.border,r,i);p=m}let l=this.domFromPos(e,e?-1:1),a=t==e?l:this.domFromPos(t,t?-1:1),u=r.getSelection(),c=!1;if((wt||Re)&&e==t){let{node:d,offset:p}=l;if(d.nodeType==3){if(c=!!(p&&d.nodeValue[p-1]==`
`),c&&p==d.nodeValue.length)for(let h=d,m;h;h=h.parentNode){if(m=h.nextSibling){m.nodeName=="BR"&&(l=a={node:m.parentNode,offset:Oe(m)+1});break}let k=h.pmViewDesc;if(k&&k.node&&k.node.isBlock)break}}else{let h=d.childNodes[p-1];c=h&&(h.nodeName=="BR"||h.contentEditable=="false")}}if(wt&&u.focusNode&&u.focusNode!=a.node&&u.focusNode.nodeType==1){let d=u.focusNode.childNodes[u.focusOffset];d&&d.contentEditable=="false"&&(i=!0)}if(!(i||c&&Re)&&rr(l.node,l.offset,u.anchorNode,u.anchorOffset)&&rr(a.node,a.offset,u.focusNode,u.focusOffset))return;let f=!1;if((u.extend||e==t)&&!c){u.collapse(l.node,l.offset);try{e!=t&&u.extend(a.node,a.offset),f=!0}catch{}}if(!f){if(e>t){let p=l;l=a,a=p}let d=document.createRange();d.setEnd(a.node,a.offset),d.setStart(l.node,l.offset),u.removeAllRanges(),u.addRange(d)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let r=0,i=0;i<this.children.length;i++){let o=this.children[i],s=r+o.size;if(r==s?e<=s&&t>=r:e<s&&t>r){let l=r+o.border,a=s-o.border;if(e>=l&&t<=a){this.dirty=e==r||t==s?Hn:Qd,e==l&&t==a&&(o.contentLost||o.dom.parentNode!=this.contentDOM)?o.dirty=bt:o.markDirty(e-l,t-l);return}else o.dirty=o.dom==o.contentDOM&&o.dom.parentNode==this.contentDOM&&!o.children.length?Hn:bt}r=s}this.dirty=Hn}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let r=e==1?Hn:Qd;t.dirty<r&&(t.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}},kg=class extends Ko{constructor(e,t,r,i){let o,s=t.type.toDOM;if(typeof s=="function"&&(s=s(r,()=>{if(!o)return i;if(o.parent)return o.parent.posBeforeChild(o)})),!t.type.spec.raw){if(s.nodeType!=1){let l=document.createElement("span");l.appendChild(s),s=l}s.contentEditable="false",s.classList.add("ProseMirror-widget")}super(e,[],s,null),this.widget=t,this.widget=t,o=this}matchesWidget(e){return this.dirty==at&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return t?t(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}},pw=class extends Ko{constructor(e,t,r,i){super(e,[],t,null),this.textDOM=r,this.text=i}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}},dl=class Ou extends Ko{constructor(e,t,r,i){super(e,[],r,i),this.mark=t}static create(e,t,r,i){let o=i.nodeViews[t.type.name],s=o&&o(t,i,r);return(!s||!s.dom)&&(s=Ut.renderSpec(document,t.type.spec.toDOM(t,r))),new Ou(e,t,s.dom,s.contentDOM||s.dom)}parseRule(){return this.dirty&bt||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=bt&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),this.dirty!=at){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=at}}slice(e,t,r){let i=Ou.create(this.parent,this.mark,!0,r),o=this.children,s=this.size;t<s&&(o=Ru(o,t,s,r)),e>0&&(o=Ru(o,0,e,r));for(let l=0;l<o.length;l++)o[l].parent=i;return i.children=o,i}},Pr=class wg extends Ko{constructor(e,t,r,i,o,s,l,a,u){super(e,[],o,s),this.node=t,this.outerDeco=r,this.innerDeco=i,this.nodeDOM=l}static create(e,t,r,i,o,s){let l=o.nodeViews[t.type.name],a,u=l&&l(t,o,()=>{if(!a)return s;if(a.parent)return a.parent.posBeforeChild(a)},r,i),c=u&&u.dom,f=u&&u.contentDOM;if(t.isText){if(!c)c=document.createTextNode(t.text);else if(c.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else c||({dom:c,contentDOM:f}=Ut.renderSpec(document,t.type.spec.toDOM(t)));!f&&!t.isText&&c.nodeName!="BR"&&(c.hasAttribute("contenteditable")||(c.contentEditable="false"),t.type.spec.draggable&&(c.draggable=!0));let d=c;return c=Eg(c,r,t),u?a=new mw(e,t,r,i,c,f||null,d,u,o,s+1):t.isText?new vg(e,t,r,i,c,d,o):new wg(e,t,r,i,c,f||null,d,o,s+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let t=this.children.length-1;t>=0;t--){let r=this.children[t];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>v.empty)}return e}matchesNode(e,t,r){return this.dirty==at&&e.eq(this.node)&&Tu(t,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,t){let r=this.node.inlineContent,i=t,o=e.composing?this.localCompositionInfo(e,t):null,s=o&&o.pos>-1?o:null,l=o&&o.pos<0,a=new yw(this,s&&s.node,e);ww(this.node,this.innerDeco,(u,c,f)=>{u.spec.marks?a.syncToMarks(u.spec.marks,r,e):u.type.side>=0&&!f&&a.syncToMarks(c==this.node.childCount?_.none:this.node.child(c).marks,r,e),a.placeWidget(u,e,i)},(u,c,f,d)=>{a.syncToMarks(u.marks,r,e);let p;a.findNodeMatch(u,c,f,d)||l&&e.state.selection.from>i&&e.state.selection.to<i+u.nodeSize&&(p=a.findIndexWithChild(o.node))>-1&&a.updateNodeAt(u,c,f,p,e)||a.updateNextNode(u,c,f,e,d,i)||a.addNode(u,c,f,e,i),i+=u.nodeSize}),a.syncToMarks([],r,e),this.node.isTextblock&&a.addTextblockHacks(),a.destroyRest(),(a.changed||this.dirty==Hn)&&(s&&this.protectLocalComposition(e,s),Ng(this.contentDOM,this.children,e),Qr&&vw(this.dom))}localCompositionInfo(e,t){let{from:r,to:i}=e.state.selection;if(!(e.state.selection instanceof $)||r<t||i>t+this.node.content.size)return null;let o=e.domSelectionRange(),s=xw(o.focusNode,o.focusOffset);if(!s||!this.dom.contains(s.parentNode))return null;if(this.node.inlineContent){let l=s.nodeValue,a=Cw(this.node.content,l,r-t,i-t);return a<0?null:{node:s,pos:a,text:l}}else return{node:s,pos:-1,text:""}}protectLocalComposition(e,{node:t,pos:r,text:i}){if(this.getDesc(t))return;let o=t;for(;o.parentNode!=this.contentDOM;o=o.parentNode){for(;o.previousSibling;)o.parentNode.removeChild(o.previousSibling);for(;o.nextSibling;)o.parentNode.removeChild(o.nextSibling);o.pmViewDesc&&(o.pmViewDesc=void 0)}let s=new pw(this,o,t,i);e.input.compositionNodes.push(s),this.children=Ru(this.children,r,r+i.length,e,s)}update(e,t,r,i){return this.dirty==bt||!e.sameMarkup(this.node)?!1:(this.updateInner(e,t,r,i),!0)}updateInner(e,t,r,i){this.updateOuterDeco(t),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=at}updateOuterDeco(e){if(Tu(e,this.outerDeco))return;let t=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=Mg(this.dom,this.nodeDOM,Du(this.outerDeco,this.node,t),Du(e,this.node,t)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable")}get domAtom(){return this.node.isAtom}};function Yd(n,e,t,r,i){Eg(r,e,n);let o=new Pr(void 0,n,e,t,r,r,r,i,0);return o.contentDOM&&o.updateChildren(i,0),o}let vg=class xg extends Pr{constructor(e,t,r,i,o,s,l){super(e,t,r,i,o,null,s,l,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,r,i){return this.dirty==bt||this.dirty!=at&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(t),(this.dirty!=at||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=e,this.dirty=at,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,r){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,t,r){let i=this.node.cut(e,t),o=document.createTextNode(i.text);return new xg(this.parent,i,this.outerDeco,this.innerDeco,o,o,r)}markDirty(e,t){super.markDirty(e,t),this.dom!=this.nodeDOM&&(e==0||t==this.nodeDOM.nodeValue.length)&&(this.dirty=bt)}get domAtom(){return!1}},Cg=class extends Ko{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==at&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}};class mw extends Pr{constructor(e,t,r,i,o,s,l,a,u,c){super(e,t,r,i,o,s,l,u,c),this.spec=a}update(e,t,r,i){if(this.dirty==bt)return!1;if(this.spec.update){let o=this.spec.update(e,t,r);return o&&this.updateInner(e,t,r,i),o}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,t,r,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,r,i){this.spec.setSelection?this.spec.setSelection(e,t,r):super.setSelection(e,t,r,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function Ng(n,e,t){let r=n.firstChild,i=!1;for(let o=0;o<e.length;o++){let s=e[o],l=s.dom;if(l.parentNode==n){for(;l!=r;)r=Gd(r),i=!0;r=r.nextSibling}else i=!0,n.insertBefore(l,r);if(s instanceof dl){let a=r?r.previousSibling:n.lastChild;Ng(s.contentDOM,s.children,t),r=a?a.nextSibling:n.firstChild}}for(;r;)r=Gd(r),i=!0;i&&t.trackWrites==n&&(t.trackWrites=null)}const Gi=function(n){n&&(this.nodeName=n)};Gi.prototype=Object.create(null);const jn=[new Gi];function Du(n,e,t){if(n.length==0)return jn;let r=t?jn[0]:new Gi,i=[r];for(let o=0;o<n.length;o++){let s=n[o].type.attrs;if(s){s.nodeName&&i.push(r=new Gi(s.nodeName));for(let l in s){let a=s[l];a!=null&&(t&&i.length==1&&i.push(r=new Gi(e.isInline?"span":"div")),l=="class"?r.class=(r.class?r.class+" ":"")+a:l=="style"?r.style=(r.style?r.style+";":"")+a:l!="nodeName"&&(r[l]=a))}}}return i}function Mg(n,e,t,r){if(t==jn&&r==jn)return e;let i=e;for(let o=0;o<r.length;o++){let s=r[o],l=t[o];if(o){let a;l&&l.nodeName==s.nodeName&&i!=n&&(a=i.parentNode)&&a.nodeName.toLowerCase()==s.nodeName||(a=document.createElement(s.nodeName),a.pmIsDeco=!0,a.appendChild(i),l=jn[0]),i=a}gw(i,l||jn[0],s)}return i}function gw(n,e,t){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in t)&&n.removeAttribute(r);for(let r in t)r!="class"&&r!="style"&&r!="nodeName"&&t[r]!=e[r]&&n.setAttribute(r,t[r]);if(e.class!=t.class){let r=e.class?e.class.split(" ").filter(Boolean):[],i=t.class?t.class.split(" ").filter(Boolean):[];for(let o=0;o<r.length;o++)i.indexOf(r[o])==-1&&n.classList.remove(r[o]);for(let o=0;o<i.length;o++)r.indexOf(i[o])==-1&&n.classList.add(i[o]);n.classList.length==0&&n.removeAttribute("class")}if(e.style!=t.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,i;for(;i=r.exec(e.style);)n.style.removeProperty(i[1])}t.style&&(n.style.cssText+=t.style)}}function Eg(n,e,t){return Mg(n,n,jn,Du(e,t,n.nodeType!=1))}function Tu(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].type.eq(e[t].type))return!1;return!0}function Gd(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class yw{constructor(e,t,r){this.lock=t,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=Sw(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let r=e;r<t;r++)this.top.children[r].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,r){let i=0,o=this.stack.length>>1,s=Math.min(o,e.length);for(;i<s&&(i==o-1?this.top:this.stack[i+1<<1]).matchesMark(e[i])&&e[i].type.spec.spanning!==!1;)i++;for(;i<o;)this.destroyRest(),this.top.dirty=at,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<e.length;){this.stack.push(this.top,this.index+1);let l=-1;for(let a=this.index;a<Math.min(this.index+3,this.top.children.length);a++){let u=this.top.children[a];if(u.matchesMark(e[o])&&!this.isLocked(u.dom)){l=a;break}}if(l>-1)l>this.index&&(this.changed=!0,this.destroyBetween(this.index,l)),this.top=this.top.children[this.index];else{let a=dl.create(this.top,e[o],t,r);this.top.children.splice(this.index,0,a),this.top=a,this.changed=!0}this.index=0,o++}}findNodeMatch(e,t,r,i){let o=-1,s;if(i>=this.preMatch.index&&(s=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&s.matchesNode(e,t,r))o=this.top.children.indexOf(s,this.index);else for(let l=this.index,a=Math.min(this.top.children.length,l+5);l<a;l++){let u=this.top.children[l];if(u.matchesNode(e,t,r)&&!this.preMatch.matched.has(u)){o=l;break}}return o<0?!1:(this.destroyBetween(this.index,o),this.index++,!0)}updateNodeAt(e,t,r,i,o){let s=this.top.children[i];return s.dirty==bt&&s.dom==s.contentDOM&&(s.dirty=Hn),s.update(e,t,r,o)?(this.destroyBetween(this.index,i),this.index++,!0):!1}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==r)return i}return-1}e=t}}updateNextNode(e,t,r,i,o,s){for(let l=this.index;l<this.top.children.length;l++){let a=this.top.children[l];if(a instanceof Pr){let u=this.preMatch.matched.get(a);if(u!=null&&u!=o)return!1;let c=a.dom,f,d=this.isLocked(c)&&!(e.isText&&a.node&&a.node.isText&&a.nodeDOM.nodeValue==e.text&&a.dirty!=bt&&Tu(t,a.outerDeco));if(!d&&a.update(e,t,r,i))return this.destroyBetween(this.index,l),a.dom!=c&&(this.changed=!0),this.index++,!0;if(!d&&(f=this.recreateWrapper(a,e,t,r,i,s)))return this.top.children[this.index]=f,f.contentDOM&&(f.dirty=Hn,f.updateChildren(i,s+1),f.dirty=at),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,t,r,i,o,s){if(e.dirty||t.isAtom||!e.children.length||!e.node.content.eq(t.content))return null;let l=Pr.create(this.top,t,r,i,o,s);if(l.contentDOM){l.children=e.children,e.children=[];for(let a of l.children)a.parent=l}return e.destroy(),l}addNode(e,t,r,i,o){let s=Pr.create(this.top,e,t,r,i,o);s.contentDOM&&s.updateChildren(i,o+1),this.top.children.splice(this.index++,0,s),this.changed=!0}placeWidget(e,t,r){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(i&&i.matchesWidget(e)&&(e==i.widget||!i.widget.type.toDOM.parentNode))this.index++;else{let o=new kg(this.top,e,t,r);this.top.children.splice(this.index++,0,o),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof dl;)t=e,e=t.children[t.children.length-1];(!e||!(e instanceof vg)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((Re||xe)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let i=new Cg(this.top,[],r,null);t!=this.top?t.children.push(i):t.children.splice(this.index++,0,i),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function Sw(n,e){let t=e,r=t.children.length,i=n.childCount,o=new Map,s=[];e:for(;i>0;){let l;for(;;)if(r){let u=t.children[r-1];if(u instanceof dl)t=u,r=u.children.length;else{l=u,r--;break}}else{if(t==e)break e;r=t.parent.children.indexOf(t),t=t.parent}let a=l.node;if(a){if(a!=n.child(i-1))break;--i,o.set(l,i),s.push(l)}}return{index:i,matched:o,matches:s.reverse()}}function kw(n,e){return n.type.side-e.type.side}function ww(n,e,t,r){let i=e.locals(n),o=0;if(i.length==0){for(let u=0;u<n.childCount;u++){let c=n.child(u);r(c,i,e.forChild(o,c),u),o+=c.nodeSize}return}let s=0,l=[],a=null;for(let u=0;;){let c,f;for(;s<i.length&&i[s].to==o;){let k=i[s++];k.widget&&(c?(f||(f=[c])).push(k):c=k)}if(c)if(f){f.sort(kw);for(let k=0;k<f.length;k++)t(f[k],u,!!a)}else t(c,u,!!a);let d,p;if(a)p=-1,d=a,a=null;else if(u<n.childCount)p=u,d=n.child(u++);else break;for(let k=0;k<l.length;k++)l[k].to<=o&&l.splice(k--,1);for(;s<i.length&&i[s].from<=o&&i[s].to>o;)l.push(i[s++]);let h=o+d.nodeSize;if(d.isText){let k=h;s<i.length&&i[s].from<k&&(k=i[s].from);for(let g=0;g<l.length;g++)l[g].to<k&&(k=l[g].to);k<h&&(a=d.cut(k-o),d=d.cut(0,k-o),h=k,p=-1)}else for(;s<i.length&&i[s].to<h;)s++;let m=d.isInline&&!d.isLeaf?l.filter(k=>!k.inline):l.slice();r(d,m,e.forChild(o,d),p),o=h}}function vw(n){if(n.nodeName=="UL"||n.nodeName=="OL"){let e=n.style.cssText;n.style.cssText=e+"; list-style: square !important",window.getComputedStyle(n).listStyle,n.style.cssText=e}}function xw(n,e){for(;;){if(n.nodeType==3)return n;if(n.nodeType==1&&e>0){if(n.childNodes.length>e&&n.childNodes[e].nodeType==3)return n.childNodes[e];n=n.childNodes[e-1],e=Nt(n)}else if(n.nodeType==1&&e<n.childNodes.length)n=n.childNodes[e],e=0;else return null}}function Cw(n,e,t,r){for(let i=0,o=0;i<n.childCount&&o<=r;){let s=n.child(i++),l=o;if(o+=s.nodeSize,!s.isText)continue;let a=s.text;for(;i<n.childCount;){let u=n.child(i++);if(o+=u.nodeSize,!u.isText)break;a+=u.text}if(o>=t){if(o>=r&&a.slice(r-e.length-l,r-l)==e)return r-e.length;let u=l<r?a.lastIndexOf(e,r-l-1):-1;if(u>=0&&u+e.length+l>=t)return l+u;if(t==r&&a.length>=r+e.length-l&&a.slice(r-l,r-l+e.length)==e)return r}}return-1}function Ru(n,e,t,r,i){let o=[];for(let s=0,l=0;s<n.length;s++){let a=n[s],u=l,c=l+=a.size;u>=t||c<=e?o.push(a):(u<e&&o.push(a.slice(0,e-u,r)),i&&(o.push(i),i=void 0),c>t&&o.push(a.slice(t-u,a.size,r)))}return o}function sf(n,e=null){let t=n.domSelectionRange(),r=n.state.doc;if(!t.focusNode)return null;let i=n.docView.nearestDesc(t.focusNode),o=i&&i.size==0,s=n.docView.posFromDOM(t.focusNode,t.focusOffset,1);if(s<0)return null;let l=r.resolve(s),a,u;if(Hl(t)){for(a=l;i&&!i.node;)i=i.parent;let c=i.node;if(i&&c.isAtom&&z.isSelectable(c)&&i.parent&&!(c.isInline&&Kk(t.focusNode,t.focusOffset,i.dom))){let f=i.posBefore;u=new z(s==f?l:r.resolve(f))}}else{let c=n.docView.posFromDOM(t.anchorNode,t.anchorOffset,1);if(c<0)return null;a=r.resolve(c)}if(!u){let c=e=="pointer"||n.state.selection.head<l.pos&&!o?1:-1;u=lf(n,a,l,c)}return u}function Og(n){return n.editable?n.hasFocus():Tg(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function Kt(n,e=!1){let t=n.state.selection;if(Dg(n,t),!!Og(n)){if(!e&&n.input.mouseDown&&n.input.mouseDown.allowDefault&&xe){let r=n.domSelectionRange(),i=n.domObserver.currentSelection;if(r.anchorNode&&i.anchorNode&&rr(r.anchorNode,r.anchorOffset,i.anchorNode,i.anchorOffset)){n.input.mouseDown.delayedSelectionSync=!0,n.domObserver.setCurSelection();return}}if(n.domObserver.disconnectSelection(),n.cursorWrapper)Mw(n);else{let{anchor:r,head:i}=t,o,s;Xd&&!(t instanceof $)&&(t.$from.parent.inlineContent||(o=Zd(n,t.from)),!t.empty&&!t.$from.parent.inlineContent&&(s=Zd(n,t.to))),n.docView.setSelection(r,i,n.root,e),Xd&&(o&&eh(o),s&&eh(s)),t.visible?n.dom.classList.remove("ProseMirror-hideselection"):(n.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&Nw(n))}n.domObserver.setCurSelection(),n.domObserver.connectSelection()}}const Xd=Re||xe&&Yk<63;function Zd(n,e){let{node:t,offset:r}=n.docView.domFromPos(e,0),i=r<t.childNodes.length?t.childNodes[r]:null,o=r?t.childNodes[r-1]:null;if(Re&&i&&i.contentEditable=="false")return Ia(i);if((!i||i.contentEditable=="false")&&(!o||o.contentEditable=="false")){if(i)return Ia(i);if(o)return Ia(o)}}function Ia(n){return n.contentEditable="true",Re&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function eh(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function Nw(n){let e=n.dom.ownerDocument;e.removeEventListener("selectionchange",n.input.hideSelectionGuard);let t=n.domSelectionRange(),r=t.anchorNode,i=t.anchorOffset;e.addEventListener("selectionchange",n.input.hideSelectionGuard=()=>{(t.anchorNode!=r||t.anchorOffset!=i)&&(e.removeEventListener("selectionchange",n.input.hideSelectionGuard),setTimeout(()=>{(!Og(n)||n.state.selection.visible)&&n.dom.classList.remove("ProseMirror-hideselection")},20))})}function Mw(n){let e=n.domSelection(),t=document.createRange(),r=n.cursorWrapper.dom,i=r.nodeName=="IMG";i?t.setEnd(r.parentNode,Oe(r)+1):t.setEnd(r,0),t.collapse(!1),e.removeAllRanges(),e.addRange(t),!i&&!n.state.selection.visible&&Je&&gn<=11&&(r.disabled=!0,r.disabled=!1)}function Dg(n,e){if(e instanceof z){let t=n.docView.descAt(e.from);t!=n.lastSelectedViewDesc&&(th(n),t&&t.selectNode(),n.lastSelectedViewDesc=t)}else th(n)}function th(n){n.lastSelectedViewDesc&&(n.lastSelectedViewDesc.parent&&n.lastSelectedViewDesc.deselectNode(),n.lastSelectedViewDesc=void 0)}function lf(n,e,t,r){return n.someProp("createSelectionBetween",i=>i(n,e,t))||$.between(e,t,r)}function nh(n){return n.editable&&!n.hasFocus()?!1:Tg(n)}function Tg(n){let e=n.domSelectionRange();if(!e.anchorNode)return!1;try{return n.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(n.editable||n.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function Ew(n){let e=n.docView.domFromPos(n.state.selection.anchor,0),t=n.domSelectionRange();return rr(e.node,e.offset,t.anchorNode,t.anchorOffset)}function Au(n,e){let{$anchor:t,$head:r}=n.selection,i=e>0?t.max(r):t.min(r),o=i.parent.inlineContent?i.depth?n.doc.resolve(e>0?i.after():i.before()):null:i;return o&&P.findFrom(o,e)}function nn(n,e){return n.dispatch(n.state.tr.setSelection(e).scrollIntoView()),!0}function rh(n,e,t){let r=n.state.selection;if(r instanceof $)if(t.indexOf("s")>-1){let{$head:i}=r,o=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter;if(!o||o.isText||!o.isLeaf)return!1;let s=n.state.doc.resolve(i.pos+o.nodeSize*(e<0?-1:1));return nn(n,new $(r.$anchor,s))}else if(r.empty){if(n.endOfTextblock(e>0?"forward":"backward")){let i=Au(n.state,e);return i&&i instanceof z?nn(n,i):!1}else if(!(rt&&t.indexOf("m")>-1)){let i=r.$head,o=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter,s;if(!o||o.isText)return!1;let l=e<0?i.pos-o.nodeSize:i.pos;return o.isAtom||(s=n.docView.descAt(l))&&!s.contentDOM?z.isSelectable(o)?nn(n,new z(e<0?n.state.doc.resolve(i.pos-o.nodeSize):i)):jo?nn(n,new $(n.state.doc.resolve(e<0?l:l+o.nodeSize))):!1:!1}}else return!1;else{if(r instanceof z&&r.node.isInline)return nn(n,new $(e>0?r.$to:r.$from));{let i=Au(n.state,e);return i?nn(n,i):!1}}}function hl(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function Xi(n,e){let t=n.pmViewDesc;return t&&t.size==0&&(e<0||n.nextSibling||n.nodeName!="BR")}function pr(n,e){return e<0?Ow(n):Dw(n)}function Ow(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let i,o,s=!1;for(wt&&t.nodeType==1&&r<hl(t)&&Xi(t.childNodes[r],-1)&&(s=!0);;)if(r>0){if(t.nodeType!=1)break;{let l=t.childNodes[r-1];if(Xi(l,-1))i=t,o=--r;else if(l.nodeType==3)t=l,r=t.nodeValue.length;else break}}else{if(Rg(t))break;{let l=t.previousSibling;for(;l&&Xi(l,-1);)i=t.parentNode,o=Oe(l),l=l.previousSibling;if(l)t=l,r=hl(t);else{if(t=t.parentNode,t==n.dom)break;r=0}}}s?Iu(n,t,r):i&&Iu(n,i,o)}function Dw(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let i=hl(t),o,s;for(;;)if(r<i){if(t.nodeType!=1)break;let l=t.childNodes[r];if(Xi(l,1))o=t,s=++r;else break}else{if(Rg(t))break;{let l=t.nextSibling;for(;l&&Xi(l,1);)o=l.parentNode,s=Oe(l)+1,l=l.nextSibling;if(l)t=l,r=0,i=hl(t);else{if(t=t.parentNode,t==n.dom)break;r=i=0}}}o&&Iu(n,o,s)}function Rg(n){let e=n.pmViewDesc;return e&&e.node&&e.node.isBlock}function Tw(n,e){for(;n&&e==n.childNodes.length&&!rf(n);)e=Oe(n)+1,n=n.parentNode;for(;n&&e<n.childNodes.length;){let t=n.childNodes[e];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=0}}function Rw(n,e){for(;n&&!e&&!rf(n);)e=Oe(n),n=n.parentNode;for(;n&&e;){let t=n.childNodes[e-1];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=n.childNodes.length}}function Iu(n,e,t){if(e.nodeType!=3){let o,s;(s=Tw(e,t))?(e=s,t=0):(o=Rw(e,t))&&(e=o,t=o.nodeValue.length)}let r=n.domSelection();if(Hl(r)){let o=document.createRange();o.setEnd(e,t),o.setStart(e,t),r.removeAllRanges(),r.addRange(o)}else r.extend&&r.extend(e,t);n.domObserver.setCurSelection();let{state:i}=n;setTimeout(()=>{n.state==i&&Kt(n)},50)}function ih(n,e){let t=n.state.doc.resolve(e);if(!(xe||Gk)&&t.parent.inlineContent){let i=n.coordsAtPos(e);if(e>t.start()){let o=n.coordsAtPos(e-1),s=(o.top+o.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(o.left-i.left)>1)return o.left<i.left?"ltr":"rtl"}if(e<t.end()){let o=n.coordsAtPos(e+1),s=(o.top+o.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(o.left-i.left)>1)return o.left>i.left?"ltr":"rtl"}}return getComputedStyle(n.dom).direction=="rtl"?"rtl":"ltr"}function oh(n,e,t){let r=n.state.selection;if(r instanceof $&&!r.empty||t.indexOf("s")>-1||rt&&t.indexOf("m")>-1)return!1;let{$from:i,$to:o}=r;if(!i.parent.inlineContent||n.endOfTextblock(e<0?"up":"down")){let s=Au(n.state,e);if(s&&s instanceof z)return nn(n,s)}if(!i.parent.inlineContent){let s=e<0?i:o,l=r instanceof Xe?P.near(s,e):P.findFrom(s,e);return l?nn(n,l):!1}return!1}function sh(n,e){if(!(n.state.selection instanceof $))return!0;let{$head:t,$anchor:r,empty:i}=n.state.selection;if(!t.sameParent(r))return!0;if(!i)return!1;if(n.endOfTextblock(e>0?"forward":"backward"))return!0;let o=!t.textOffset&&(e<0?t.nodeBefore:t.nodeAfter);if(o&&!o.isText){let s=n.state.tr;return e<0?s.delete(t.pos-o.nodeSize,t.pos):s.delete(t.pos,t.pos+o.nodeSize),n.dispatch(s),!0}return!1}function lh(n,e,t){n.domObserver.stop(),e.contentEditable=t,n.domObserver.start()}function Aw(n){if(!Re||n.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:t}=n.domSelectionRange();if(e&&e.nodeType==1&&t==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;lh(n,r,"true"),setTimeout(()=>lh(n,r,"false"),20)}return!1}function Iw(n){let e="";return n.ctrlKey&&(e+="c"),n.metaKey&&(e+="m"),n.altKey&&(e+="a"),n.shiftKey&&(e+="s"),e}function bw(n,e){let t=e.keyCode,r=Iw(e);if(t==8||rt&&t==72&&r=="c")return sh(n,-1)||pr(n,-1);if(t==46&&!e.shiftKey||rt&&t==68&&r=="c")return sh(n,1)||pr(n,1);if(t==13||t==27)return!0;if(t==37||rt&&t==66&&r=="c"){let i=t==37?ih(n,n.state.selection.from)=="ltr"?-1:1:-1;return rh(n,i,r)||pr(n,i)}else if(t==39||rt&&t==70&&r=="c"){let i=t==39?ih(n,n.state.selection.from)=="ltr"?1:-1:1;return rh(n,i,r)||pr(n,i)}else{if(t==38||rt&&t==80&&r=="c")return oh(n,-1,r)||pr(n,-1);if(t==40||rt&&t==78&&r=="c")return Aw(n)||oh(n,1,r)||pr(n,1);if(r==(rt?"m":"c")&&(t==66||t==73||t==89||t==90))return!0}return!1}function Ag(n,e){n.someProp("transformCopied",p=>{e=p(e,n)});let t=[],{content:r,openStart:i,openEnd:o}=e;for(;i>1&&o>1&&r.childCount==1&&r.firstChild.childCount==1;){i--,o--;let p=r.firstChild;t.push(p.type.name,p.attrs!=p.type.defaultAttrs?p.attrs:null),r=p.content}let s=n.someProp("clipboardSerializer")||Ut.fromSchema(n.state.schema),l=Lg(),a=l.createElement("div");a.appendChild(s.serializeFragment(r,{document:l}));let u=a.firstChild,c,f=0;for(;u&&u.nodeType==1&&(c=Fg[u.nodeName.toLowerCase()]);){for(let p=c.length-1;p>=0;p--){let h=l.createElement(c[p]);for(;a.firstChild;)h.appendChild(a.firstChild);a.appendChild(h),f++}u=a.firstChild}u&&u.nodeType==1&&u.setAttribute("data-pm-slice",`${i} ${o}${f?` -${f}`:""} ${JSON.stringify(t)}`);let d=n.someProp("clipboardTextSerializer",p=>p(e,n))||e.content.textBetween(0,e.content.size,`

`);return{dom:a,text:d}}function Ig(n,e,t,r,i){let o=i.parent.type.spec.code,s,l;if(!t&&!e)return null;let a=e&&(r||o||!t);if(a){if(n.someProp("transformPastedText",d=>{e=d(e,o||r,n)}),o)return e?new w(v.from(n.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0):w.empty;let f=n.someProp("clipboardTextParser",d=>d(e,i,r,n));if(f)l=f;else{let d=i.marks(),{schema:p}=n.state,h=Ut.fromSchema(p);s=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(m=>{let k=s.appendChild(document.createElement("p"));m&&k.appendChild(h.serializeNode(p.text(m,d)))})}}else n.someProp("transformPastedHTML",f=>{t=f(t,n)}),s=Fw(t),jo&&Lw(s);let u=s&&s.querySelector("[data-pm-slice]"),c=u&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(u.getAttribute("data-pm-slice")||"");if(c&&c[3])for(let f=+c[3];f>0;f--){let d=s.firstChild;for(;d&&d.nodeType!=1;)d=d.nextSibling;if(!d)break;s=d}if(l||(l=(n.someProp("clipboardParser")||n.someProp("domParser")||ho.fromSchema(n.state.schema)).parseSlice(s,{preserveWhitespace:!!(a||c),context:i,ruleFromNode(d){return d.nodeName=="BR"&&!d.nextSibling&&d.parentNode&&!zw.test(d.parentNode.nodeName)?{ignore:!0}:null}})),c)l=$w(ah(l,+c[1],+c[2]),c[4]);else if(l=w.maxOpen(Pw(l.content,i),!0),l.openStart||l.openEnd){let f=0,d=0;for(let p=l.content.firstChild;f<l.openStart&&!p.type.spec.isolating;f++,p=p.firstChild);for(let p=l.content.lastChild;d<l.openEnd&&!p.type.spec.isolating;d++,p=p.lastChild);l=ah(l,f,d)}return n.someProp("transformPasted",f=>{l=f(l,n)}),l}const zw=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function Pw(n,e){if(n.childCount<2)return n;for(let t=e.depth;t>=0;t--){let i=e.node(t).contentMatchAt(e.index(t)),o,s=[];if(n.forEach(l=>{if(!s)return;let a=i.findWrapping(l.type),u;if(!a)return s=null;if(u=s.length&&o.length&&zg(a,o,l,s[s.length-1],0))s[s.length-1]=u;else{s.length&&(s[s.length-1]=Pg(s[s.length-1],o.length));let c=bg(l,a);s.push(c),i=i.matchType(c.type),o=a}}),s)return v.from(s)}return n}function bg(n,e,t=0){for(let r=e.length-1;r>=t;r--)n=e[r].create(null,v.from(n));return n}function zg(n,e,t,r,i){if(i<n.length&&i<e.length&&n[i]==e[i]){let o=zg(n,e,t,r.lastChild,i+1);if(o)return r.copy(r.content.replaceChild(r.childCount-1,o));if(r.contentMatchAt(r.childCount).matchType(i==n.length-1?t.type:n[i+1]))return r.copy(r.content.append(v.from(bg(t,n,i+1))))}}function Pg(n,e){if(e==0)return n;let t=n.content.replaceChild(n.childCount-1,Pg(n.lastChild,e-1)),r=n.contentMatchAt(n.childCount).fillBefore(v.empty,!0);return n.copy(t.append(r))}function bu(n,e,t,r,i,o){let s=e<0?n.firstChild:n.lastChild,l=s.content;return n.childCount>1&&(o=0),i<r-1&&(l=bu(l,e,t,r,i+1,o)),i>=t&&(l=e<0?s.contentMatchAt(0).fillBefore(l,o<=i).append(l):l.append(s.contentMatchAt(s.childCount).fillBefore(v.empty,!0))),n.replaceChild(e<0?0:n.childCount-1,s.copy(l))}function ah(n,e,t){return e<n.openStart&&(n=new w(bu(n.content,-1,e,n.openStart,0,n.openEnd),e,n.openEnd)),t<n.openEnd&&(n=new w(bu(n.content,1,t,n.openEnd,0,0),n.openStart,t)),n}const Fg={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let uh=null;function Lg(){return uh||(uh=document.implementation.createHTMLDocument("title"))}function Fw(n){let e=/^(\s*<meta [^>]*>)*/.exec(n);e&&(n=n.slice(e[0].length));let t=Lg().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(n),i;if((i=r&&Fg[r[1].toLowerCase()])&&(n=i.map(o=>"<"+o+">").join("")+n+i.map(o=>"</"+o+">").reverse().join("")),t.innerHTML=n,i)for(let o=0;o<i.length;o++)t=t.querySelector(i[o])||t;return t}function Lw(n){let e=n.querySelectorAll(xe?"span:not([class]):not([style])":"span.Apple-converted-space");for(let t=0;t<e.length;t++){let r=e[t];r.childNodes.length==1&&r.textContent==" "&&r.parentNode&&r.parentNode.replaceChild(n.ownerDocument.createTextNode(" "),r)}}function $w(n,e){if(!n.size)return n;let t=n.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return n}let{content:i,openStart:o,openEnd:s}=n;for(let l=r.length-2;l>=0;l-=2){let a=t.nodes[r[l]];if(!a||a.hasRequiredAttrs())break;i=v.from(a.create(r[l+1],i)),o++,s++}return new w(i,o,s)}const Ae={},Ie={},Bw={touchstart:!0,touchmove:!0};class Vw{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastAndroidDelete=0,this.composing=!1,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function Jw(n){for(let e in Ae){let t=Ae[e];n.dom.addEventListener(e,n.input.eventHandlers[e]=r=>{Ww(n,r)&&!af(n,r)&&(n.editable||!(r.type in Ie))&&t(n,r)},Bw[e]?{passive:!0}:void 0)}Re&&n.dom.addEventListener("input",()=>null),zu(n)}function fn(n,e){n.input.lastSelectionOrigin=e,n.input.lastSelectionTime=Date.now()}function _w(n){n.domObserver.stop();for(let e in n.input.eventHandlers)n.dom.removeEventListener(e,n.input.eventHandlers[e]);clearTimeout(n.input.composingTimeout),clearTimeout(n.input.lastIOSEnterFallbackTimeout)}function zu(n){n.someProp("handleDOMEvents",e=>{for(let t in e)n.input.eventHandlers[t]||n.dom.addEventListener(t,n.input.eventHandlers[t]=r=>af(n,r))})}function af(n,e){return n.someProp("handleDOMEvents",t=>{let r=t[e.type];return r?r(n,e)||e.defaultPrevented:!1})}function Ww(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target;t!=n.dom;t=t.parentNode)if(!t||t.nodeType==11||t.pmViewDesc&&t.pmViewDesc.stopEvent(e))return!1;return!0}function Uw(n,e){!af(n,e)&&Ae[e.type]&&(n.editable||!(e.type in Ie))&&Ae[e.type](n,e)}Ie.keydown=(n,e)=>{let t=e;if(n.input.shiftKey=t.keyCode==16||t.shiftKey,!Bg(n,t)&&(n.input.lastKeyCode=t.keyCode,n.input.lastKeyCodeTime=Date.now(),!(gt&&xe&&t.keyCode==13)))if(t.keyCode!=229&&n.domObserver.forceFlush(),Qr&&t.keyCode==13&&!t.ctrlKey&&!t.altKey&&!t.metaKey){let r=Date.now();n.input.lastIOSEnter=r,n.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{n.input.lastIOSEnter==r&&(n.someProp("handleKeyDown",i=>i(n,Wn(13,"Enter"))),n.input.lastIOSEnter=0)},200)}else n.someProp("handleKeyDown",r=>r(n,t))||bw(n,t)?t.preventDefault():fn(n,"key")};Ie.keyup=(n,e)=>{e.keyCode==16&&(n.input.shiftKey=!1)};Ie.keypress=(n,e)=>{let t=e;if(Bg(n,t)||!t.charCode||t.ctrlKey&&!t.altKey||rt&&t.metaKey)return;if(n.someProp("handleKeyPress",i=>i(n,t))){t.preventDefault();return}let r=n.state.selection;if(!(r instanceof $)||!r.$from.sameParent(r.$to)){let i=String.fromCharCode(t.charCode);!/[\r\n]/.test(i)&&!n.someProp("handleTextInput",o=>o(n,r.$from.pos,r.$to.pos,i))&&n.dispatch(n.state.tr.insertText(i).scrollIntoView()),t.preventDefault()}};function jl(n){return{left:n.clientX,top:n.clientY}}function Hw(n,e){let t=e.x-n.clientX,r=e.y-n.clientY;return t*t+r*r<100}function uf(n,e,t,r,i){if(r==-1)return!1;let o=n.state.doc.resolve(r);for(let s=o.depth+1;s>0;s--)if(n.someProp(e,l=>s>o.depth?l(n,t,o.nodeAfter,o.before(s),i,!0):l(n,t,o.node(s),o.before(s),i,!1)))return!0;return!1}function Fr(n,e,t){n.focused||n.focus();let r=n.state.tr.setSelection(e);r.setMeta("pointer",!0),n.dispatch(r)}function jw(n,e){if(e==-1)return!1;let t=n.state.doc.resolve(e),r=t.nodeAfter;return r&&r.isAtom&&z.isSelectable(r)?(Fr(n,new z(t)),!0):!1}function Kw(n,e){if(e==-1)return!1;let t=n.state.selection,r,i;t instanceof z&&(r=t.node);let o=n.state.doc.resolve(e);for(let s=o.depth+1;s>0;s--){let l=s>o.depth?o.nodeAfter:o.node(s);if(z.isSelectable(l)){r&&t.$from.depth>0&&s>=t.$from.depth&&o.before(t.$from.depth+1)==t.$from.pos?i=o.before(t.$from.depth):i=o.before(s);break}}return i!=null?(Fr(n,z.create(n.state.doc,i)),!0):!1}function qw(n,e,t,r,i){return uf(n,"handleClickOn",e,t,r)||n.someProp("handleClick",o=>o(n,e,r))||(i?Kw(n,t):jw(n,t))}function Qw(n,e,t,r){return uf(n,"handleDoubleClickOn",e,t,r)||n.someProp("handleDoubleClick",i=>i(n,e,r))}function Yw(n,e,t,r){return uf(n,"handleTripleClickOn",e,t,r)||n.someProp("handleTripleClick",i=>i(n,e,r))||Gw(n,t,r)}function Gw(n,e,t){if(t.button!=0)return!1;let r=n.state.doc;if(e==-1)return r.inlineContent?(Fr(n,$.create(r,0,r.content.size)),!0):!1;let i=r.resolve(e);for(let o=i.depth+1;o>0;o--){let s=o>i.depth?i.nodeAfter:i.node(o),l=i.before(o);if(s.inlineContent)Fr(n,$.create(r,l+1,l+1+s.content.size));else if(z.isSelectable(s))Fr(n,z.create(r,l));else continue;return!0}}function cf(n){return pl(n)}const $g=rt?"metaKey":"ctrlKey";Ae.mousedown=(n,e)=>{let t=e;n.input.shiftKey=t.shiftKey;let r=cf(n),i=Date.now(),o="singleClick";i-n.input.lastClick.time<500&&Hw(t,n.input.lastClick)&&!t[$g]&&(n.input.lastClick.type=="singleClick"?o="doubleClick":n.input.lastClick.type=="doubleClick"&&(o="tripleClick")),n.input.lastClick={time:i,x:t.clientX,y:t.clientY,type:o};let s=n.posAtCoords(jl(t));s&&(o=="singleClick"?(n.input.mouseDown&&n.input.mouseDown.done(),n.input.mouseDown=new Xw(n,s,t,!!r)):(o=="doubleClick"?Qw:Yw)(n,s.pos,s.inside,t)?t.preventDefault():fn(n,"pointer"))};class Xw{constructor(e,t,r,i){this.view=e,this.pos=t,this.event=r,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[$g],this.allowDefault=r.shiftKey;let o,s;if(t.inside>-1)o=e.state.doc.nodeAt(t.inside),s=t.inside;else{let c=e.state.doc.resolve(t.pos);o=c.parent,s=c.depth?c.before():0}const l=i?null:r.target,a=l?e.docView.nearestDesc(l,!0):null;this.target=a?a.dom:null;let{selection:u}=e.state;(r.button==0&&o.type.spec.draggable&&o.type.spec.selectable!==!1||u instanceof z&&u.from<=s&&u.to>s)&&(this.mightDrag={node:o,pos:s,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&wt&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),fn(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Kt(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(jl(e))),this.updateAllowDefault(e),this.allowDefault||!t?fn(this.view,"pointer"):qw(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||Re&&this.mightDrag&&!this.mightDrag.node.isAtom||xe&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(Fr(this.view,P.near(this.view.state.doc.resolve(t.pos))),e.preventDefault()):fn(this.view,"pointer")}move(e){this.updateAllowDefault(e),fn(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}Ae.touchstart=n=>{n.input.lastTouch=Date.now(),cf(n),fn(n,"pointer")};Ae.touchmove=n=>{n.input.lastTouch=Date.now(),fn(n,"pointer")};Ae.contextmenu=n=>cf(n);function Bg(n,e){return n.composing?!0:Re&&Math.abs(e.timeStamp-n.input.compositionEndedAt)<500?(n.input.compositionEndedAt=-2e8,!0):!1}const Zw=gt?5e3:-1;Ie.compositionstart=Ie.compositionupdate=n=>{if(!n.composing){n.domObserver.flush();let{state:e}=n,t=e.selection.$from;if(e.selection.empty&&(e.storedMarks||!t.textOffset&&t.parentOffset&&t.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))n.markCursor=n.state.storedMarks||t.marks(),pl(n,!0),n.markCursor=null;else if(pl(n),wt&&e.selection.empty&&t.parentOffset&&!t.textOffset&&t.nodeBefore.marks.length){let r=n.domSelectionRange();for(let i=r.focusNode,o=r.focusOffset;i&&i.nodeType==1&&o!=0;){let s=o<0?i.lastChild:i.childNodes[o-1];if(!s)break;if(s.nodeType==3){n.domSelection().collapse(s,s.nodeValue.length);break}else i=s,o=-1}}n.input.composing=!0}Vg(n,Zw)};Ie.compositionend=(n,e)=>{n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=e.timeStamp,n.input.compositionPendingChanges=n.domObserver.pendingRecords().length?n.input.compositionID:0,n.input.compositionPendingChanges&&Promise.resolve().then(()=>n.domObserver.flush()),n.input.compositionID++,Vg(n,20))};function Vg(n,e){clearTimeout(n.input.composingTimeout),e>-1&&(n.input.composingTimeout=setTimeout(()=>pl(n),e))}function Jg(n){for(n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=ev());n.input.compositionNodes.length>0;)n.input.compositionNodes.pop().markParentsDirty()}function ev(){let n=document.createEvent("Event");return n.initEvent("event",!0,!0),n.timeStamp}function pl(n,e=!1){if(!(gt&&n.domObserver.flushingSoon>=0)){if(n.domObserver.forceFlush(),Jg(n),e||n.docView&&n.docView.dirty){let t=sf(n);return t&&!t.eq(n.state.selection)?n.dispatch(n.state.tr.setSelection(t)):n.updateState(n.state),!0}return!1}}function tv(n,e){if(!n.dom.parentNode)return;let t=n.dom.parentNode.appendChild(document.createElement("div"));t.appendChild(e),t.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),i=document.createRange();i.selectNodeContents(e),n.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t),n.focus()},50)}const yo=Je&&gn<15||Qr&&Xk<604;Ae.copy=Ie.cut=(n,e)=>{let t=e,r=n.state.selection,i=t.type=="cut";if(r.empty)return;let o=yo?null:t.clipboardData,s=r.content(),{dom:l,text:a}=Ag(n,s);o?(t.preventDefault(),o.clearData(),o.setData("text/html",l.innerHTML),o.setData("text/plain",a)):tv(n,l),i&&n.dispatch(n.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function nv(n){return n.openStart==0&&n.openEnd==0&&n.content.childCount==1?n.content.firstChild:null}function rv(n,e){if(!n.dom.parentNode)return;let t=n.input.shiftKey||n.state.selection.$from.parent.type.spec.code,r=n.dom.parentNode.appendChild(document.createElement(t?"textarea":"div"));t||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let i=n.input.shiftKey&&n.input.lastKeyCode!=45;setTimeout(()=>{n.focus(),r.parentNode&&r.parentNode.removeChild(r),t?So(n,r.value,null,i,e):So(n,r.textContent,r.innerHTML,i,e)},50)}function So(n,e,t,r,i){let o=Ig(n,e,t,r,n.state.selection.$from);if(n.someProp("handlePaste",a=>a(n,i,o||w.empty)))return!0;if(!o)return!1;let s=nv(o),l=s?n.state.tr.replaceSelectionWith(s,r):n.state.tr.replaceSelection(o);return n.dispatch(l.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function _g(n){let e=n.getData("text/plain")||n.getData("Text");if(e)return e;let t=n.getData("text/uri-list");return t?t.replace(/\r?\n/g," "):""}Ie.paste=(n,e)=>{let t=e;if(n.composing&&!gt)return;let r=yo?null:t.clipboardData,i=n.input.shiftKey&&n.input.lastKeyCode!=45;r&&So(n,_g(r),r.getData("text/html"),i,t)?t.preventDefault():rv(n,t)};class Wg{constructor(e,t,r){this.slice=e,this.move=t,this.node=r}}const Ug=rt?"altKey":"ctrlKey";Ae.dragstart=(n,e)=>{let t=e,r=n.input.mouseDown;if(r&&r.done(),!t.dataTransfer)return;let i=n.state.selection,o=i.empty?null:n.posAtCoords(jl(t)),s;if(!(o&&o.pos>=i.from&&o.pos<=(i instanceof z?i.to-1:i.to))){if(r&&r.mightDrag)s=z.create(n.state.doc,r.mightDrag.pos);else if(t.target&&t.target.nodeType==1){let c=n.docView.nearestDesc(t.target,!0);c&&c.node.type.spec.draggable&&c!=n.docView&&(s=z.create(n.state.doc,c.posBefore))}}let l=(s||n.state.selection).content(),{dom:a,text:u}=Ag(n,l);t.dataTransfer.clearData(),t.dataTransfer.setData(yo?"Text":"text/html",a.innerHTML),t.dataTransfer.effectAllowed="copyMove",yo||t.dataTransfer.setData("text/plain",u),n.dragging=new Wg(l,!t[Ug],s)};Ae.dragend=n=>{let e=n.dragging;window.setTimeout(()=>{n.dragging==e&&(n.dragging=null)},50)};Ie.dragover=Ie.dragenter=(n,e)=>e.preventDefault();Ie.drop=(n,e)=>{let t=e,r=n.dragging;if(n.dragging=null,!t.dataTransfer)return;let i=n.posAtCoords(jl(t));if(!i)return;let o=n.state.doc.resolve(i.pos),s=r&&r.slice;s?n.someProp("transformPasted",h=>{s=h(s,n)}):s=Ig(n,_g(t.dataTransfer),yo?null:t.dataTransfer.getData("text/html"),!1,o);let l=!!(r&&!t[Ug]);if(n.someProp("handleDrop",h=>h(n,t,s||w.empty,l))){t.preventDefault();return}if(!s)return;t.preventDefault();let a=s?Uk(n.state.doc,o.pos,s):o.pos;a==null&&(a=o.pos);let u=n.state.tr;if(l){let{node:h}=r;h?h.replace(u):u.deleteSelection()}let c=u.mapping.map(a),f=s.openStart==0&&s.openEnd==0&&s.content.childCount==1,d=u.doc;if(f?u.replaceRangeWith(c,c,s.content.firstChild):u.replaceRange(c,c,s),u.doc.eq(d))return;let p=u.doc.resolve(c);if(f&&z.isSelectable(s.content.firstChild)&&p.nodeAfter&&p.nodeAfter.sameMarkup(s.content.firstChild))u.setSelection(new z(p));else{let h=u.mapping.map(a);u.mapping.maps[u.mapping.maps.length-1].forEach((m,k,g,y)=>h=y),u.setSelection(lf(n,p,u.doc.resolve(h)))}n.focus(),n.dispatch(u.setMeta("uiEvent","drop"))};Ae.focus=n=>{n.input.lastFocus=Date.now(),n.focused||(n.domObserver.stop(),n.dom.classList.add("ProseMirror-focused"),n.domObserver.start(),n.focused=!0,setTimeout(()=>{n.docView&&n.hasFocus()&&!n.domObserver.currentSelection.eq(n.domSelectionRange())&&Kt(n)},20))};Ae.blur=(n,e)=>{let t=e;n.focused&&(n.domObserver.stop(),n.dom.classList.remove("ProseMirror-focused"),n.domObserver.start(),t.relatedTarget&&n.dom.contains(t.relatedTarget)&&n.domObserver.currentSelection.clear(),n.focused=!1)};Ae.beforeinput=(n,e)=>{if(xe&&gt&&e.inputType=="deleteContentBackward"){n.domObserver.flushSoon();let{domChangeCount:r}=n.input;setTimeout(()=>{if(n.input.domChangeCount!=r||(n.dom.blur(),n.focus(),n.someProp("handleKeyDown",o=>o(n,Wn(8,"Backspace")))))return;let{$cursor:i}=n.state.selection;i&&i.pos>0&&n.dispatch(n.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let n in Ie)Ae[n]=Ie[n];function ko(n,e){if(n==e)return!0;for(let t in n)if(n[t]!==e[t])return!1;for(let t in e)if(!(t in n))return!1;return!0}class ml{constructor(e,t){this.toDOM=e,this.spec=t||Xn,this.side=this.spec.side||0}map(e,t,r,i){let{pos:o,deleted:s}=e.mapResult(t.from+i,this.side<0?-1:1);return s?null:new me(o-r,o-r,this)}valid(){return!0}eq(e){return this==e||e instanceof ml&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&ko(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class yn{constructor(e,t){this.attrs=e,this.spec=t||Xn}map(e,t,r,i){let o=e.map(t.from+i,this.spec.inclusiveStart?-1:1)-r,s=e.map(t.to+i,this.spec.inclusiveEnd?1:-1)-r;return o>=s?null:new me(o,s,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof yn&&ko(this.attrs,e.attrs)&&ko(this.spec,e.spec)}static is(e){return e.type instanceof yn}destroy(){}}class ff{constructor(e,t){this.attrs=e,this.spec=t||Xn}map(e,t,r,i){let o=e.mapResult(t.from+i,1);if(o.deleted)return null;let s=e.mapResult(t.to+i,-1);return s.deleted||s.pos<=o.pos?null:new me(o.pos-r,s.pos-r,this)}valid(e,t){let{index:r,offset:i}=e.content.findIndex(t.from),o;return i==t.from&&!(o=e.child(r)).isText&&i+o.nodeSize==t.to}eq(e){return this==e||e instanceof ff&&ko(this.attrs,e.attrs)&&ko(this.spec,e.spec)}destroy(){}}class me{constructor(e,t,r){this.from=e,this.to=t,this.type=r}copy(e,t){return new me(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,r){return this.type.map(e,this,t,r)}static widget(e,t,r){return new me(e,e,new ml(t,r))}static inline(e,t,r,i){return new me(e,t,new yn(r,i))}static node(e,t,r,i){return new me(e,t,new ff(r,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof yn}get widget(){return this.type instanceof ml}}const wr=[],Xn={};class W{constructor(e,t){this.local=e.length?e:wr,this.children=t.length?t:wr}static create(e,t){return t.length?gl(t,e,0,Xn):we}find(e,t,r){let i=[];return this.findInner(e??0,t??1e9,i,0,r),i}findInner(e,t,r,i,o){for(let s=0;s<this.local.length;s++){let l=this.local[s];l.from<=t&&l.to>=e&&(!o||o(l.spec))&&r.push(l.copy(l.from+i,l.to+i))}for(let s=0;s<this.children.length;s+=3)if(this.children[s]<t&&this.children[s+1]>e){let l=this.children[s]+1;this.children[s+2].findInner(e-l,t-l,r,i+l,o)}}map(e,t,r){return this==we||e.maps.length==0?this:this.mapInner(e,t,0,0,r||Xn)}mapInner(e,t,r,i,o){let s;for(let l=0;l<this.local.length;l++){let a=this.local[l].map(e,r,i);a&&a.type.valid(t,a)?(s||(s=[])).push(a):o.onRemove&&o.onRemove(this.local[l].spec)}return this.children.length?iv(this.children,s||[],e,t,r,i,o):s?new W(s.sort(Zn),wr):we}add(e,t){return t.length?this==we?W.create(e,t):this.addInner(e,t,0):this}addInner(e,t,r){let i,o=0;e.forEach((l,a)=>{let u=a+r,c;if(c=Kg(t,l,u)){for(i||(i=this.children.slice());o<i.length&&i[o]<a;)o+=3;i[o]==a?i[o+2]=i[o+2].addInner(l,c,u+1):i.splice(o,0,a,a+l.nodeSize,gl(c,l,u+1,Xn)),o+=3}});let s=jg(o?qg(t):t,-r);for(let l=0;l<s.length;l++)s[l].type.valid(e,s[l])||s.splice(l--,1);return new W(s.length?this.local.concat(s).sort(Zn):this.local,i||this.children)}remove(e){return e.length==0||this==we?this:this.removeInner(e,0)}removeInner(e,t){let r=this.children,i=this.local;for(let o=0;o<r.length;o+=3){let s,l=r[o]+t,a=r[o+1]+t;for(let c=0,f;c<e.length;c++)(f=e[c])&&f.from>l&&f.to<a&&(e[c]=null,(s||(s=[])).push(f));if(!s)continue;r==this.children&&(r=this.children.slice());let u=r[o+2].removeInner(s,l+1);u!=we?r[o+2]=u:(r.splice(o,3),o-=3)}if(i.length){for(let o=0,s;o<e.length;o++)if(s=e[o])for(let l=0;l<i.length;l++)i[l].eq(s,t)&&(i==this.local&&(i=this.local.slice()),i.splice(l--,1))}return r==this.children&&i==this.local?this:i.length||r.length?new W(i,r):we}forChild(e,t){if(this==we)return this;if(t.isLeaf)return W.empty;let r,i;for(let l=0;l<this.children.length;l+=3)if(this.children[l]>=e){this.children[l]==e&&(r=this.children[l+2]);break}let o=e+1,s=o+t.content.size;for(let l=0;l<this.local.length;l++){let a=this.local[l];if(a.from<s&&a.to>o&&a.type instanceof yn){let u=Math.max(o,a.from)-o,c=Math.min(s,a.to)-o;u<c&&(i||(i=[])).push(a.copy(u,c))}}if(i){let l=new W(i.sort(Zn),wr);return r?new Hg([l,r]):l}return r||we}eq(e){if(this==e)return!0;if(!(e instanceof W)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return df(this.localsInner(e))}localsInner(e){if(this==we)return wr;if(e.inlineContent||!this.local.some(yn.is))return this.local;let t=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof yn||t.push(this.local[r]);return t}}W.empty=new W([],[]);W.removeOverlap=df;const we=W.empty;let Hg=class vr{constructor(e){this.members=e}map(e,t){const r=this.members.map(i=>i.map(e,t,Xn));return vr.from(r)}forChild(e,t){if(t.isLeaf)return W.empty;let r=[];for(let i=0;i<this.members.length;i++){let o=this.members[i].forChild(e,t);o!=we&&(o instanceof vr?r=r.concat(o.members):r.push(o))}return vr.from(r)}eq(e){if(!(e instanceof vr)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,r=!0;for(let i=0;i<this.members.length;i++){let o=this.members[i].localsInner(e);if(o.length)if(!t)t=o;else{r&&(t=t.slice(),r=!1);for(let s=0;s<o.length;s++)t.push(o[s])}}return t?df(r?t:t.sort(Zn)):wr}static from(e){switch(e.length){case 0:return we;case 1:return e[0];default:return new vr(e.every(t=>t instanceof W)?e:e.reduce((t,r)=>t.concat(r instanceof W?r:r.members),[]))}}};function iv(n,e,t,r,i,o,s){let l=n.slice();for(let u=0,c=o;u<t.maps.length;u++){let f=0;t.maps[u].forEach((d,p,h,m)=>{let k=m-h-(p-d);for(let g=0;g<l.length;g+=3){let y=l[g+1];if(y<0||d>y+c-f)continue;let S=l[g]+c-f;p>=S?l[g+1]=d<=S?-2:-1:d>=c&&k&&(l[g]+=k,l[g+1]+=k)}f+=k}),c=t.maps[u].map(c,-1)}let a=!1;for(let u=0;u<l.length;u+=3)if(l[u+1]<0){if(l[u+1]==-2){a=!0,l[u+1]=-1;continue}let c=t.map(n[u]+o),f=c-i;if(f<0||f>=r.content.size){a=!0;continue}let d=t.map(n[u+1]+o,-1),p=d-i,{index:h,offset:m}=r.content.findIndex(f),k=r.maybeChild(h);if(k&&m==f&&m+k.nodeSize==p){let g=l[u+2].mapInner(t,k,c+1,n[u]+o+1,s);g!=we?(l[u]=f,l[u+1]=p,l[u+2]=g):(l[u+1]=-2,a=!0)}else a=!0}if(a){let u=ov(l,n,e,t,i,o,s),c=gl(u,r,0,s);e=c.local;for(let f=0;f<l.length;f+=3)l[f+1]<0&&(l.splice(f,3),f-=3);for(let f=0,d=0;f<c.children.length;f+=3){let p=c.children[f];for(;d<l.length&&l[d]<p;)d+=3;l.splice(d,0,c.children[f],c.children[f+1],c.children[f+2])}}return new W(e.sort(Zn),l)}function jg(n,e){if(!e||!n.length)return n;let t=[];for(let r=0;r<n.length;r++){let i=n[r];t.push(new me(i.from+e,i.to+e,i.type))}return t}function ov(n,e,t,r,i,o,s){function l(a,u){for(let c=0;c<a.local.length;c++){let f=a.local[c].map(r,i,u);f?t.push(f):s.onRemove&&s.onRemove(a.local[c].spec)}for(let c=0;c<a.children.length;c+=3)l(a.children[c+2],a.children[c]+u+1)}for(let a=0;a<n.length;a+=3)n[a+1]==-1&&l(n[a+2],e[a]+o+1);return t}function Kg(n,e,t){if(e.isLeaf)return null;let r=t+e.nodeSize,i=null;for(let o=0,s;o<n.length;o++)(s=n[o])&&s.from>t&&s.to<r&&((i||(i=[])).push(s),n[o]=null);return i}function qg(n){let e=[];for(let t=0;t<n.length;t++)n[t]!=null&&e.push(n[t]);return e}function gl(n,e,t,r){let i=[],o=!1;e.forEach((l,a)=>{let u=Kg(n,l,a+t);if(u){o=!0;let c=gl(u,l,t+a+1,r);c!=we&&i.push(a,a+l.nodeSize,c)}});let s=jg(o?qg(n):n,-t).sort(Zn);for(let l=0;l<s.length;l++)s[l].type.valid(e,s[l])||(r.onRemove&&r.onRemove(s[l].spec),s.splice(l--,1));return s.length||i.length?new W(s,i):we}function Zn(n,e){return n.from-e.from||n.to-e.to}function df(n){let e=n;for(let t=0;t<e.length-1;t++){let r=e[t];if(r.from!=r.to)for(let i=t+1;i<e.length;i++){let o=e[i];if(o.from==r.from){o.to!=r.to&&(e==n&&(e=n.slice()),e[i]=o.copy(o.from,r.to),ch(e,i+1,o.copy(r.to,o.to)));continue}else{o.from<r.to&&(e==n&&(e=n.slice()),e[t]=r.copy(r.from,o.from),ch(e,i,r.copy(o.from,r.to)));break}}}return e}function ch(n,e,t){for(;e<n.length&&Zn(t,n[e])>0;)e++;n.splice(e,0,t)}function ba(n){let e=[];return n.someProp("decorations",t=>{let r=t(n.state);r&&r!=we&&e.push(r)}),n.cursorWrapper&&e.push(W.create(n.state.doc,[n.cursorWrapper.deco])),Hg.from(e)}const sv={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},lv=Je&&gn<=11;let av=class{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}};class uv{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new av,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let i=0;i<r.length;i++)this.queue.push(r[i]);Je&&gn<=11&&r.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),lv&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,sv)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(nh(this.view)){if(this.suppressingSelectionUpdates)return Kt(this.view);if(Je&&gn<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&rr(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t=new Set,r;for(let o=e.focusNode;o;o=go(o))t.add(o);for(let o=e.anchorNode;o;o=go(o))if(t.has(o)){r=o;break}let i=r&&this.view.docView.nearestDesc(r);if(i&&i.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let t=this.pendingRecords();t.length&&(this.queue=[]);let r=e.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&nh(e)&&!this.ignoreSelectionChange(r),o=-1,s=-1,l=!1,a=[];if(e.editable)for(let c=0;c<t.length;c++){let f=this.registerMutation(t[c],a);f&&(o=o<0?f.from:Math.min(f.from,o),s=s<0?f.to:Math.max(f.to,s),f.typeOver&&(l=!0))}if(wt&&a.length>1){let c=a.filter(f=>f.nodeName=="BR");if(c.length==2){let f=c[0],d=c[1];f.parentNode&&f.parentNode.parentNode==d.parentNode?d.remove():f.remove()}}let u=null;o<0&&i&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&Hl(r)&&(u=sf(e))&&u.eq(P.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,Kt(e),this.currentSelection.set(r),e.scrollToSelection()):(o>-1||i)&&(o>-1&&(e.docView.markDirty(o,s),cv(e)),this.handleDOMChange(o,s,l,a),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||Kt(e),this.currentSelection.set(r))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let c=0;c<e.addedNodes.length;c++)t.push(e.addedNodes[c]);if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let i=e.previousSibling,o=e.nextSibling;if(Je&&gn<=11&&e.addedNodes.length)for(let c=0;c<e.addedNodes.length;c++){let{previousSibling:f,nextSibling:d}=e.addedNodes[c];(!f||Array.prototype.indexOf.call(e.addedNodes,f)<0)&&(i=f),(!d||Array.prototype.indexOf.call(e.addedNodes,d)<0)&&(o=d)}let s=i&&i.parentNode==e.target?Oe(i)+1:0,l=r.localPosFromDOM(e.target,s,-1),a=o&&o.parentNode==e.target?Oe(o):e.target.childNodes.length,u=r.localPosFromDOM(e.target,a,1);return{from:l,to:u}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}}}let fh=new WeakMap,dh=!1;function cv(n){if(!fh.has(n)&&(fh.set(n,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(n.dom).whiteSpace)!==-1)){if(n.requiresGeckoHackNode=wt,dh)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),dh=!0}}function fv(n){let e;function t(a){a.preventDefault(),a.stopImmediatePropagation(),e=a.getTargetRanges()[0]}n.dom.addEventListener("beforeinput",t,!0),document.execCommand("indent"),n.dom.removeEventListener("beforeinput",t,!0);let r=e.startContainer,i=e.startOffset,o=e.endContainer,s=e.endOffset,l=n.domAtPos(n.state.selection.anchor);return rr(l.node,l.offset,o,s)&&([r,i,o,s]=[o,s,r,i]),{anchorNode:r,anchorOffset:i,focusNode:o,focusOffset:s}}function dv(n,e,t){let{node:r,fromOffset:i,toOffset:o,from:s,to:l}=n.docView.parseRange(e,t),a=n.domSelectionRange(),u,c=a.anchorNode;if(c&&n.dom.contains(c.nodeType==1?c:c.parentNode)&&(u=[{node:c,offset:a.anchorOffset}],Hl(a)||u.push({node:a.focusNode,offset:a.focusOffset})),xe&&n.input.lastKeyCode===8)for(let k=o;k>i;k--){let g=r.childNodes[k-1],y=g.pmViewDesc;if(g.nodeName=="BR"&&!y){o=k;break}if(!y||y.size)break}let f=n.state.doc,d=n.someProp("domParser")||ho.fromSchema(n.state.schema),p=f.resolve(s),h=null,m=d.parse(r,{topNode:p.parent,topMatch:p.parent.contentMatchAt(p.index()),topOpen:!0,from:i,to:o,preserveWhitespace:p.parent.type.whitespace=="pre"?"full":!0,findPositions:u,ruleFromNode:hv,context:p});if(u&&u[0].pos!=null){let k=u[0].pos,g=u[1]&&u[1].pos;g==null&&(g=k),h={anchor:k+s,head:g+s}}return{doc:m,sel:h,from:s,to:l}}function hv(n){let e=n.pmViewDesc;if(e)return e.parseRule();if(n.nodeName=="BR"&&n.parentNode){if(Re&&/^(ul|ol)$/i.test(n.parentNode.nodeName)){let t=document.createElement("div");return t.appendChild(document.createElement("li")),{skip:t}}else if(n.parentNode.lastChild==n||Re&&/^(tr|table)$/i.test(n.parentNode.nodeName))return{ignore:!0}}else if(n.nodeName=="IMG"&&n.getAttribute("mark-placeholder"))return{ignore:!0};return null}const pv=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function mv(n,e,t,r,i){let o=n.input.compositionPendingChanges||(n.composing?n.input.compositionID:0);if(n.input.compositionPendingChanges=0,e<0){let E=n.input.lastSelectionTime>Date.now()-50?n.input.lastSelectionOrigin:null,b=sf(n,E);if(b&&!n.state.selection.eq(b)){if(xe&&gt&&n.input.lastKeyCode===13&&Date.now()-100<n.input.lastKeyCodeTime&&n.someProp("handleKeyDown",Lt=>Lt(n,Wn(13,"Enter"))))return;let ne=n.state.tr.setSelection(b);E=="pointer"?ne.setMeta("pointer",!0):E=="key"&&ne.scrollIntoView(),o&&ne.setMeta("composition",o),n.dispatch(ne)}return}let s=n.state.doc.resolve(e),l=s.sharedDepth(t);e=s.before(l+1),t=n.state.doc.resolve(t).after(l+1);let a=n.state.selection,u=dv(n,e,t),c=n.state.doc,f=c.slice(u.from,u.to),d,p;n.input.lastKeyCode===8&&Date.now()-100<n.input.lastKeyCodeTime?(d=n.state.selection.to,p="end"):(d=n.state.selection.from,p="start"),n.input.lastKeyCode=null;let h=Sv(f.content,u.doc.content,u.from,d,p);if((Qr&&n.input.lastIOSEnter>Date.now()-225||gt)&&i.some(E=>E.nodeType==1&&!pv.test(E.nodeName))&&(!h||h.endA>=h.endB)&&n.someProp("handleKeyDown",E=>E(n,Wn(13,"Enter")))){n.input.lastIOSEnter=0;return}if(!h)if(r&&a instanceof $&&!a.empty&&a.$head.sameParent(a.$anchor)&&!n.composing&&!(u.sel&&u.sel.anchor!=u.sel.head))h={start:a.from,endA:a.to,endB:a.to};else{if(u.sel){let E=hh(n,n.state.doc,u.sel);if(E&&!E.eq(n.state.selection)){let b=n.state.tr.setSelection(E);o&&b.setMeta("composition",o),n.dispatch(b)}}return}if(xe&&n.cursorWrapper&&u.sel&&u.sel.anchor==n.cursorWrapper.deco.from&&u.sel.head==u.sel.anchor){let E=h.endB-h.start;u.sel={anchor:u.sel.anchor+E,head:u.sel.anchor+E}}n.input.domChangeCount++,n.state.selection.from<n.state.selection.to&&h.start==h.endB&&n.state.selection instanceof $&&(h.start>n.state.selection.from&&h.start<=n.state.selection.from+2&&n.state.selection.from>=u.from?h.start=n.state.selection.from:h.endA<n.state.selection.to&&h.endA>=n.state.selection.to-2&&n.state.selection.to<=u.to&&(h.endB+=n.state.selection.to-h.endA,h.endA=n.state.selection.to)),Je&&gn<=11&&h.endB==h.start+1&&h.endA==h.start&&h.start>u.from&&u.doc.textBetween(h.start-u.from-1,h.start-u.from+1)=="  "&&(h.start--,h.endA--,h.endB--);let m=u.doc.resolveNoCache(h.start-u.from),k=u.doc.resolveNoCache(h.endB-u.from),g=c.resolve(h.start),y=m.sameParent(k)&&m.parent.inlineContent&&g.end()>=h.endA,S;if((Qr&&n.input.lastIOSEnter>Date.now()-225&&(!y||i.some(E=>E.nodeName=="DIV"||E.nodeName=="P"))||!y&&m.pos<u.doc.content.size&&!m.sameParent(k)&&(S=P.findFrom(u.doc.resolve(m.pos+1),1,!0))&&S.head==k.pos)&&n.someProp("handleKeyDown",E=>E(n,Wn(13,"Enter")))){n.input.lastIOSEnter=0;return}if(n.state.selection.anchor>h.start&&yv(c,h.start,h.endA,m,k)&&n.someProp("handleKeyDown",E=>E(n,Wn(8,"Backspace")))){gt&&xe&&n.domObserver.suppressSelectionUpdates();return}xe&&gt&&h.endB==h.start&&(n.input.lastAndroidDelete=Date.now()),gt&&!y&&m.start()!=k.start()&&k.parentOffset==0&&m.depth==k.depth&&u.sel&&u.sel.anchor==u.sel.head&&u.sel.head==h.endA&&(h.endB-=2,k=u.doc.resolveNoCache(h.endB-u.from),setTimeout(()=>{n.someProp("handleKeyDown",function(E){return E(n,Wn(13,"Enter"))})},20));let x=h.start,M=h.endA,O,D,R;if(y){if(m.pos==k.pos)Je&&gn<=11&&m.parentOffset==0&&(n.domObserver.suppressSelectionUpdates(),setTimeout(()=>Kt(n),20)),O=n.state.tr.delete(x,M),D=c.resolve(h.start).marksAcross(c.resolve(h.endA));else if(h.endA==h.endB&&(R=gv(m.parent.content.cut(m.parentOffset,k.parentOffset),g.parent.content.cut(g.parentOffset,h.endA-g.start()))))O=n.state.tr,R.type=="add"?O.addMark(x,M,R.mark):O.removeMark(x,M,R.mark);else if(m.parent.child(m.index()).isText&&m.index()==k.index()-(k.textOffset?0:1)){let E=m.parent.textBetween(m.parentOffset,k.parentOffset);if(n.someProp("handleTextInput",b=>b(n,x,M,E)))return;O=n.state.tr.insertText(E,x,M)}}if(O||(O=n.state.tr.replace(x,M,u.doc.slice(h.start-u.from,h.endB-u.from))),u.sel){let E=hh(n,O.doc,u.sel);E&&!(xe&&gt&&n.composing&&E.empty&&(h.start!=h.endB||n.input.lastAndroidDelete<Date.now()-100)&&(E.head==x||E.head==O.mapping.map(M)-1)||Je&&E.empty&&E.head==x)&&O.setSelection(E)}D&&O.ensureMarks(D),o&&O.setMeta("composition",o),n.dispatch(O.scrollIntoView())}function hh(n,e,t){return Math.max(t.anchor,t.head)>e.content.size?null:lf(n,e.resolve(t.anchor),e.resolve(t.head))}function gv(n,e){let t=n.firstChild.marks,r=e.firstChild.marks,i=t,o=r,s,l,a;for(let c=0;c<r.length;c++)i=r[c].removeFromSet(i);for(let c=0;c<t.length;c++)o=t[c].removeFromSet(o);if(i.length==1&&o.length==0)l=i[0],s="add",a=c=>c.mark(l.addToSet(c.marks));else if(i.length==0&&o.length==1)l=o[0],s="remove",a=c=>c.mark(l.removeFromSet(c.marks));else return null;let u=[];for(let c=0;c<e.childCount;c++)u.push(a(e.child(c)));if(v.from(u).eq(n))return{mark:l,type:s}}function yv(n,e,t,r,i){if(!r.parent.isTextblock||t-e<=i.pos-r.pos||za(r,!0,!1)<i.pos)return!1;let o=n.resolve(e);if(o.parentOffset<o.parent.content.size||!o.parent.isTextblock)return!1;let s=n.resolve(za(o,!0,!0));return!s.parent.isTextblock||s.pos>t||za(s,!0,!1)<t?!1:r.parent.content.cut(r.parentOffset).eq(s.parent.content)}function za(n,e,t){let r=n.depth,i=e?n.end():n.pos;for(;r>0&&(e||n.indexAfter(r)==n.node(r).childCount);)r--,i++,e=!1;if(t){let o=n.node(r).maybeChild(n.indexAfter(r));for(;o&&!o.isLeaf;)o=o.firstChild,i++}return i}function Sv(n,e,t,r,i){let o=n.findDiffStart(e,t);if(o==null)return null;let{a:s,b:l}=n.findDiffEnd(e,t+n.size,t+e.size);if(i=="end"){let a=Math.max(0,o-Math.min(s,l));r-=s+a-o}if(s<o&&n.size<e.size){let a=r<=o&&r>=s?o-r:0;o-=a,o&&o<e.size&&ph(e.textBetween(o-1,o+1))&&(o+=a?1:-1),l=o+(l-s),s=o}else if(l<o){let a=r<=o&&r>=l?o-r:0;o-=a,o&&o<n.size&&ph(n.textBetween(o-1,o+1))&&(o+=a?1:-1),s=o+(s-l),l=o}return{start:o,endA:s,endB:l}}function ph(n){if(n.length!=2)return!1;let e=n.charCodeAt(0),t=n.charCodeAt(1);return e>=56320&&e<=57343&&t>=55296&&t<=56319}class kv{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new Vw,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(kh),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=yh(this),gh(this),this.nodeViews=Sh(this),this.docView=Yd(this.state.doc,mh(this),ba(this),this.dom,this),this.domObserver=new uv(this,(r,i,o,s)=>mv(this,r,i,o,s)),this.domObserver.start(),Jw(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let t in e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&zu(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(kh),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let r in this._props)t[r]=this._props[r];t.state=this.state;for(let r in e)t[r]=e[r];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){var r;let i=this.state,o=!1,s=!1;e.storedMarks&&this.composing&&(Jg(this),s=!0),this.state=e;let l=i.plugins!=e.plugins||this._props.plugins!=t.plugins;if(l||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let p=Sh(this);vv(p,this.nodeViews)&&(this.nodeViews=p,o=!0)}(l||t.handleDOMEvents!=this._props.handleDOMEvents)&&zu(this),this.editable=yh(this),gh(this);let a=ba(this),u=mh(this),c=i.plugins!=e.plugins&&!i.doc.eq(e.doc)?"reset":e.scrollToSelection>i.scrollToSelection?"to selection":"preserve",f=o||!this.docView.matchesNode(e.doc,u,a);(f||!e.selection.eq(i.selection))&&(s=!0);let d=c=="preserve"&&s&&this.dom.style.overflowAnchor==null&&tw(this);if(s){this.domObserver.stop();let p=f&&(Je||xe)&&!this.composing&&!i.selection.empty&&!e.selection.empty&&wv(i.selection,e.selection);if(f){let h=xe?this.trackWrites=this.domSelectionRange().focusNode:null;(o||!this.docView.update(e.doc,u,a,this))&&(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=Yd(e.doc,u,a,this.dom,this)),h&&!this.trackWrites&&(p=!0)}p||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&Ew(this))?Kt(this,p):(Dg(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(i),!((r=this.dragging)===null||r===void 0)&&r.node&&!i.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,i),c=="reset"?this.dom.scrollTop=0:c=="to selection"?this.scrollToSelection():d&&nw(d)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!this.someProp("handleScrollToSelection",t=>t(this)))if(this.state.selection instanceof z){let t=this.docView.domAfterPos(this.state.selection.from);t.nodeType==1&&Ud(this,t.getBoundingClientRect(),e)}else Ud(this,this.coordsAtPos(this.state.selection.head,1),e)}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let t=0;t<this.directPlugins.length;t++){let r=this.directPlugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let t=0;t<this.state.plugins.length;t++){let r=this.state.plugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let t=0;t<this.pluginViews.length;t++){let r=this.pluginViews[t];r.update&&r.update(this,e)}}updateDraggedNode(e,t){let r=e.node,i=-1;if(this.state.doc.nodeAt(r.from)==r.node)i=r.from;else{let o=r.from+(this.state.doc.content.size-t.doc.content.size);(o>0&&this.state.doc.nodeAt(o))==r.node&&(i=o)}this.dragging=new Wg(e.slice,e.move,i<0?void 0:z.create(this.state.doc,i))}someProp(e,t){let r=this._props&&this._props[e],i;if(r!=null&&(i=t?t(r):r))return i;for(let s=0;s<this.directPlugins.length;s++){let l=this.directPlugins[s].props[e];if(l!=null&&(i=t?t(l):l))return i}let o=this.state.plugins;if(o)for(let s=0;s<o.length;s++){let l=o[s].props[e];if(l!=null&&(i=t?t(l):l))return i}}hasFocus(){if(Je){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&rw(this.dom),Kt(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let t=this.dom.parentNode;t;t=t.parentNode)if(t.nodeType==9||t.nodeType==11&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=()=>t.ownerDocument.getSelection()),this._root=t}return e||document}updateRoot(){this._root=null}posAtCoords(e){return aw(this,e)}coordsAtPos(e,t=1){return yg(this,e,t)}domAtPos(e,t=0){return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t,r=-1){let i=this.docView.posFromDOM(e,t,r);if(i==null)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(e,t){return hw(this,t||this.state,e)}pasteHTML(e,t){return So(this,"",e,!1,t||new ClipboardEvent("paste"))}pasteText(e,t){return So(this,e,null,!0,t||new ClipboardEvent("paste"))}destroy(){this.docView&&(_w(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],ba(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)}get isDestroyed(){return this.docView==null}dispatchEvent(e){return Uw(this,e)}dispatch(e){let t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))}domSelectionRange(){return Re&&this.root.nodeType===11&&qk(this.dom.ownerDocument)==this.dom?fv(this):this.domSelection()}domSelection(){return this.root.getSelection()}}function mh(n){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(n.editable),n.someProp("attributes",t=>{if(typeof t=="function"&&(t=t(n.state)),t)for(let r in t)r=="class"?e.class+=" "+t[r]:r=="style"?e.style=(e.style?e.style+";":"")+t[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(t[r]))}),e.translate||(e.translate="no"),[me.node(0,n.state.doc.content.size,e)]}function gh(n){if(n.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),n.cursorWrapper={dom:e,deco:me.widget(n.state.selection.head,e,{raw:!0,marks:n.markCursor})}}else n.cursorWrapper=null}function yh(n){return!n.someProp("editable",e=>e(n.state)===!1)}function wv(n,e){let t=Math.min(n.$anchor.sharedDepth(n.head),e.$anchor.sharedDepth(e.head));return n.$anchor.start(t)!=e.$anchor.start(t)}function Sh(n){let e=Object.create(null);function t(r){for(let i in r)Object.prototype.hasOwnProperty.call(e,i)||(e[i]=r[i])}return n.someProp("nodeViews",t),n.someProp("markViews",t),e}function vv(n,e){let t=0,r=0;for(let i in n){if(n[i]!=e[i])return!0;t++}for(let i in e)r++;return t!=r}function kh(n){if(n.spec.state||n.spec.filterTransaction||n.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}class Z extends P{constructor(e){super(e,e)}map(e,t){let r=e.resolve(t.map(this.head));return Z.valid(r)?new Z(r):P.near(r)}content(){return w.empty}eq(e){return e instanceof Z&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new Z(e.resolve(t.pos))}getBookmark(){return new hf(this.anchor)}static valid(e){let t=e.parent;if(t.isTextblock||!xv(e)||!Cv(e))return!1;let r=t.type.spec.allowGapCursor;if(r!=null)return r;let i=t.contentMatchAt(e.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(e,t,r=!1){e:for(;;){if(!r&&Z.valid(e))return e;let i=e.pos,o=null;for(let s=e.depth;;s--){let l=e.node(s);if(t>0?e.indexAfter(s)<l.childCount:e.index(s)>0){o=l.child(t>0?e.indexAfter(s):e.index(s)-1);break}else if(s==0)return null;i+=t;let a=e.doc.resolve(i);if(Z.valid(a))return a}for(;;){let s=t>0?o.firstChild:o.lastChild;if(!s){if(o.isAtom&&!o.isText&&!z.isSelectable(o)){e=e.doc.resolve(i+o.nodeSize*t),r=!1;continue e}break}o=s,i+=t;let l=e.doc.resolve(i);if(Z.valid(l))return l}return null}}}Z.prototype.visible=!1;Z.findFrom=Z.findGapCursorFrom;P.jsonID("gapcursor",Z);class hf{constructor(e){this.pos=e}map(e){return new hf(e.map(this.pos))}resolve(e){let t=e.resolve(this.pos);return Z.valid(t)?new Z(t):P.near(t)}}function xv(n){for(let e=n.depth;e>=0;e--){let t=n.index(e),r=n.node(e);if(t==0){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(t-1);;i=i.lastChild){if(i.childCount==0&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}}return!0}function Cv(n){for(let e=n.depth;e>=0;e--){let t=n.indexAfter(e),r=n.node(e);if(t==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(t);;i=i.firstChild){if(i.childCount==0&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}}return!0}function Nv(){return new Ft({props:{decorations:Dv,createSelectionBetween(n,e,t){return e.pos==t.pos&&Z.valid(t)?new Z(t):null},handleClick:Ev,handleKeyDown:Mv,handleDOMEvents:{beforeinput:Ov}}})}const Mv=Bk({ArrowLeft:as("horiz",-1),ArrowRight:as("horiz",1),ArrowUp:as("vert",-1),ArrowDown:as("vert",1)});function as(n,e){const t=n=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,i,o){let s=r.selection,l=e>0?s.$to:s.$from,a=s.empty;if(s instanceof $){if(!o.endOfTextblock(t)||l.depth==0)return!1;a=!1,l=r.doc.resolve(e>0?l.after():l.before())}let u=Z.findGapCursorFrom(l,e,a);return u?(i&&i(r.tr.setSelection(new Z(u))),!0):!1}}function Ev(n,e,t){if(!n||!n.editable)return!1;let r=n.state.doc.resolve(e);if(!Z.valid(r))return!1;let i=n.posAtCoords({left:t.clientX,top:t.clientY});return i&&i.inside>-1&&z.isSelectable(n.state.doc.nodeAt(i.inside))?!1:(n.dispatch(n.state.tr.setSelection(new Z(r))),!0)}function Ov(n,e){if(e.inputType!="insertCompositionText"||!(n.state.selection instanceof Z))return!1;let{$from:t}=n.state.selection,r=t.parent.contentMatchAt(t.index()).findWrapping(n.state.schema.nodes.text);if(!r)return!1;let i=v.empty;for(let s=r.length-1;s>=0;s--)i=v.from(r[s].createAndFill(null,i));let o=n.state.tr.replace(t.pos,t.pos,new w(i,0,0));return o.setSelection($.near(o.doc.resolve(t.pos+1))),n.dispatch(o),!1}function Dv(n){if(!(n.selection instanceof Z))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",W.create(n.doc,[me.widget(n.selection.head,e,{key:"gapcursor"})])}const Qg=65535,Yg=Math.pow(2,16);function Tv(n,e){return n+e*Yg}function wh(n){return n&Qg}function Rv(n){return(n-(n&Qg))/Yg}const Gg=1,Xg=2,Ws=4,Zg=8;let vh=class{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&Zg)>0}get deletedBefore(){return(this.delInfo&(Gg|Ws))>0}get deletedAfter(){return(this.delInfo&(Xg|Ws))>0}get deletedAcross(){return(this.delInfo&Ws)>0}},Yr=class xr{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&xr.empty)return xr.empty}recover(e){let t=0,r=wh(e);if(!this.inverted)for(let i=0;i<r;i++)t+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+t+Rv(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let i=0,o=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?i:0);if(a>e)break;let u=this.ranges[l+o],c=this.ranges[l+s],f=a+u;if(e<=f){let d=u?e==a?-1:e==f?1:t:t,p=a+i+(d<0?0:c);if(r)return p;let h=e==(t<0?a:f)?null:Tv(l/3,e-a),m=e==a?Xg:e==f?Gg:Ws;return(t<0?e!=a:e!=f)&&(m|=Zg),new vh(p,m,h)}i+=c-u}return r?e+i:new vh(e+i,0,null)}touches(e,t){let r=0,i=wh(t),o=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?r:0);if(a>e)break;let u=this.ranges[l+o],c=a+u;if(e<=c&&l==i*3)return!0;r+=this.ranges[l+s]-u}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,o=0;i<this.ranges.length;i+=3){let s=this.ranges[i],l=s-(this.inverted?o:0),a=s+(this.inverted?0:o),u=this.ranges[i+t],c=this.ranges[i+r];e(l,l+u,a,a+c),o+=c-u}}invert(){return new xr(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?xr.empty:new xr(e<0?[0,-e,0]:[0,0,e])}};Yr.empty=new Yr([]);const Pa=Object.create(null);let qe=class{getMap(){return Yr.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=Pa[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in Pa)throw new RangeError("Duplicate use of step JSON ID "+e);return Pa[e]=t,t.prototype.jsonID=e,t}},Be=class Bi{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new Bi(e,null)}static fail(e){return new Bi(null,e)}static fromReplace(e,t,r,i){try{return Bi.ok(e.replace(t,r,i))}catch(o){if(o instanceof En)return Bi.fail(o.message);throw o}}};function pf(n,e,t){let r=[];for(let i=0;i<n.childCount;i++){let o=n.child(i);o.content.size&&(o=o.copy(pf(o.content,e,o))),o.isInline&&(o=e(o,t,i)),r.push(o)}return v.fromArray(r)}let ey=class Vi extends qe{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),o=new w(pf(t.content,(s,l)=>!s.isAtom||!l.type.allowsMarkType(this.mark.type)?s:s.mark(this.mark.addToSet(s.marks)),i),t.openStart,t.openEnd);return Be.fromReplace(e,this.from,this.to,o)}invert(){return new ty(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Vi(t.pos,r.pos,this.mark)}merge(e){return e instanceof Vi&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Vi(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Vi(t.from,t.to,e.markFromJSON(t.mark))}};qe.jsonID("addMark",ey);let ty=class Ji extends qe{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new w(pf(t.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),t.openStart,t.openEnd);return Be.fromReplace(e,this.from,this.to,r)}invert(){return new ey(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Ji(t.pos,r.pos,this.mark)}merge(e){return e instanceof Ji&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Ji(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Ji(t.from,t.to,e.markFromJSON(t.mark))}};qe.jsonID("removeMark",ty);let ny=class _i extends qe{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Be.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return Be.fromReplace(e,this.pos,this.pos+1,new w(v.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let i=0;i<t.marks.length;i++)if(!t.marks[i].isInSet(r))return new _i(this.pos,t.marks[i]);return new _i(this.pos,this.mark)}}return new ry(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new _i(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new _i(t.pos,e.markFromJSON(t.mark))}};qe.jsonID("addNodeMark",ny);let ry=class Pu extends qe{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Be.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return Be.fromReplace(e,this.pos,this.pos+1,new w(v.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new ny(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Pu(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Pu(t.pos,e.markFromJSON(t.mark))}};qe.jsonID("removeNodeMark",ry);let Av=class Vn extends qe{constructor(e,t,r,i=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=i}apply(e){return this.structure&&Fu(e,this.from,this.to)?Be.fail("Structure replace would overwrite content"):Be.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Yr([this.from,this.to-this.from,this.slice.size])}invert(e){return new Vn(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new Vn(t.pos,Math.max(t.pos,r.pos),this.slice)}merge(e){if(!(e instanceof Vn)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?w.empty:new w(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new Vn(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?w.empty:new w(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new Vn(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Vn(t.from,t.to,w.fromJSON(e,t.slice),!!t.structure)}};qe.jsonID("replace",Av);let Iv=class Us extends qe{constructor(e,t,r,i,o,s,l=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=i,this.slice=o,this.insert=s,this.structure=l}apply(e){if(this.structure&&(Fu(e,this.from,this.gapFrom)||Fu(e,this.gapTo,this.to)))return Be.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return Be.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?Be.fromReplace(e,this.from,this.to,r):Be.fail("Content does not fit in gap")}getMap(){return new Yr([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new Us(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=e.map(this.gapFrom,-1),o=e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||i<t.pos||o>r.pos?null:new Us(t.pos,r.pos,i,o,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Us(t.from,t.to,t.gapFrom,t.gapTo,w.fromJSON(e,t.slice),t.insert,!!t.structure)}};qe.jsonID("replaceAround",Iv);function Fu(n,e,t){let r=n.resolve(e),i=t-e,o=r.depth;for(;i>0&&o>0&&r.indexAfter(o)==r.node(o).childCount;)o--,i--;if(i>0){let s=r.node(o).maybeChild(r.indexAfter(o));for(;i>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,i--}}return!1}function bv(n,e,t=null,r=n){let i=zv(n,e),o=i&&Pv(r,e);return o?i.map(xh).concat({type:e,attrs:t}).concat(o.map(xh)):null}function xh(n){return{type:n,attrs:null}}function zv(n,e){let{parent:t,startIndex:r,endIndex:i}=n,o=t.contentMatchAt(r).findWrapping(e);if(!o)return null;let s=o.length?o[0]:e;return t.canReplaceWith(r,i,s)?o:null}function Pv(n,e){let{parent:t,startIndex:r,endIndex:i}=n,o=t.child(r),s=e.contentMatch.findWrapping(o.type);if(!s)return null;let a=(s.length?s[s.length-1]:e).contentMatch;for(let u=r;a&&u<i;u++)a=a.matchType(t.child(u).type);return!a||!a.validEnd?null:s}function Fv(n,e){let t=n.resolve(e),r=t.index();return Lv(t.nodeBefore,t.nodeAfter)&&t.parent.canReplace(r,r+1)}function Lv(n,e){return!!(n&&e&&!n.isLeaf&&n.canAppend(e))}let $v=class Hs extends qe{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return Be.fail("No node at attribute step's position");let r=Object.create(null);for(let o in t.attrs)r[o]=t.attrs[o];r[this.attr]=this.value;let i=t.type.create(r,null,t.marks);return Be.fromReplace(e,this.pos,this.pos+1,new w(v.from(i),0,t.isLeaf?0:1))}getMap(){return Yr.empty}invert(e){return new Hs(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Hs(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Hs(t.pos,t.attr,t.value)}};qe.jsonID("attr",$v);let wo=class extends Error{};wo=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};wo.prototype=Object.create(Error.prototype);wo.prototype.constructor=wo;wo.prototype.name="TransformError";class cr{constructor(e,t,r={}){this.match=e,this.match=e,this.handler=typeof t=="string"?Bv(t):t,this.undoable=r.undoable!==!1,this.inCode=r.inCode||!1}}function Bv(n){return function(e,t,r,i){let o=n;if(t[1]){let s=t[0].lastIndexOf(t[1]);o+=t[0].slice(s+t[1].length),r+=s;let l=r-i;l>0&&(o=t[0].slice(s-l,s)+o,r=i)}return e.tr.insertText(o,r,i)}}const Vv=500;function Jv({rules:n}){let e=new Ft({state:{init(){return null},apply(t,r){let i=t.getMeta(this);return i||(t.selectionSet||t.docChanged?null:r)}},props:{handleTextInput(t,r,i,o){return Ch(t,r,i,o,n,e)},handleDOMEvents:{compositionend:t=>{setTimeout(()=>{let{$cursor:r}=t.state.selection;r&&Ch(t,r.pos,r.pos,"",n,e)})}}},isInputRules:!0});return e}function Ch(n,e,t,r,i,o){if(n.composing)return!1;let s=n.state,l=s.doc.resolve(e),a=l.parent.textBetween(Math.max(0,l.parentOffset-Vv),l.parentOffset,null,"￼")+r;for(let u=0;u<i.length;u++){let c=i[u];if(l.parent.type.spec.code){if(!c.inCode)continue}else if(c.inCode==="only")continue;let f=c.match.exec(a),d=f&&c.handler(s,f,e-(f[0].length-r.length),t);if(d)return c.undoable&&d.setMeta(o,{transform:d,from:e,to:t,text:r}),n.dispatch(d),!0}return!1}new cr(/--$/,"—");new cr(/\.\.\.$/,"…");new cr(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(")$/,"“");new cr(/"$/,"”");new cr(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(')$/,"‘");new cr(/'$/,"’");function _v(n,e,t=null,r){return new cr(n,(i,o,s,l)=>{let a=t instanceof Function?t(o):t,u=i.tr.delete(s,l),c=u.doc.resolve(s),f=c.blockRange(),d=f&&bv(f,e,a);if(!d)return null;u.wrap(f,d);let p=u.doc.resolve(s-1).nodeBefore;return p&&p.type==e&&Fv(u.doc,s-1)&&!r&&u.join(s-1),u})}const Wv=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!1;function Uv(n){let e=n.split(/-(?!$)/),t=e[e.length-1];t=="Space"&&(t=" ");let r,i,o,s;for(let l=0;l<e.length-1;l++){let a=e[l];if(/^(cmd|meta|m)$/i.test(a))s=!0;else if(/^a(lt)?$/i.test(a))r=!0;else if(/^(c|ctrl|control)$/i.test(a))i=!0;else if(/^s(hift)?$/i.test(a))o=!0;else if(/^mod$/i.test(a))Wv?s=!0:i=!0;else throw new Error("Unrecognized modifier name: "+a)}return r&&(t="Alt-"+t),i&&(t="Ctrl-"+t),s&&(t="Meta-"+t),o&&(t="Shift-"+t),t}function Hv(n){let e=Object.create(null);for(let t in n)e[Uv(t)]=n[t];return e}function Fa(n,e,t=!0){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t&&e.shiftKey&&(n="Shift-"+n),n}function jv(n){return new Ft({props:{handleKeyDown:Kv(n)}})}function Kv(n){let e=Hv(n);return function(t,r){let i=tf(r),o,s=e[Fa(i,r)];if(s&&s(t.state,t.dispatch,t))return!0;if(i.length==1&&i!=" "){if(r.shiftKey){let l=e[Fa(i,r,!1)];if(l&&l(t.state,t.dispatch,t))return!0}if((r.shiftKey||r.altKey||r.metaKey||i.charCodeAt(0)>127)&&(o=At[r.keyCode])&&o!=i){let l=e[Fa(o,r)];if(l&&l(t.state,t.dispatch,t))return!0}}return!1}}const qv=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!1;function Qv(n){let e=n.split(/-(?!$)/),t=e[e.length-1];t=="Space"&&(t=" ");let r,i,o,s;for(let l=0;l<e.length-1;l++){let a=e[l];if(/^(cmd|meta|m)$/i.test(a))s=!0;else if(/^a(lt)?$/i.test(a))r=!0;else if(/^(c|ctrl|control)$/i.test(a))i=!0;else if(/^s(hift)?$/i.test(a))o=!0;else if(/^mod$/i.test(a))qv?s=!0:i=!0;else throw new Error("Unrecognized modifier name: "+a)}return r&&(t="Alt-"+t),i&&(t="Ctrl-"+t),s&&(t="Meta-"+t),o&&(t="Shift-"+t),t}function Yv(n){let e=Object.create(null);for(let t in n)e[Qv(t)]=n[t];return e}function La(n,e,t=!0){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t&&e.shiftKey&&(n="Shift-"+n),n}function Gv(n){let e=Yv(n);return function(t,r){let i=tf(r),o,s=e[La(i,r)];if(s&&s(t.state,t.dispatch,t))return!0;if(i.length==1&&i!=" "){if(r.shiftKey){let l=e[La(i,r,!1)];if(l&&l(t.state,t.dispatch,t))return!0}if((r.shiftKey||r.altKey||r.metaKey||i.charCodeAt(0)>127)&&(o=At[r.keyCode])&&o!=i){let l=e[La(o,r)];if(l&&l(t.state,t.dispatch,t))return!0}}return!1}}const iy=65535,oy=Math.pow(2,16);function Xv(n,e){return n+e*oy}function Nh(n){return n&iy}function Zv(n){return(n-(n&iy))/oy}const sy=1,ly=2,js=4,ay=8;class Lu{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&ay)>0}get deletedBefore(){return(this.delInfo&(sy|js))>0}get deletedAfter(){return(this.delInfo&(ly|js))>0}get deletedAcross(){return(this.delInfo&js)>0}}class Ye{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&Ye.empty)return Ye.empty}recover(e){let t=0,r=Nh(e);if(!this.inverted)for(let i=0;i<r;i++)t+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+t+Zv(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let i=0,o=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?i:0);if(a>e)break;let u=this.ranges[l+o],c=this.ranges[l+s],f=a+u;if(e<=f){let d=u?e==a?-1:e==f?1:t:t,p=a+i+(d<0?0:c);if(r)return p;let h=e==(t<0?a:f)?null:Xv(l/3,e-a),m=e==a?ly:e==f?sy:js;return(t<0?e!=a:e!=f)&&(m|=ay),new Lu(p,m,h)}i+=c-u}return r?e+i:new Lu(e+i,0,null)}touches(e,t){let r=0,i=Nh(t),o=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?r:0);if(a>e)break;let u=this.ranges[l+o],c=a+u;if(e<=c&&l==i*3)return!0;r+=this.ranges[l+s]-u}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,o=0;i<this.ranges.length;i+=3){let s=this.ranges[i],l=s-(this.inverted?o:0),a=s+(this.inverted?0:o),u=this.ranges[i+t],c=this.ranges[i+r];e(l,l+u,a,a+c),o+=c-u}}invert(){return new Ye(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?Ye.empty:new Ye(e<0?[0,-e,0]:[0,0,e])}}Ye.empty=new Ye([]);class Zi{constructor(e=[],t,r=0,i=e.length){this.maps=e,this.mirror=t,this.from=r,this.to=i}slice(e=0,t=this.maps.length){return new Zi(this.maps,this.mirror,e,t)}copy(){return new Zi(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(e,t){this.to=this.maps.push(e),t!=null&&this.setMirror(this.maps.length-1,t)}appendMapping(e){for(let t=0,r=this.maps.length;t<e.maps.length;t++){let i=e.getMirror(t);this.appendMap(e.maps[t],i!=null&&i<t?r+i:void 0)}}getMirror(e){if(this.mirror){for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,r=this.maps.length+e.maps.length;t>=0;t--){let i=e.getMirror(t);this.appendMap(e.maps[t].invert(),i!=null&&i>t?r-i-1:void 0)}}invert(){let e=new Zi;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let r=this.from;r<this.to;r++)e=this.maps[r].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,r){let i=0;for(let o=this.from;o<this.to;o++){let s=this.maps[o],l=s.mapResult(e,t);if(l.recover!=null){let a=this.getMirror(o);if(a!=null&&a>o&&a<this.to){o=a,e=this.maps[a].recover(l.recover);continue}}i|=l.delInfo,e=l.pos}return r?e:new Lu(e,i,null)}}const $a=Object.create(null);class Me{getMap(){return Ye.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=$a[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in $a)throw new RangeError("Duplicate use of step JSON ID "+e);return $a[e]=t,t.prototype.jsonID=e,t}}class oe{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new oe(e,null)}static fail(e){return new oe(null,e)}static fromReplace(e,t,r,i){try{return oe.ok(e.replace(t,r,i))}catch(o){if(o instanceof En)return oe.fail(o.message);throw o}}}function mf(n,e,t){let r=[];for(let i=0;i<n.childCount;i++){let o=n.child(i);o.content.size&&(o=o.copy(mf(o.content,e,o))),o.isInline&&(o=e(o,t,i)),r.push(o)}return v.fromArray(r)}class dn extends Me{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),o=new w(mf(t.content,(s,l)=>!s.isAtom||!l.type.allowsMarkType(this.mark.type)?s:s.mark(this.mark.addToSet(s.marks)),i),t.openStart,t.openEnd);return oe.fromReplace(e,this.from,this.to,o)}invert(){return new Et(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new dn(t.pos,r.pos,this.mark)}merge(e){return e instanceof dn&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new dn(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new dn(t.from,t.to,e.markFromJSON(t.mark))}}Me.jsonID("addMark",dn);class Et extends Me{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new w(mf(t.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),t.openStart,t.openEnd);return oe.fromReplace(e,this.from,this.to,r)}invert(){return new dn(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Et(t.pos,r.pos,this.mark)}merge(e){return e instanceof Et&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Et(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Et(t.from,t.to,e.markFromJSON(t.mark))}}Me.jsonID("removeMark",Et);class hn extends Me{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return oe.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return oe.fromReplace(e,this.pos,this.pos+1,new w(v.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let i=0;i<t.marks.length;i++)if(!t.marks[i].isInSet(r))return new hn(this.pos,t.marks[i]);return new hn(this.pos,this.mark)}}return new Gr(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new hn(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new hn(t.pos,e.markFromJSON(t.mark))}}Me.jsonID("addNodeMark",hn);class Gr extends Me{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return oe.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return oe.fromReplace(e,this.pos,this.pos+1,new w(v.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new hn(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Gr(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Gr(t.pos,e.markFromJSON(t.mark))}}Me.jsonID("removeNodeMark",Gr);class De extends Me{constructor(e,t,r,i=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=i}apply(e){return this.structure&&$u(e,this.from,this.to)?oe.fail("Structure replace would overwrite content"):oe.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Ye([this.from,this.to-this.from,this.slice.size])}invert(e){return new De(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new De(t.pos,Math.max(t.pos,r.pos),this.slice)}merge(e){if(!(e instanceof De)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?w.empty:new w(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new De(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?w.empty:new w(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new De(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new De(t.from,t.to,w.fromJSON(e,t.slice),!!t.structure)}}Me.jsonID("replace",De);class Dt extends Me{constructor(e,t,r,i,o,s,l=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=i,this.slice=o,this.insert=s,this.structure=l}apply(e){if(this.structure&&($u(e,this.from,this.gapFrom)||$u(e,this.gapTo,this.to)))return oe.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return oe.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?oe.fromReplace(e,this.from,this.to,r):oe.fail("Content does not fit in gap")}getMap(){return new Ye([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new Dt(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=e.map(this.gapFrom,-1),o=e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||i<t.pos||o>r.pos?null:new Dt(t.pos,r.pos,i,o,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Dt(t.from,t.to,t.gapFrom,t.gapTo,w.fromJSON(e,t.slice),t.insert,!!t.structure)}}Me.jsonID("replaceAround",Dt);function $u(n,e,t){let r=n.resolve(e),i=t-e,o=r.depth;for(;i>0&&o>0&&r.indexAfter(o)==r.node(o).childCount;)o--,i--;if(i>0){let s=r.node(o).maybeChild(r.indexAfter(o));for(;i>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,i--}}return!1}function ex(n,e,t,r){let i=[],o=[],s,l;n.doc.nodesBetween(e,t,(a,u,c)=>{if(!a.isInline)return;let f=a.marks;if(!r.isInSet(f)&&c.type.allowsMarkType(r.type)){let d=Math.max(u,e),p=Math.min(u+a.nodeSize,t),h=r.addToSet(f);for(let m=0;m<f.length;m++)f[m].isInSet(h)||(s&&s.to==d&&s.mark.eq(f[m])?s.to=p:i.push(s=new Et(d,p,f[m])));l&&l.to==d?l.to=p:o.push(l=new dn(d,p,r))}}),i.forEach(a=>n.step(a)),o.forEach(a=>n.step(a))}function tx(n,e,t,r){let i=[],o=0;n.doc.nodesBetween(e,t,(s,l)=>{if(!s.isInline)return;o++;let a=null;if(r instanceof Wo){let u=s.marks,c;for(;c=r.isInSet(u);)(a||(a=[])).push(c),u=c.removeFromSet(u)}else r?r.isInSet(s.marks)&&(a=[r]):a=s.marks;if(a&&a.length){let u=Math.min(l+s.nodeSize,t);for(let c=0;c<a.length;c++){let f=a[c],d;for(let p=0;p<i.length;p++){let h=i[p];h.step==o-1&&f.eq(i[p].style)&&(d=h)}d?(d.to=u,d.step=o):i.push({style:f,from:Math.max(l,e),to:u,step:o})}}}),i.forEach(s=>n.step(new Et(s.from,s.to,s.style)))}function nx(n,e,t,r=t.contentMatch){let i=n.doc.nodeAt(e),o=[],s=e+1;for(let l=0;l<i.childCount;l++){let a=i.child(l),u=s+a.nodeSize,c=r.matchType(a.type);if(!c)o.push(new De(s,u,w.empty));else{r=c;for(let f=0;f<a.marks.length;f++)t.allowsMarkType(a.marks[f].type)||n.step(new Et(s,u,a.marks[f]));if(a.isText&&!t.spec.code){let f,d=/\r?\n|\r/g,p;for(;f=d.exec(a.text);)p||(p=new w(v.from(t.schema.text(" ",t.allowedMarks(a.marks))),0,0)),o.push(new De(s+f.index,s+f.index+f[0].length,p))}}s=u}if(!r.validEnd){let l=r.fillBefore(v.empty,!0);n.replace(s,s,new w(l,0,0))}for(let l=o.length-1;l>=0;l--)n.step(o[l])}function rx(n,e,t){let{$from:r,$to:i,depth:o}=e,s=r.before(o+1),l=i.after(o+1),a=s,u=l,c=v.empty,f=0;for(let h=o,m=!1;h>t;h--)m||r.index(h)>0?(m=!0,c=v.from(r.node(h).copy(c)),f++):a--;let d=v.empty,p=0;for(let h=o,m=!1;h>t;h--)m||i.after(h+1)<i.end(h)?(m=!0,d=v.from(i.node(h).copy(d)),p++):u++;n.step(new Dt(a,u,s,l,new w(c.append(d),f,p),c.size-f,!0))}function ix(n,e,t){let r=v.empty;for(let s=t.length-1;s>=0;s--){if(r.size){let l=t[s].type.contentMatch.matchFragment(r);if(!l||!l.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=v.from(t[s].type.create(t[s].attrs,r))}let i=e.start,o=e.end;n.step(new Dt(i,o,i,o,new w(r,0,0),t.length,!0))}function ox(n,e,t,r,i){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let o=n.steps.length;n.doc.nodesBetween(e,t,(s,l)=>{if(s.isTextblock&&!s.hasMarkup(r,i)&&sx(n.doc,n.mapping.slice(o).map(l),r)){n.clearIncompatible(n.mapping.slice(o).map(l,1),r);let a=n.mapping.slice(o),u=a.map(l,1),c=a.map(l+s.nodeSize,1);return n.step(new Dt(u,c,u+1,c-1,new w(v.from(r.create(i,null,s.marks)),0,0),1,!0)),!1}})}function sx(n,e,t){let r=n.resolve(e),i=r.index();return r.parent.canReplaceWith(i,i+1,t)}function lx(n,e,t,r,i){let o=n.doc.nodeAt(e);if(!o)throw new RangeError("No node at given position");t||(t=o.type);let s=t.create(r,null,i||o.marks);if(o.isLeaf)return n.replaceWith(e,e+o.nodeSize,s);if(!t.validContent(o.content))throw new RangeError("Invalid content for node type "+t.name);n.step(new Dt(e,e+o.nodeSize,e+1,e+o.nodeSize-1,new w(v.from(s),0,0),1,!0))}function ax(n,e,t=1,r){let i=n.doc.resolve(e),o=v.empty,s=v.empty;for(let l=i.depth,a=i.depth-t,u=t-1;l>a;l--,u--){o=v.from(i.node(l).copy(o));let c=r&&r[u];s=v.from(c?c.type.create(c.attrs,s):i.node(l).copy(s))}n.step(new De(e,e,new w(o.append(s),t,t),!0))}function ux(n,e,t){let r=new De(e-t,e+t,w.empty,!0);n.step(r)}function cx(n,e,t){let r=n.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),t))return e;if(r.parentOffset==0)for(let i=r.depth-1;i>=0;i--){let o=r.index(i);if(r.node(i).canReplaceWith(o,o,t))return r.before(i+1);if(o>0)return null}if(r.parentOffset==r.parent.content.size)for(let i=r.depth-1;i>=0;i--){let o=r.indexAfter(i);if(r.node(i).canReplaceWith(o,o,t))return r.after(i+1);if(o<r.node(i).childCount)return null}return null}function fx(n,e,t=e,r=w.empty){if(e==t&&!r.size)return null;let i=n.resolve(e),o=n.resolve(t);return uy(i,o,r)?new De(e,t,r):new dx(i,o,r).fit()}function uy(n,e,t){return!t.openStart&&!t.openEnd&&n.start()==e.start()&&n.parent.canReplace(n.index(),e.index(),t.content)}class dx{constructor(e,t,r){this.$from=e,this.$to=t,this.unplaced=r,this.frontier=[],this.placed=v.empty;for(let i=0;i<=e.depth;i++){let o=e.node(i);this.frontier.push({type:o.type,match:o.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=v.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let u=this.findFittable();u?this.placeNodes(u):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(e<0?this.$to:r.doc.resolve(e));if(!i)return null;let o=this.placed,s=r.depth,l=i.depth;for(;s&&l&&o.childCount==1;)o=o.firstChild.content,s--,l--;let a=new w(o,s,l);return e>-1?new Dt(r.pos,e,this.$to.pos,this.$to.end(),a,t):a.size||r.pos!=this.$to.pos?new De(r.pos,i.pos,a):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,r=0,i=this.unplaced.openEnd;r<e;r++){let o=t.firstChild;if(t.childCount>1&&(i=0),o.type.spec.isolating&&i<=r){e=r;break}t=o.content}for(let t=1;t<=2;t++)for(let r=t==1?e:this.unplaced.openStart;r>=0;r--){let i,o=null;r?(o=Ba(this.unplaced.content,r-1).firstChild,i=o.content):i=this.unplaced.content;let s=i.firstChild;for(let l=this.depth;l>=0;l--){let{type:a,match:u}=this.frontier[l],c,f=null;if(t==1&&(s?u.matchType(s.type)||(f=u.fillBefore(v.from(s),!1)):o&&a.compatibleContent(o.type)))return{sliceDepth:r,frontierDepth:l,parent:o,inject:f};if(t==2&&s&&(c=u.findWrapping(s.type)))return{sliceDepth:r,frontierDepth:l,parent:o,wrap:c};if(o&&u.matchType(o.type))break}}}openMore(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=Ba(e,t);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new w(e,t+1,Math.max(r,i.size+t>=e.size-r?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=Ba(e,t);if(i.childCount<=1&&t>0){let o=e.size-t<=t+i.size;this.unplaced=new w(Wi(e,t-1,1),t-1,o?t-1:r)}else this.unplaced=new w(Wi(e,t,1),t,r)}placeNodes({sliceDepth:e,frontierDepth:t,parent:r,inject:i,wrap:o}){for(;this.depth>t;)this.closeFrontierNode();if(o)for(let m=0;m<o.length;m++)this.openFrontierNode(o[m]);let s=this.unplaced,l=r?r.content:s.content,a=s.openStart-e,u=0,c=[],{match:f,type:d}=this.frontier[t];if(i){for(let m=0;m<i.childCount;m++)c.push(i.child(m));f=f.matchFragment(i)}let p=l.size+e-(s.content.size-s.openEnd);for(;u<l.childCount;){let m=l.child(u),k=f.matchType(m.type);if(!k)break;u++,(u>1||a==0||m.content.size)&&(f=k,c.push(cy(m.mark(d.allowedMarks(m.marks)),u==1?a:0,u==l.childCount?p:-1)))}let h=u==l.childCount;h||(p=-1),this.placed=Ui(this.placed,t,v.from(c)),this.frontier[t].match=f,h&&p<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let m=0,k=l;m<p;m++){let g=k.lastChild;this.frontier.push({type:g.type,match:g.contentMatchAt(g.childCount)}),k=g.content}this.unplaced=h?e==0?w.empty:new w(Wi(s.content,e-1,1),e-1,p<0?s.openEnd:e-1):new w(Wi(s.content,e,u),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!Va(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:r,type:i}=this.frontier[t],o=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),s=Va(e,t,i,r,o);if(s){for(let l=t-1;l>=0;l--){let{match:a,type:u}=this.frontier[l],c=Va(e,l,u,a,!0);if(!c||c.childCount)continue e}return{depth:t,fit:s,move:o?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=Ui(this.placed,t.depth,t.fit)),e=t.move;for(let r=t.depth+1;r<=e.depth;r++){let i=e.node(r),o=i.type.contentMatch.fillBefore(i.content,!0,e.index(r));this.openFrontierNode(i.type,i.attrs,o)}return e}openFrontierNode(e,t=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=Ui(this.placed,this.depth,v.from(e.create(t,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(v.empty,!0);t.childCount&&(this.placed=Ui(this.placed,this.frontier.length,t))}}function Wi(n,e,t){return e==0?n.cutByIndex(t,n.childCount):n.replaceChild(0,n.firstChild.copy(Wi(n.firstChild.content,e-1,t)))}function Ui(n,e,t){return e==0?n.append(t):n.replaceChild(n.childCount-1,n.lastChild.copy(Ui(n.lastChild.content,e-1,t)))}function Ba(n,e){for(let t=0;t<e;t++)n=n.firstChild.content;return n}function cy(n,e,t){if(e<=0)return n;let r=n.content;return e>1&&(r=r.replaceChild(0,cy(r.firstChild,e-1,r.childCount==1?t-1:0))),e>0&&(r=n.type.contentMatch.fillBefore(r).append(r),t<=0&&(r=r.append(n.type.contentMatch.matchFragment(r).fillBefore(v.empty,!0)))),n.copy(r)}function Va(n,e,t,r,i){let o=n.node(e),s=i?n.indexAfter(e):n.index(e);if(s==o.childCount&&!t.compatibleContent(o.type))return null;let l=r.fillBefore(o.content,!0,s);return l&&!hx(t,o.content,s)?l:null}function hx(n,e,t){for(let r=t;r<e.childCount;r++)if(!n.allowsMarks(e.child(r).marks))return!0;return!1}function px(n){return n.spec.defining||n.spec.definingForContent}function mx(n,e,t,r){if(!r.size)return n.deleteRange(e,t);let i=n.doc.resolve(e),o=n.doc.resolve(t);if(uy(i,o,r))return n.step(new De(e,t,r));let s=dy(i,n.doc.resolve(t));s[s.length-1]==0&&s.pop();let l=-(i.depth+1);s.unshift(l);for(let d=i.depth,p=i.pos-1;d>0;d--,p--){let h=i.node(d).type.spec;if(h.defining||h.definingAsContext||h.isolating)break;s.indexOf(d)>-1?l=d:i.before(d)==p&&s.splice(1,0,-d)}let a=s.indexOf(l),u=[],c=r.openStart;for(let d=r.content,p=0;;p++){let h=d.firstChild;if(u.push(h),p==r.openStart)break;d=h.content}for(let d=c-1;d>=0;d--){let p=u[d],h=px(p.type);if(h&&!p.sameMarkup(i.node(Math.abs(l)-1)))c=d;else if(h||!p.type.isTextblock)break}for(let d=r.openStart;d>=0;d--){let p=(d+c+1)%(r.openStart+1),h=u[p];if(h)for(let m=0;m<s.length;m++){let k=s[(m+a)%s.length],g=!0;k<0&&(g=!1,k=-k);let y=i.node(k-1),S=i.index(k-1);if(y.canReplaceWith(S,S,h.type,h.marks))return n.replace(i.before(k),g?o.after(k):t,new w(fy(r.content,0,r.openStart,p),p,r.openEnd))}}let f=n.steps.length;for(let d=s.length-1;d>=0&&(n.replace(e,t,r),!(n.steps.length>f));d--){let p=s[d];p<0||(e=i.before(p),t=o.after(p))}}function fy(n,e,t,r,i){if(e<t){let o=n.firstChild;n=n.replaceChild(0,o.copy(fy(o.content,e+1,t,r,o)))}if(e>r){let o=i.contentMatchAt(0),s=o.fillBefore(n).append(n);n=s.append(o.matchFragment(s).fillBefore(v.empty,!0))}return n}function gx(n,e,t,r){if(!r.isInline&&e==t&&n.doc.resolve(e).parent.content.size){let i=cx(n.doc,e,r.type);i!=null&&(e=t=i)}n.replaceRange(e,t,new w(v.from(r),0,0))}function yx(n,e,t){let r=n.doc.resolve(e),i=n.doc.resolve(t),o=dy(r,i);for(let s=0;s<o.length;s++){let l=o[s],a=s==o.length-1;if(a&&l==0||r.node(l).type.contentMatch.validEnd)return n.delete(r.start(l),i.end(l));if(l>0&&(a||r.node(l-1).canReplace(r.index(l-1),i.indexAfter(l-1))))return n.delete(r.before(l),i.after(l))}for(let s=1;s<=r.depth&&s<=i.depth;s++)if(e-r.start(s)==r.depth-s&&t>r.end(s)&&i.end(s)-t!=i.depth-s)return n.delete(r.before(s),t);n.delete(e,t)}function dy(n,e){let t=[],r=Math.min(n.depth,e.depth);for(let i=r;i>=0;i--){let o=n.start(i);if(o<n.pos-(n.depth-i)||e.end(i)>e.pos+(e.depth-i)||n.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(o==e.start(i)||i==n.depth&&i==e.depth&&n.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==o-1)&&t.push(i)}return t}class Lr extends Me{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return oe.fail("No node at attribute step's position");let r=Object.create(null);for(let o in t.attrs)r[o]=t.attrs[o];r[this.attr]=this.value;let i=t.type.create(r,null,t.marks);return oe.fromReplace(e,this.pos,this.pos+1,new w(v.from(i),0,t.isLeaf?0:1))}getMap(){return Ye.empty}invert(e){return new Lr(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Lr(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Lr(t.pos,t.attr,t.value)}}Me.jsonID("attr",Lr);class vo extends Me{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let i in e.attrs)t[i]=e.attrs[i];t[this.attr]=this.value;let r=e.type.create(t,e.content,e.marks);return oe.ok(r)}getMap(){return Ye.empty}invert(e){return new vo(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new vo(t.attr,t.value)}}Me.jsonID("docAttr",vo);let Xr=class extends Error{};Xr=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};Xr.prototype=Object.create(Error.prototype);Xr.prototype.constructor=Xr;Xr.prototype.name="TransformError";class Sx{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new Zi}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new Xr(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,r=w.empty){let i=fx(this.doc,e,t,r);return i&&this.step(i),this}replaceWith(e,t,r){return this.replace(e,t,new w(v.from(r),0,0))}delete(e,t){return this.replace(e,t,w.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,r){return mx(this,e,t,r),this}replaceRangeWith(e,t,r){return gx(this,e,t,r),this}deleteRange(e,t){return yx(this,e,t),this}lift(e,t){return rx(this,e,t),this}join(e,t=1){return ux(this,e,t),this}wrap(e,t){return ix(this,e,t),this}setBlockType(e,t=e,r,i=null){return ox(this,e,t,r,i),this}setNodeMarkup(e,t,r=null,i){return lx(this,e,t,r,i),this}setNodeAttribute(e,t,r){return this.step(new Lr(e,t,r)),this}setDocAttribute(e,t){return this.step(new vo(e,t)),this}addNodeMark(e,t){return this.step(new hn(e,t)),this}removeNodeMark(e,t){if(!(t instanceof _)){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(t=t.isInSet(r.marks),!t)return this}return this.step(new Gr(e,t)),this}split(e,t=1,r){return ax(this,e,t,r),this}addMark(e,t,r){return ex(this,e,t,r),this}removeMark(e,t,r){return tx(this,e,t,r),this}clearIncompatible(e,t,r){return nx(this,e,t,r),this}}var Bu,Vu;if(typeof WeakMap<"u"){let n=new WeakMap;Bu=e=>n.get(e),Vu=(e,t)=>(n.set(e,t),t)}else{const n=[];let t=0;Bu=r=>{for(let i=0;i<n.length;i+=2)if(n[i]==r)return n[i+1]},Vu=(r,i)=>(t==10&&(t=0),n[t++]=r,n[t++]=i)}var re=class{constructor(n,e,t,r){this.width=n,this.height=e,this.map=t,this.problems=r}findCell(n){for(let e=0;e<this.map.length;e++){const t=this.map[e];if(t!=n)continue;const r=e%this.width,i=e/this.width|0;let o=r+1,s=i+1;for(let l=1;o<this.width&&this.map[e+l]==t;l++)o++;for(let l=1;s<this.height&&this.map[e+this.width*l]==t;l++)s++;return{left:r,top:i,right:o,bottom:s}}throw new RangeError(`No cell with offset ${n} found`)}colCount(n){for(let e=0;e<this.map.length;e++)if(this.map[e]==n)return e%this.width;throw new RangeError(`No cell with offset ${n} found`)}nextCell(n,e,t){const{left:r,right:i,top:o,bottom:s}=this.findCell(n);return e=="horiz"?(t<0?r==0:i==this.width)?null:this.map[o*this.width+(t<0?r-1:i)]:(t<0?o==0:s==this.height)?null:this.map[r+this.width*(t<0?o-1:s)]}rectBetween(n,e){const{left:t,right:r,top:i,bottom:o}=this.findCell(n),{left:s,right:l,top:a,bottom:u}=this.findCell(e);return{left:Math.min(t,s),top:Math.min(i,a),right:Math.max(r,l),bottom:Math.max(o,u)}}cellsInRect(n){const e=[],t={};for(let r=n.top;r<n.bottom;r++)for(let i=n.left;i<n.right;i++){const o=r*this.width+i,s=this.map[o];t[s]||(t[s]=!0,!(i==n.left&&i&&this.map[o-1]==s||r==n.top&&r&&this.map[o-this.width]==s)&&e.push(s))}return e}positionAt(n,e,t){for(let r=0,i=0;;r++){const o=i+t.child(r).nodeSize;if(r==n){let s=e+n*this.width;const l=(n+1)*this.width;for(;s<l&&this.map[s]<i;)s++;return s==l?o-1:this.map[s]}i=o}}static get(n){return Bu(n)||Vu(n,kx(n))}};function kx(n){if(n.type.spec.tableRole!="table")throw new RangeError("Not a table node: "+n.type.name);const e=wx(n),t=n.childCount,r=[];let i=0,o=null;const s=[];for(let u=0,c=e*t;u<c;u++)r[u]=0;for(let u=0,c=0;u<t;u++){const f=n.child(u);c++;for(let h=0;;h++){for(;i<r.length&&r[i]!=0;)i++;if(h==f.childCount)break;const m=f.child(h),{colspan:k,rowspan:g,colwidth:y}=m.attrs;for(let S=0;S<g;S++){if(S+u>=t){(o||(o=[])).push({type:"overlong_rowspan",pos:c,n:g-S});break}const x=i+S*e;for(let M=0;M<k;M++){r[x+M]==0?r[x+M]=c:(o||(o=[])).push({type:"collision",row:u,pos:c,n:k-M});const O=y&&y[M];if(O){const D=(x+M)%e*2,R=s[D];R==null||R!=O&&s[D+1]==1?(s[D]=O,s[D+1]=1):R==O&&s[D+1]++}}}i+=k,c+=m.nodeSize}const d=(u+1)*e;let p=0;for(;i<d;)r[i++]==0&&p++;p&&(o||(o=[])).push({type:"missing",row:u,n:p}),c++}const l=new re(e,t,r,o);let a=!1;for(let u=0;!a&&u<s.length;u+=2)s[u]!=null&&s[u+1]<t&&(a=!0);return a&&vx(l,s,n),l}function wx(n){let e=-1,t=!1;for(let r=0;r<n.childCount;r++){const i=n.child(r);let o=0;if(t)for(let s=0;s<r;s++){const l=n.child(s);for(let a=0;a<l.childCount;a++){const u=l.child(a);s+u.attrs.rowspan>r&&(o+=u.attrs.colspan)}}for(let s=0;s<i.childCount;s++){const l=i.child(s);o+=l.attrs.colspan,l.attrs.rowspan>1&&(t=!0)}e==-1?e=o:e!=o&&(e=Math.max(e,o))}return e}function vx(n,e,t){n.problems||(n.problems=[]);const r={};for(let i=0;i<n.map.length;i++){const o=n.map[i];if(r[o])continue;r[o]=!0;const s=t.nodeAt(o);if(!s)throw new RangeError(`No cell with offset ${o} found`);let l=null;const a=s.attrs;for(let u=0;u<a.colspan;u++){const c=(i+u)%n.width,f=e[c*2];f!=null&&(!a.colwidth||a.colwidth[u]!=f)&&((l||(l=xx(a)))[u]=f)}l&&n.problems.unshift({type:"colwidth mismatch",pos:o,colwidth:l})}}function xx(n){if(n.colwidth)return n.colwidth.slice();const e=[];for(let t=0;t<n.colspan;t++)e.push(0);return e}function Mh(n,e){if(typeof n=="string")return{};const t=n.getAttribute("data-colwidth"),r=t&&/^\d+(,\d+)*$/.test(t)?t.split(",").map(s=>Number(s)):null,i=Number(n.getAttribute("colspan")||1),o={colspan:i,rowspan:Number(n.getAttribute("rowspan")||1),colwidth:r&&r.length==i?r:null};for(const s in e){const l=e[s].getFromDOM,a=l&&l(n);a!=null&&(o[s]=a)}return o}function Eh(n,e){const t={};n.attrs.colspan!=1&&(t.colspan=n.attrs.colspan),n.attrs.rowspan!=1&&(t.rowspan=n.attrs.rowspan),n.attrs.colwidth&&(t["data-colwidth"]=n.attrs.colwidth.join(","));for(const r in e){const i=e[r].setDOMAttr;i&&i(n.attrs[r],t)}return t}function Cx(n){const e=n.cellAttributes||{},t={colspan:{default:1},rowspan:{default:1},colwidth:{default:null}};for(const r in e)t[r]={default:e[r].default};return{table:{content:"table_row+",tableRole:"table",isolating:!0,group:n.tableGroup,parseDOM:[{tag:"table"}],toDOM(){return["table",["tbody",0]]}},table_row:{content:"(table_cell | table_header)*",tableRole:"row",parseDOM:[{tag:"tr"}],toDOM(){return["tr",0]}},table_cell:{content:n.cellContent,attrs:t,tableRole:"cell",isolating:!0,parseDOM:[{tag:"td",getAttrs:r=>Mh(r,e)}],toDOM(r){return["td",Eh(r,e),0]}},table_header:{content:n.cellContent,attrs:t,tableRole:"header_cell",isolating:!0,parseDOM:[{tag:"th",getAttrs:r=>Mh(r,e)}],toDOM(r){return["th",Eh(r,e),0]}}}}function zt(n){let e=n.cached.tableNodeTypes;if(!e){e=n.cached.tableNodeTypes={};for(const t in n.nodes){const r=n.nodes[t],i=r.spec.tableRole;i&&(e[i]=r)}}return e}var ln=new Ho("selectingCells");function qo(n){for(let e=n.depth-1;e>0;e--)if(n.node(e).type.spec.tableRole=="row")return n.node(0).resolve(n.before(e+1));return null}function gf(n){const e=n.selection.$head;for(let t=e.depth;t>0;t--)if(e.node(t).type.spec.tableRole=="row")return!0;return!1}function hy(n){const e=n.selection;if("$anchorCell"in e&&e.$anchorCell)return e.$anchorCell.pos>e.$headCell.pos?e.$anchorCell:e.$headCell;if("node"in e&&e.node&&e.node.type.spec.tableRole=="cell")return e.$anchor;const t=qo(e.$head)||Nx(e.$head);if(t)return t;throw new RangeError(`No cell found around position ${e.head}`)}function Nx(n){for(let e=n.nodeAfter,t=n.pos;e;e=e.firstChild,t++){const r=e.type.spec.tableRole;if(r=="cell"||r=="header_cell")return n.doc.resolve(t)}for(let e=n.nodeBefore,t=n.pos;e;e=e.lastChild,t--){const r=e.type.spec.tableRole;if(r=="cell"||r=="header_cell")return n.doc.resolve(t-e.nodeSize)}}function Ju(n){return n.parent.type.spec.tableRole=="row"&&!!n.nodeAfter}function yf(n,e){return n.depth==e.depth&&n.pos>=e.start(-1)&&n.pos<=e.end(-1)}function py(n,e,t){const r=n.node(-1),i=re.get(r),o=n.start(-1),s=i.nextCell(n.pos-o,e,t);return s==null?null:n.node(0).resolve(o+s)}function Zr(n,e,t=1){const r={...n,colspan:n.colspan-t};return r.colwidth&&(r.colwidth=r.colwidth.slice(),r.colwidth.splice(e,t),r.colwidth.some(i=>i>0)||(r.colwidth=null)),r}var ce=class Bt extends P{constructor(e,t=e){const r=e.node(-1),i=re.get(r),o=e.start(-1),s=i.rectBetween(e.pos-o,t.pos-o),l=e.node(0),a=i.cellsInRect(s).filter(c=>c!=t.pos-o);a.unshift(t.pos-o);const u=a.map(c=>{const f=r.nodeAt(c);if(!f)throw RangeError(`No cell with offset ${c} found`);const d=o+c+1;return new qm(l.resolve(d),l.resolve(d+f.content.size))});super(u[0].$from,u[0].$to,u),this.$anchorCell=e,this.$headCell=t}map(e,t){const r=e.resolve(t.map(this.$anchorCell.pos)),i=e.resolve(t.map(this.$headCell.pos));if(Ju(r)&&Ju(i)&&yf(r,i)){const o=this.$anchorCell.node(-1)!=r.node(-1);return o&&this.isRowSelection()?Bt.rowSelection(r,i):o&&this.isColSelection()?Bt.colSelection(r,i):new Bt(r,i)}return $.between(r,i)}content(){const e=this.$anchorCell.node(-1),t=re.get(e),r=this.$anchorCell.start(-1),i=t.rectBetween(this.$anchorCell.pos-r,this.$headCell.pos-r),o={},s=[];for(let a=i.top;a<i.bottom;a++){const u=[];for(let c=a*t.width+i.left,f=i.left;f<i.right;f++,c++){const d=t.map[c];if(o[d])continue;o[d]=!0;const p=t.findCell(d);let h=e.nodeAt(d);if(!h)throw RangeError(`No cell with offset ${d} found`);const m=i.left-p.left,k=p.right-i.right;if(m>0||k>0){let g=h.attrs;if(m>0&&(g=Zr(g,0,m)),k>0&&(g=Zr(g,g.colspan-k,k)),p.left<i.left){if(h=h.type.createAndFill(g),!h)throw RangeError(`Could not create cell with attrs ${JSON.stringify(g)}`)}else h=h.type.create(g,h.content)}if(p.top<i.top||p.bottom>i.bottom){const g={...h.attrs,rowspan:Math.min(p.bottom,i.bottom)-Math.max(p.top,i.top)};p.top<i.top?h=h.type.createAndFill(g):h=h.type.create(g,h.content)}u.push(h)}s.push(e.child(a).copy(v.from(u)))}const l=this.isColSelection()&&this.isRowSelection()?e:s;return new w(v.from(l),1,1)}replace(e,t=w.empty){const r=e.steps.length,i=this.ranges;for(let s=0;s<i.length;s++){const{$from:l,$to:a}=i[s],u=e.mapping.slice(r);e.replace(u.map(l.pos),u.map(a.pos),s?w.empty:t)}const o=P.findFrom(e.doc.resolve(e.mapping.slice(r).map(this.to)),-1);o&&e.setSelection(o)}replaceWith(e,t){this.replace(e,new w(v.from(t),0,0))}forEachCell(e){const t=this.$anchorCell.node(-1),r=re.get(t),i=this.$anchorCell.start(-1),o=r.cellsInRect(r.rectBetween(this.$anchorCell.pos-i,this.$headCell.pos-i));for(let s=0;s<o.length;s++)e(t.nodeAt(o[s]),i+o[s])}isColSelection(){const e=this.$anchorCell.index(-1),t=this.$headCell.index(-1);if(Math.min(e,t)>0)return!1;const r=e+this.$anchorCell.nodeAfter.attrs.rowspan,i=t+this.$headCell.nodeAfter.attrs.rowspan;return Math.max(r,i)==this.$headCell.node(-1).childCount}static colSelection(e,t=e){const r=e.node(-1),i=re.get(r),o=e.start(-1),s=i.findCell(e.pos-o),l=i.findCell(t.pos-o),a=e.node(0);return s.top<=l.top?(s.top>0&&(e=a.resolve(o+i.map[s.left])),l.bottom<i.height&&(t=a.resolve(o+i.map[i.width*(i.height-1)+l.right-1]))):(l.top>0&&(t=a.resolve(o+i.map[l.left])),s.bottom<i.height&&(e=a.resolve(o+i.map[i.width*(i.height-1)+s.right-1]))),new Bt(e,t)}isRowSelection(){const e=this.$anchorCell.node(-1),t=re.get(e),r=this.$anchorCell.start(-1),i=t.colCount(this.$anchorCell.pos-r),o=t.colCount(this.$headCell.pos-r);if(Math.min(i,o)>0)return!1;const s=i+this.$anchorCell.nodeAfter.attrs.colspan,l=o+this.$headCell.nodeAfter.attrs.colspan;return Math.max(s,l)==t.width}eq(e){return e instanceof Bt&&e.$anchorCell.pos==this.$anchorCell.pos&&e.$headCell.pos==this.$headCell.pos}static rowSelection(e,t=e){const r=e.node(-1),i=re.get(r),o=e.start(-1),s=i.findCell(e.pos-o),l=i.findCell(t.pos-o),a=e.node(0);return s.left<=l.left?(s.left>0&&(e=a.resolve(o+i.map[s.top*i.width])),l.right<i.width&&(t=a.resolve(o+i.map[i.width*(l.top+1)-1]))):(l.left>0&&(t=a.resolve(o+i.map[l.top*i.width])),s.right<i.width&&(e=a.resolve(o+i.map[i.width*(s.top+1)-1]))),new Bt(e,t)}toJSON(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}}static fromJSON(e,t){return new Bt(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,r=t){return new Bt(e.resolve(t),e.resolve(r))}getBookmark(){return new Mx(this.$anchorCell.pos,this.$headCell.pos)}};ce.prototype.visible=!1;P.jsonID("cell",ce);var Mx=class my{constructor(e,t){this.anchor=e,this.head=t}map(e){return new my(e.map(this.anchor),e.map(this.head))}resolve(e){const t=e.resolve(this.anchor),r=e.resolve(this.head);return t.parent.type.spec.tableRole=="row"&&r.parent.type.spec.tableRole=="row"&&t.index()<t.parent.childCount&&r.index()<r.parent.childCount&&yf(t,r)?new ce(t,r):P.near(r,1)}};function Ex(n){if(!(n.selection instanceof ce))return null;const e=[];return n.selection.forEachCell((t,r)=>{e.push(me.node(r,r+t.nodeSize,{class:"selectedCell"}))}),W.create(n.doc,e)}function Ox({$from:n,$to:e}){if(n.pos==e.pos||n.pos<n.pos-6)return!1;let t=n.pos,r=e.pos,i=n.depth;for(;i>=0&&!(n.after(i+1)<n.end(i));i--,t++);for(let o=e.depth;o>=0&&!(e.before(o+1)>e.start(o));o--,r--);return t==r&&/row|table/.test(n.node(i).type.spec.tableRole)}function Dx({$from:n,$to:e}){let t,r;for(let i=n.depth;i>0;i--){const o=n.node(i);if(o.type.spec.tableRole==="cell"||o.type.spec.tableRole==="header_cell"){t=o;break}}for(let i=e.depth;i>0;i--){const o=e.node(i);if(o.type.spec.tableRole==="cell"||o.type.spec.tableRole==="header_cell"){r=o;break}}return t!==r&&e.parentOffset===0}function Tx(n,e,t){const r=(e||n).selection,i=(e||n).doc;let o,s;if(r instanceof z&&(s=r.node.type.spec.tableRole)){if(s=="cell"||s=="header_cell")o=ce.create(i,r.from);else if(s=="row"){const l=i.resolve(r.from+1);o=ce.rowSelection(l,l)}else if(!t){const l=re.get(r.node),a=r.from+1,u=a+l.map[l.width*l.height-1];o=ce.create(i,a+1,u)}}else r instanceof $&&Ox(r)?o=$.create(i,r.from):r instanceof $&&Dx(r)&&(o=$.create(i,r.$from.start(),r.$from.end()));return o&&(e||(e=n.tr)).setSelection(o),e}var Rx=new Ho("fix-tables");function gy(n,e,t,r){const i=n.childCount,o=e.childCount;e:for(let s=0,l=0;s<o;s++){const a=e.child(s);for(let u=l,c=Math.min(i,s+3);u<c;u++)if(n.child(u)==a){l=u+1,t+=a.nodeSize;continue e}r(a,t),l<i&&n.child(l).sameMarkup(a)?gy(n.child(l),a,t+1,r):a.nodesBetween(0,a.content.size,r,t+1),t+=a.nodeSize}}function Ax(n,e){let t;const r=(i,o)=>{i.type.spec.tableRole=="table"&&(t=Ix(n,i,o,t))};return e?e.doc!=n.doc&&gy(e.doc,n.doc,0,r):n.doc.descendants(r),t}function Ix(n,e,t,r){const i=re.get(e);if(!i.problems)return r;r||(r=n.tr);const o=[];for(let a=0;a<i.height;a++)o.push(0);for(let a=0;a<i.problems.length;a++){const u=i.problems[a];if(u.type=="collision"){const c=e.nodeAt(u.pos);if(!c)continue;const f=c.attrs;for(let d=0;d<f.rowspan;d++)o[u.row+d]+=u.n;r.setNodeMarkup(r.mapping.map(t+1+u.pos),null,Zr(f,f.colspan-u.n,u.n))}else if(u.type=="missing")o[u.row]+=u.n;else if(u.type=="overlong_rowspan"){const c=e.nodeAt(u.pos);if(!c)continue;r.setNodeMarkup(r.mapping.map(t+1+u.pos),null,{...c.attrs,rowspan:c.attrs.rowspan-u.n})}else if(u.type=="colwidth mismatch"){const c=e.nodeAt(u.pos);if(!c)continue;r.setNodeMarkup(r.mapping.map(t+1+u.pos),null,{...c.attrs,colwidth:u.colwidth})}}let s,l;for(let a=0;a<o.length;a++)o[a]&&(s==null&&(s=a),l=a);for(let a=0,u=t+1;a<i.height;a++){const c=e.child(a),f=u+c.nodeSize,d=o[a];if(d>0){let p="cell";c.firstChild&&(p=c.firstChild.type.spec.tableRole);const h=[];for(let k=0;k<d;k++){const g=zt(n.schema)[p].createAndFill();g&&h.push(g)}const m=(a==0||s==a-1)&&l==a?u+1:f-1;r.insert(r.mapping.map(m),h)}u=f}return r.setMeta(Rx,{fixTables:!0})}function bx(n){if(!n.size)return null;let{content:e,openStart:t,openEnd:r}=n;for(;e.childCount==1&&(t>0&&r>0||e.child(0).type.spec.tableRole=="table");)t--,r--,e=e.child(0).content;const i=e.child(0),o=i.type.spec.tableRole,s=i.type.schema,l=[];if(o=="row")for(let a=0;a<e.childCount;a++){let u=e.child(a).content;const c=a?0:Math.max(0,t-1),f=a<e.childCount-1?0:Math.max(0,r-1);(c||f)&&(u=_u(zt(s).row,new w(u,c,f)).content),l.push(u)}else if(o=="cell"||o=="header_cell")l.push(t||r?_u(zt(s).row,new w(e,t,r)).content:e);else return null;return zx(s,l)}function zx(n,e){const t=[];for(let i=0;i<e.length;i++){const o=e[i];for(let s=o.childCount-1;s>=0;s--){const{rowspan:l,colspan:a}=o.child(s).attrs;for(let u=i;u<i+l;u++)t[u]=(t[u]||0)+a}}let r=0;for(let i=0;i<t.length;i++)r=Math.max(r,t[i]);for(let i=0;i<t.length;i++)if(i>=e.length&&e.push(v.empty),t[i]<r){const o=zt(n).cell.createAndFill(),s=[];for(let l=t[i];l<r;l++)s.push(o);e[i]=e[i].append(v.from(s))}return{height:e.length,width:r,rows:e}}function _u(n,e){const t=n.createAndFill();return new Sx(t).replace(0,t.content.size,e).doc}function Px({width:n,height:e,rows:t},r,i){if(n!=r){const o=[],s=[];for(let l=0;l<t.length;l++){const a=t[l],u=[];for(let c=o[l]||0,f=0;c<r;f++){let d=a.child(f%a.childCount);c+d.attrs.colspan>r&&(d=d.type.createChecked(Zr(d.attrs,d.attrs.colspan,c+d.attrs.colspan-r),d.content)),u.push(d),c+=d.attrs.colspan;for(let p=1;p<d.attrs.rowspan;p++)o[l+p]=(o[l+p]||0)+d.attrs.colspan}s.push(v.from(u))}t=s,n=r}if(e!=i){const o=[];for(let s=0,l=0;s<i;s++,l++){const a=[],u=t[l%e];for(let c=0;c<u.childCount;c++){let f=u.child(c);s+f.attrs.rowspan>i&&(f=f.type.create({...f.attrs,rowspan:Math.max(1,i-f.attrs.rowspan)},f.content)),a.push(f)}o.push(v.from(a))}t=o,e=i}return{width:n,height:e,rows:t}}function Fx(n,e,t,r,i,o,s){const l=n.doc.type.schema,a=zt(l);let u,c;if(i>e.width)for(let f=0,d=0;f<e.height;f++){const p=t.child(f);d+=p.nodeSize;const h=[];let m;p.lastChild==null||p.lastChild.type==a.cell?m=u||(u=a.cell.createAndFill()):m=c||(c=a.header_cell.createAndFill());for(let k=e.width;k<i;k++)h.push(m);n.insert(n.mapping.slice(s).map(d-1+r),h)}if(o>e.height){const f=[];for(let h=0,m=(e.height-1)*e.width;h<Math.max(e.width,i);h++){const k=h>=e.width?!1:t.nodeAt(e.map[m+h]).type==a.header_cell;f.push(k?c||(c=a.header_cell.createAndFill()):u||(u=a.cell.createAndFill()))}const d=a.row.create(null,v.from(f)),p=[];for(let h=e.height;h<o;h++)p.push(d);n.insert(n.mapping.slice(s).map(r+t.nodeSize-2),p)}return!!(u||c)}function Oh(n,e,t,r,i,o,s,l){if(s==0||s==e.height)return!1;let a=!1;for(let u=i;u<o;u++){const c=s*e.width+u,f=e.map[c];if(e.map[c-e.width]==f){a=!0;const d=t.nodeAt(f),{top:p,left:h}=e.findCell(f);n.setNodeMarkup(n.mapping.slice(l).map(f+r),null,{...d.attrs,rowspan:s-p}),n.insert(n.mapping.slice(l).map(e.positionAt(s,h,t)),d.type.createAndFill({...d.attrs,rowspan:p+d.attrs.rowspan-s})),u+=d.attrs.colspan-1}}return a}function Dh(n,e,t,r,i,o,s,l){if(s==0||s==e.width)return!1;let a=!1;for(let u=i;u<o;u++){const c=u*e.width+s,f=e.map[c];if(e.map[c-1]==f){a=!0;const d=t.nodeAt(f),p=e.colCount(f),h=n.mapping.slice(l).map(f+r);n.setNodeMarkup(h,null,Zr(d.attrs,s-p,d.attrs.colspan-(s-p))),n.insert(h+d.nodeSize,d.type.createAndFill(Zr(d.attrs,0,s-p))),u+=d.attrs.rowspan-1}}return a}function Th(n,e,t,r,i){let o=t?n.doc.nodeAt(t-1):n.doc;if(!o)throw new Error("No table found");let s=re.get(o);const{top:l,left:a}=r,u=a+i.width,c=l+i.height,f=n.tr;let d=0;function p(){if(o=t?f.doc.nodeAt(t-1):f.doc,!o)throw new Error("No table found");s=re.get(o),d=f.mapping.maps.length}Fx(f,s,o,t,u,c,d)&&p(),Oh(f,s,o,t,a,u,l,d)&&p(),Oh(f,s,o,t,a,u,c,d)&&p(),Dh(f,s,o,t,l,c,a,d)&&p(),Dh(f,s,o,t,l,c,u,d)&&p();for(let h=l;h<c;h++){const m=s.positionAt(h,a,o),k=s.positionAt(h,u,o);f.replace(f.mapping.slice(d).map(m+t),f.mapping.slice(d).map(k+t),new w(i.rows[h-l],0,0))}p(),f.setSelection(new ce(f.doc.resolve(t+s.positionAt(l,a,o)),f.doc.resolve(t+s.positionAt(c-1,u-1,o)))),e(f)}var Lx=Gv({ArrowLeft:us("horiz",-1),ArrowRight:us("horiz",1),ArrowUp:us("vert",-1),ArrowDown:us("vert",1),"Shift-ArrowLeft":cs("horiz",-1),"Shift-ArrowRight":cs("horiz",1),"Shift-ArrowUp":cs("vert",-1),"Shift-ArrowDown":cs("vert",1),Backspace:fs,"Mod-Backspace":fs,Delete:fs,"Mod-Delete":fs});function Ks(n,e,t){return t.eq(n.selection)?!1:(e&&e(n.tr.setSelection(t).scrollIntoView()),!0)}function us(n,e){return(t,r,i)=>{if(!i)return!1;const o=t.selection;if(o instanceof ce)return Ks(t,r,P.near(o.$headCell,e));if(n!="horiz"&&!o.empty)return!1;const s=yy(i,n,e);if(s==null)return!1;if(n=="horiz")return Ks(t,r,P.near(t.doc.resolve(o.head+e),e));{const l=t.doc.resolve(s),a=py(l,n,e);let u;return a?u=P.near(a,1):e<0?u=P.near(t.doc.resolve(l.before(-1)),-1):u=P.near(t.doc.resolve(l.after(-1)),1),Ks(t,r,u)}}}function cs(n,e){return(t,r,i)=>{if(!i)return!1;const o=t.selection;let s;if(o instanceof ce)s=o;else{const a=yy(i,n,e);if(a==null)return!1;s=new ce(t.doc.resolve(a))}const l=py(s.$headCell,n,e);return l?Ks(t,r,new ce(s.$anchorCell,l)):!1}}function fs(n,e){const t=n.selection;if(!(t instanceof ce))return!1;if(e){const r=n.tr,i=zt(n.schema).cell.createAndFill().content;t.forEachCell((o,s)=>{o.content.eq(i)||r.replace(r.mapping.map(s+1),r.mapping.map(s+o.nodeSize-1),new w(i,0,0))}),r.docChanged&&e(r)}return!0}function $x(n,e){const t=n.state.doc,r=qo(t.resolve(e));return r?(n.dispatch(n.state.tr.setSelection(new ce(r))),!0):!1}function Bx(n,e,t){if(!gf(n.state))return!1;let r=bx(t);const i=n.state.selection;if(i instanceof ce){r||(r={width:1,height:1,rows:[v.from(_u(zt(n.state.schema).cell,t))]});const o=i.$anchorCell.node(-1),s=i.$anchorCell.start(-1),l=re.get(o).rectBetween(i.$anchorCell.pos-s,i.$headCell.pos-s);return r=Px(r,l.right-l.left,l.bottom-l.top),Th(n.state,n.dispatch,s,l,r),!0}else if(r){const o=hy(n.state),s=o.start(-1);return Th(n.state,n.dispatch,s,re.get(o.node(-1)).findCell(o.pos-s),r),!0}else return!1}function Vx(n,e){var t;if(e.ctrlKey||e.metaKey)return;const r=Rh(n,e.target);let i;if(e.shiftKey&&n.state.selection instanceof ce)o(n.state.selection.$anchorCell,e),e.preventDefault();else if(e.shiftKey&&r&&(i=qo(n.state.selection.$anchor))!=null&&((t=Ja(n,e))==null?void 0:t.pos)!=i.pos)o(i,e),e.preventDefault();else if(!r)return;function o(a,u){let c=Ja(n,u);const f=ln.getState(n.state)==null;if(!c||!yf(a,c))if(f)c=a;else return;const d=new ce(a,c);if(f||!n.state.selection.eq(d)){const p=n.state.tr.setSelection(d);f&&p.setMeta(ln,a.pos),n.dispatch(p)}}function s(){n.root.removeEventListener("mouseup",s),n.root.removeEventListener("dragstart",s),n.root.removeEventListener("mousemove",l),ln.getState(n.state)!=null&&n.dispatch(n.state.tr.setMeta(ln,-1))}function l(a){const u=a,c=ln.getState(n.state);let f;if(c!=null)f=n.state.doc.resolve(c);else if(Rh(n,u.target)!=r&&(f=Ja(n,e),!f))return s();f&&o(f,u)}n.root.addEventListener("mouseup",s),n.root.addEventListener("dragstart",s),n.root.addEventListener("mousemove",l)}function yy(n,e,t){if(!(n.state.selection instanceof $))return null;const{$head:r}=n.state.selection;for(let i=r.depth-1;i>=0;i--){const o=r.node(i);if((t<0?r.index(i):r.indexAfter(i))!=(t<0?0:o.childCount))return null;if(o.type.spec.tableRole=="cell"||o.type.spec.tableRole=="header_cell"){const l=r.before(i),a=e=="vert"?t>0?"down":"up":t>0?"right":"left";return n.endOfTextblock(a)?l:null}}return null}function Rh(n,e){for(;e&&e!=n.dom;e=e.parentNode)if(e.nodeName=="TD"||e.nodeName=="TH")return e;return null}function Ja(n,e){const t=n.posAtCoords({left:e.clientX,top:e.clientY});return t&&t?qo(n.state.doc.resolve(t.pos)):null}var Jx=class{constructor(n,e){this.node=n,this.cellMinWidth=e,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),Wu(n,this.colgroup,this.table,e),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(n){return n.type!=this.node.type?!1:(this.node=n,Wu(n,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(n){return n.type=="attributes"&&(n.target==this.table||this.colgroup.contains(n.target))}};function Wu(n,e,t,r,i,o){var s;let l=0,a=!0,u=e.firstChild;const c=n.firstChild;if(c){for(let f=0,d=0;f<c.childCount;f++){const{colspan:p,colwidth:h}=c.child(f).attrs;for(let m=0;m<p;m++,d++){const k=i==d?o:h&&h[m],g=k?k+"px":"";l+=k||r,k||(a=!1),u?(u.style.width!=g&&(u.style.width=g),u=u.nextSibling):e.appendChild(document.createElement("col")).style.width=g}}for(;u;){const f=u.nextSibling;(s=u.parentNode)==null||s.removeChild(u),u=f}a?(t.style.width=l+"px",t.style.minWidth=""):(t.style.width="",t.style.minWidth=l+"px")}}var st=new Ho("tableColumnResizing");function _x({handleWidth:n=5,cellMinWidth:e=25,View:t=Jx,lastColumnResizable:r=!0}={}){const i=new Ft({key:st,state:{init(o,s){return i.spec.props.nodeViews[zt(s.schema).table.name]=(l,a)=>new t(l,e,a),new Wx(-1,!1)},apply(o,s){return s.apply(o)}},props:{attributes:o=>{const s=st.getState(o);return s&&s.activeHandle>-1?{class:"resize-cursor"}:{}},handleDOMEvents:{mousemove:(o,s)=>{Ux(o,s,n,e,r)},mouseleave:o=>{Hx(o)},mousedown:(o,s)=>{jx(o,s,e)}},decorations:o=>{const s=st.getState(o);if(s&&s.activeHandle>-1)return Xx(o,s.activeHandle)},nodeViews:{}}});return i}var Wx=class qs{constructor(e,t){this.activeHandle=e,this.dragging=t}apply(e){const t=this,r=e.getMeta(st);if(r&&r.setHandle!=null)return new qs(r.setHandle,!1);if(r&&r.setDragging!==void 0)return new qs(t.activeHandle,r.setDragging);if(t.activeHandle>-1&&e.docChanged){let i=e.mapping.map(t.activeHandle,-1);return Ju(e.doc.resolve(i))||(i=-1),new qs(i,t.dragging)}return t}};function Ux(n,e,t,r,i){const o=st.getState(n.state);if(o&&!o.dragging){const s=qx(e.target);let l=-1;if(s){const{left:a,right:u}=s.getBoundingClientRect();e.clientX-a<=t?l=Ah(n,e,"left",t):u-e.clientX<=t&&(l=Ah(n,e,"right",t))}if(l!=o.activeHandle){if(!i&&l!==-1){const a=n.state.doc.resolve(l),u=a.node(-1),c=re.get(u),f=a.start(-1);if(c.colCount(a.pos-f)+a.nodeAfter.attrs.colspan-1==c.width-1)return}Sy(n,l)}}}function Hx(n){const e=st.getState(n.state);e&&e.activeHandle>-1&&!e.dragging&&Sy(n,-1)}function jx(n,e,t){var r;const i=(r=n.dom.ownerDocument.defaultView)!=null?r:window,o=st.getState(n.state);if(!o||o.activeHandle==-1||o.dragging)return!1;const s=n.state.doc.nodeAt(o.activeHandle),l=Kx(n,o.activeHandle,s.attrs);n.dispatch(n.state.tr.setMeta(st,{setDragging:{startX:e.clientX,startWidth:l}}));function a(c){i.removeEventListener("mouseup",a),i.removeEventListener("mousemove",u);const f=st.getState(n.state);f!=null&&f.dragging&&(Qx(n,f.activeHandle,Ih(f.dragging,c,t)),n.dispatch(n.state.tr.setMeta(st,{setDragging:null})))}function u(c){if(!c.which)return a(c);const f=st.getState(n.state);if(f&&f.dragging){const d=Ih(f.dragging,c,t);Yx(n,f.activeHandle,d,t)}}return i.addEventListener("mouseup",a),i.addEventListener("mousemove",u),e.preventDefault(),!0}function Kx(n,e,{colspan:t,colwidth:r}){const i=r&&r[r.length-1];if(i)return i;const o=n.domAtPos(e);let l=o.node.childNodes[o.offset].offsetWidth,a=t;if(r)for(let u=0;u<t;u++)r[u]&&(l-=r[u],a--);return l/a}function qx(n){for(;n&&n.nodeName!="TD"&&n.nodeName!="TH";)n=n.classList&&n.classList.contains("ProseMirror")?null:n.parentNode;return n}function Ah(n,e,t,r){const i=t=="right"?-r:r,o=n.posAtCoords({left:e.clientX+i,top:e.clientY});if(!o)return-1;const{pos:s}=o,l=qo(n.state.doc.resolve(s));if(!l)return-1;if(t=="right")return l.pos;const a=re.get(l.node(-1)),u=l.start(-1),c=a.map.indexOf(l.pos-u);return c%a.width==0?-1:u+a.map[c-1]}function Ih(n,e,t){const r=e.clientX-n.startX;return Math.max(t,n.startWidth+r)}function Sy(n,e){n.dispatch(n.state.tr.setMeta(st,{setHandle:e}))}function Qx(n,e,t){const r=n.state.doc.resolve(e),i=r.node(-1),o=re.get(i),s=r.start(-1),l=o.colCount(r.pos-s)+r.nodeAfter.attrs.colspan-1,a=n.state.tr;for(let u=0;u<o.height;u++){const c=u*o.width+l;if(u&&o.map[c]==o.map[c-o.width])continue;const f=o.map[c],d=i.nodeAt(f).attrs,p=d.colspan==1?0:l-o.colCount(f);if(d.colwidth&&d.colwidth[p]==t)continue;const h=d.colwidth?d.colwidth.slice():Gx(d.colspan);h[p]=t,a.setNodeMarkup(s+f,null,{...d,colwidth:h})}a.docChanged&&n.dispatch(a)}function Yx(n,e,t,r){const i=n.state.doc.resolve(e),o=i.node(-1),s=i.start(-1),l=re.get(o).colCount(i.pos-s)+i.nodeAfter.attrs.colspan-1;let a=n.domAtPos(i.start(-1)).node;for(;a&&a.nodeName!="TABLE";)a=a.parentNode;a&&Wu(o,a.firstChild,a,r,l,t)}function Gx(n){return Array(n).fill(0)}function Xx(n,e){const t=[],r=n.doc.resolve(e),i=r.node(-1);if(!i)return W.empty;const o=re.get(i),s=r.start(-1),l=o.colCount(r.pos-s)+r.nodeAfter.attrs.colspan;for(let a=0;a<o.height;a++){const u=l+a*o.width-1;if((l==o.width||o.map[u]!=o.map[u+1])&&(a==0||o.map[u]!=o.map[u-o.width])){const c=o.map[u],f=s+c+i.nodeAt(c).nodeSize-1,d=document.createElement("div");d.className="column-resize-handle",t.push(me.widget(f,d))}}return W.create(n.doc,t)}function ky(n){const e=n.selection,t=hy(n),r=t.node(-1),i=t.start(-1),o=re.get(r);return{...e instanceof ce?o.rectBetween(e.$anchorCell.pos-i,e.$headCell.pos-i):o.findCell(t.pos-i),tableStart:i,map:o,table:r}}function Zx(n){return function(e,t){if(!gf(e))return!1;if(t){const r=zt(e.schema),i=ky(e),o=e.tr,s=i.map.cellsInRect(n=="column"?{left:i.left,top:0,right:i.right,bottom:i.map.height}:n=="row"?{left:0,top:i.top,right:i.map.width,bottom:i.bottom}:i),l=s.map(a=>i.table.nodeAt(a));for(let a=0;a<s.length;a++)l[a].type==r.header_cell&&o.setNodeMarkup(i.tableStart+s[a],r.cell,l[a].attrs);if(o.steps.length==0)for(let a=0;a<s.length;a++)o.setNodeMarkup(i.tableStart+s[a],r.header_cell,l[a].attrs);t(o)}return!0}}function bh(n,e,t){const r=e.map.cellsInRect({left:0,top:0,right:n=="row"?e.map.width:1,bottom:n=="column"?e.map.height:1});for(let i=0;i<r.length;i++){const o=e.table.nodeAt(r[i]);if(o&&o.type!==t.header_cell)return!1}return!0}function Sf(n,e){return e=e||{useDeprecatedLogic:!1},e.useDeprecatedLogic?Zx(n):function(t,r){if(!gf(t))return!1;if(r){const i=zt(t.schema),o=ky(t),s=t.tr,l=bh("row",o,i),a=bh("column",o,i),c=(n==="column"?l:n==="row"?a:!1)?1:0,f=n=="column"?{left:0,top:c,right:1,bottom:o.map.height}:n=="row"?{left:c,top:0,right:o.map.width,bottom:1}:o,d=n=="column"?a?i.cell:i.header_cell:n=="row"?l?i.cell:i.header_cell:i.cell;o.map.cellsInRect(f).forEach(p=>{const h=p+o.tableStart,m=s.doc.nodeAt(h);m&&s.setNodeMarkup(h,d,m.attrs)}),r(s)}return!0}}Sf("row",{useDeprecatedLogic:!0});Sf("column",{useDeprecatedLogic:!0});Sf("cell",{useDeprecatedLogic:!0});function eC({allowTableNodeSelection:n=!1}={}){return new Ft({key:ln,state:{init(){return null},apply(e,t){const r=e.getMeta(ln);if(r!=null)return r==-1?null:r;if(t==null||!e.docChanged)return t;const{deleted:i,pos:o}=e.mapping.mapResult(t);return i?null:o}},props:{decorations:Ex,handleDOMEvents:{mousedown:Vx},createSelectionBetween(e){return ln.getState(e.state)!=null?e.state.selection:null},handleTripleClick:$x,handleKeyDown:Lx,handlePaste:Bx},appendTransaction(e,t,r){return Tx(r,Ax(r,t),n)}})}var wy={exports:{}},tt={},vy={exports:{}},xy={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(A,F){var L=A.length;A.push(F);e:for(;0<L;){var ee=L-1>>>1,ae=A[ee];if(0<i(ae,F))A[ee]=F,A[L]=ae,L=ee;else break e}}function t(A){return A.length===0?null:A[0]}function r(A){if(A.length===0)return null;var F=A[0],L=A.pop();if(L!==F){A[0]=L;e:for(var ee=0,ae=A.length,ts=ae>>>1;ee<ts;){var Pn=2*(ee+1)-1,da=A[Pn],Fn=Pn+1,ns=A[Fn];if(0>i(da,L))Fn<ae&&0>i(ns,da)?(A[ee]=ns,A[Fn]=L,ee=Fn):(A[ee]=da,A[Pn]=L,ee=Pn);else if(Fn<ae&&0>i(ns,L))A[ee]=ns,A[Fn]=L,ee=Fn;else break e}}return F}function i(A,F){var L=A.sortIndex-F.sortIndex;return L!==0?L:A.id-F.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var s=Date,l=s.now();n.unstable_now=function(){return s.now()-l}}var a=[],u=[],c=1,f=null,d=3,p=!1,h=!1,m=!1,k=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(A){for(var F=t(u);F!==null;){if(F.callback===null)r(u);else if(F.startTime<=A)r(u),F.sortIndex=F.expirationTime,e(a,F);else break;F=t(u)}}function x(A){if(m=!1,S(A),!h)if(t(a)!==null)h=!0,ca(M);else{var F=t(u);F!==null&&fa(x,F.startTime-A)}}function M(A,F){h=!1,m&&(m=!1,g(R),R=-1),p=!0;var L=d;try{for(S(F),f=t(a);f!==null&&(!(f.expirationTime>F)||A&&!ne());){var ee=f.callback;if(typeof ee=="function"){f.callback=null,d=f.priorityLevel;var ae=ee(f.expirationTime<=F);F=n.unstable_now(),typeof ae=="function"?f.callback=ae:f===t(a)&&r(a),S(F)}else r(a);f=t(a)}if(f!==null)var ts=!0;else{var Pn=t(u);Pn!==null&&fa(x,Pn.startTime-F),ts=!1}return ts}finally{f=null,d=L,p=!1}}var O=!1,D=null,R=-1,E=5,b=-1;function ne(){return!(n.unstable_now()-b<E)}function Lt(){if(D!==null){var A=n.unstable_now();b=A;var F=!0;try{F=D(!0,A)}finally{F?di():(O=!1,D=null)}}else O=!1}var di;if(typeof y=="function")di=function(){y(Lt)};else if(typeof MessageChannel<"u"){var md=new MessageChannel,H1=md.port2;md.port1.onmessage=Lt,di=function(){H1.postMessage(null)}}else di=function(){k(Lt,0)};function ca(A){D=A,O||(O=!0,di())}function fa(A,F){R=k(function(){A(n.unstable_now())},F)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(A){A.callback=null},n.unstable_continueExecution=function(){h||p||(h=!0,ca(M))},n.unstable_forceFrameRate=function(A){0>A||125<A?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<A?Math.floor(1e3/A):5},n.unstable_getCurrentPriorityLevel=function(){return d},n.unstable_getFirstCallbackNode=function(){return t(a)},n.unstable_next=function(A){switch(d){case 1:case 2:case 3:var F=3;break;default:F=d}var L=d;d=F;try{return A()}finally{d=L}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(A,F){switch(A){case 1:case 2:case 3:case 4:case 5:break;default:A=3}var L=d;d=A;try{return F()}finally{d=L}},n.unstable_scheduleCallback=function(A,F,L){var ee=n.unstable_now();switch(typeof L=="object"&&L!==null?(L=L.delay,L=typeof L=="number"&&0<L?ee+L:ee):L=ee,A){case 1:var ae=-1;break;case 2:ae=250;break;case 5:ae=1073741823;break;case 4:ae=1e4;break;default:ae=5e3}return ae=L+ae,A={id:c++,callback:F,priorityLevel:A,startTime:L,expirationTime:ae,sortIndex:-1},L>ee?(A.sortIndex=L,e(u,A),t(a)===null&&A===t(u)&&(m?(g(R),R=-1):m=!0,fa(x,L-ee))):(A.sortIndex=ae,e(a,A),h||p||(h=!0,ca(M))),A},n.unstable_shouldYield=ne,n.unstable_wrapCallback=function(A){var F=d;return function(){var L=d;d=F;try{return A.apply(this,arguments)}finally{d=L}}}})(xy);vy.exports=xy;var tC=vy.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cy=C,et=tC;function N(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Ny=new Set,xo={};function fr(n,e){ei(n,e),ei(n+"Capture",e)}function ei(n,e){for(xo[n]=e,n=0;n<e.length;n++)Ny.add(e[n])}var Qt=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Uu=Object.prototype.hasOwnProperty,nC=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,zh={},Ph={};function rC(n){return Uu.call(Ph,n)?!0:Uu.call(zh,n)?!1:nC.test(n)?Ph[n]=!0:(zh[n]=!0,!1)}function iC(n,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function oC(n,e,t,r){if(e===null||typeof e>"u"||iC(n,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function ze(n,e,t,r,i,o,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=o,this.removeEmptyString=s}var ye={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){ye[n]=new ze(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];ye[e]=new ze(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){ye[n]=new ze(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){ye[n]=new ze(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){ye[n]=new ze(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){ye[n]=new ze(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){ye[n]=new ze(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){ye[n]=new ze(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){ye[n]=new ze(n,5,!1,n.toLowerCase(),null,!1,!1)});var kf=/[\-:]([a-z])/g;function wf(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(kf,wf);ye[e]=new ze(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(kf,wf);ye[e]=new ze(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(kf,wf);ye[e]=new ze(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){ye[n]=new ze(n,1,!1,n.toLowerCase(),null,!1,!1)});ye.xlinkHref=new ze("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){ye[n]=new ze(n,1,!1,n.toLowerCase(),null,!0,!0)});function vf(n,e,t,r){var i=ye.hasOwnProperty(e)?ye[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(oC(e,t,i,r)&&(t=null),r||i===null?rC(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):i.mustUseProperty?n[i.propertyName]=t===null?i.type===3?!1:"":t:(e=i.attributeName,r=i.attributeNamespace,t===null?n.removeAttribute(e):(i=i.type,t=i===3||i===4&&t===!0?"":""+t,r?n.setAttributeNS(r,e,t):n.setAttribute(e,t))))}var Zt=Cy.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ds=Symbol.for("react.element"),Cr=Symbol.for("react.portal"),Nr=Symbol.for("react.fragment"),xf=Symbol.for("react.strict_mode"),Hu=Symbol.for("react.profiler"),My=Symbol.for("react.provider"),Ey=Symbol.for("react.context"),Cf=Symbol.for("react.forward_ref"),ju=Symbol.for("react.suspense"),Ku=Symbol.for("react.suspense_list"),Nf=Symbol.for("react.memo"),rn=Symbol.for("react.lazy"),Oy=Symbol.for("react.offscreen"),Fh=Symbol.iterator;function pi(n){return n===null||typeof n!="object"?null:(n=Fh&&n[Fh]||n["@@iterator"],typeof n=="function"?n:null)}var G=Object.assign,_a;function Hi(n){if(_a===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);_a=e&&e[1]||""}return`
`+_a+n}var Wa=!1;function Ua(n,e){if(!n||Wa)return"";Wa=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(n,[],e)}else{try{e.call()}catch(u){r=u}n.call(e.prototype)}else{try{throw Error()}catch(u){r=u}n()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),o=r.stack.split(`
`),s=i.length-1,l=o.length-1;1<=s&&0<=l&&i[s]!==o[l];)l--;for(;1<=s&&0<=l;s--,l--)if(i[s]!==o[l]){if(s!==1||l!==1)do if(s--,l--,0>l||i[s]!==o[l]){var a=`
`+i[s].replace(" at new "," at ");return n.displayName&&a.includes("<anonymous>")&&(a=a.replace("<anonymous>",n.displayName)),a}while(1<=s&&0<=l);break}}}finally{Wa=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?Hi(n):""}function sC(n){switch(n.tag){case 5:return Hi(n.type);case 16:return Hi("Lazy");case 13:return Hi("Suspense");case 19:return Hi("SuspenseList");case 0:case 2:case 15:return n=Ua(n.type,!1),n;case 11:return n=Ua(n.type.render,!1),n;case 1:return n=Ua(n.type,!0),n;default:return""}}function qu(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Nr:return"Fragment";case Cr:return"Portal";case Hu:return"Profiler";case xf:return"StrictMode";case ju:return"Suspense";case Ku:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case Ey:return(n.displayName||"Context")+".Consumer";case My:return(n._context.displayName||"Context")+".Provider";case Cf:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case Nf:return e=n.displayName||null,e!==null?e:qu(n.type)||"Memo";case rn:e=n._payload,n=n._init;try{return qu(n(e))}catch{}}return null}function lC(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return qu(e);case 8:return e===xf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function On(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Dy(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function aC(n){var e=Dy(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),r=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var i=t.get,o=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return i.call(this)},set:function(s){r=""+s,o.call(this,s)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function hs(n){n._valueTracker||(n._valueTracker=aC(n))}function Ty(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return n&&(r=Dy(n)?n.checked?"true":"false":n.value),n=r,n!==t?(e.setValue(n),!0):!1}function yl(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function Qu(n,e){var t=e.checked;return G({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function Lh(n,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=On(e.value!=null?e.value:t),n._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Ry(n,e){e=e.checked,e!=null&&vf(n,"checked",e,!1)}function Yu(n,e){Ry(n,e);var t=On(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(r==="submit"||r==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?Gu(n,e.type,t):e.hasOwnProperty("defaultValue")&&Gu(n,e.type,On(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function $h(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function Gu(n,e,t){(e!=="number"||yl(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var ji=Array.isArray;function $r(n,e,t,r){if(n=n.options,e){e={};for(var i=0;i<t.length;i++)e["$"+t[i]]=!0;for(t=0;t<n.length;t++)i=e.hasOwnProperty("$"+n[t].value),n[t].selected!==i&&(n[t].selected=i),i&&r&&(n[t].defaultSelected=!0)}else{for(t=""+On(t),e=null,i=0;i<n.length;i++){if(n[i].value===t){n[i].selected=!0,r&&(n[i].defaultSelected=!0);return}e!==null||n[i].disabled||(e=n[i])}e!==null&&(e.selected=!0)}}function Xu(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(N(91));return G({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function Bh(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(N(92));if(ji(t)){if(1<t.length)throw Error(N(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:On(t)}}function Ay(n,e){var t=On(e.value),r=On(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),r!=null&&(n.defaultValue=""+r)}function Vh(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function Iy(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Zu(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?Iy(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var ps,by=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,i){MSApp.execUnsafeLocalFunction(function(){return n(e,t,r,i)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(ps=ps||document.createElement("div"),ps.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ps.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function Co(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var eo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},uC=["Webkit","ms","Moz","O"];Object.keys(eo).forEach(function(n){uC.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),eo[e]=eo[n]})});function zy(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||eo.hasOwnProperty(n)&&eo[n]?(""+e).trim():e+"px"}function Py(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,i=zy(t,e[t],r);t==="float"&&(t="cssFloat"),r?n.setProperty(t,i):n[t]=i}}var cC=G({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ec(n,e){if(e){if(cC[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(N(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(N(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(N(61))}if(e.style!=null&&typeof e.style!="object")throw Error(N(62))}}function tc(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var nc=null;function Mf(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var rc=null,Br=null,Vr=null;function Jh(n){if(n=Go(n)){if(typeof rc!="function")throw Error(N(280));var e=n.stateNode;e&&(e=Gl(e),rc(n.stateNode,n.type,e))}}function Fy(n){Br?Vr?Vr.push(n):Vr=[n]:Br=n}function Ly(){if(Br){var n=Br,e=Vr;if(Vr=Br=null,Jh(n),e)for(n=0;n<e.length;n++)Jh(e[n])}}function $y(n,e){return n(e)}function By(){}var Ha=!1;function Vy(n,e,t){if(Ha)return n(e,t);Ha=!0;try{return $y(n,e,t)}finally{Ha=!1,(Br!==null||Vr!==null)&&(By(),Ly())}}function No(n,e){var t=n.stateNode;if(t===null)return null;var r=Gl(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(n=n.type,r=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!r;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(N(231,e,typeof t));return t}var ic=!1;if(Qt)try{var mi={};Object.defineProperty(mi,"passive",{get:function(){ic=!0}}),window.addEventListener("test",mi,mi),window.removeEventListener("test",mi,mi)}catch{ic=!1}function fC(n,e,t,r,i,o,s,l,a){var u=Array.prototype.slice.call(arguments,3);try{e.apply(t,u)}catch(c){this.onError(c)}}var to=!1,Sl=null,kl=!1,oc=null,dC={onError:function(n){to=!0,Sl=n}};function hC(n,e,t,r,i,o,s,l,a){to=!1,Sl=null,fC.apply(dC,arguments)}function pC(n,e,t,r,i,o,s,l,a){if(hC.apply(this,arguments),to){if(to){var u=Sl;to=!1,Sl=null}else throw Error(N(198));kl||(kl=!0,oc=u)}}function dr(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function Jy(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function _h(n){if(dr(n)!==n)throw Error(N(188))}function mC(n){var e=n.alternate;if(!e){if(e=dr(n),e===null)throw Error(N(188));return e!==n?null:n}for(var t=n,r=e;;){var i=t.return;if(i===null)break;var o=i.alternate;if(o===null){if(r=i.return,r!==null){t=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===t)return _h(i),n;if(o===r)return _h(i),e;o=o.sibling}throw Error(N(188))}if(t.return!==r.return)t=i,r=o;else{for(var s=!1,l=i.child;l;){if(l===t){s=!0,t=i,r=o;break}if(l===r){s=!0,r=i,t=o;break}l=l.sibling}if(!s){for(l=o.child;l;){if(l===t){s=!0,t=o,r=i;break}if(l===r){s=!0,r=o,t=i;break}l=l.sibling}if(!s)throw Error(N(189))}}if(t.alternate!==r)throw Error(N(190))}if(t.tag!==3)throw Error(N(188));return t.stateNode.current===t?n:e}function _y(n){return n=mC(n),n!==null?Wy(n):null}function Wy(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=Wy(n);if(e!==null)return e;n=n.sibling}return null}var Uy=et.unstable_scheduleCallback,Wh=et.unstable_cancelCallback,gC=et.unstable_shouldYield,yC=et.unstable_requestPaint,te=et.unstable_now,SC=et.unstable_getCurrentPriorityLevel,Ef=et.unstable_ImmediatePriority,Hy=et.unstable_UserBlockingPriority,wl=et.unstable_NormalPriority,kC=et.unstable_LowPriority,jy=et.unstable_IdlePriority,Kl=null,Tt=null;function wC(n){if(Tt&&typeof Tt.onCommitFiberRoot=="function")try{Tt.onCommitFiberRoot(Kl,n,void 0,(n.current.flags&128)===128)}catch{}}var St=Math.clz32?Math.clz32:CC,vC=Math.log,xC=Math.LN2;function CC(n){return n>>>=0,n===0?32:31-(vC(n)/xC|0)|0}var ms=64,gs=4194304;function Ki(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function vl(n,e){var t=n.pendingLanes;if(t===0)return 0;var r=0,i=n.suspendedLanes,o=n.pingedLanes,s=t&268435455;if(s!==0){var l=s&~i;l!==0?r=Ki(l):(o&=s,o!==0&&(r=Ki(o)))}else s=t&~i,s!==0?r=Ki(s):o!==0&&(r=Ki(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,o=e&-e,i>=o||i===16&&(o&4194240)!==0))return e;if(r&4&&(r|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=r;0<e;)t=31-St(e),i=1<<t,r|=n[t],e&=~i;return r}function NC(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function MC(n,e){for(var t=n.suspendedLanes,r=n.pingedLanes,i=n.expirationTimes,o=n.pendingLanes;0<o;){var s=31-St(o),l=1<<s,a=i[s];a===-1?(!(l&t)||l&r)&&(i[s]=NC(l,e)):a<=e&&(n.expiredLanes|=l),o&=~l}}function sc(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function Ky(){var n=ms;return ms<<=1,!(ms&4194240)&&(ms=64),n}function ja(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function Qo(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-St(e),n[e]=t}function EC(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var r=n.eventTimes;for(n=n.expirationTimes;0<t;){var i=31-St(t),o=1<<i;e[i]=0,r[i]=-1,n[i]=-1,t&=~o}}function Of(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var r=31-St(t),i=1<<r;i&e|n[r]&e&&(n[r]|=e),t&=~i}}var U=0;function qy(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var Qy,Df,Yy,Gy,Xy,lc=!1,ys=[],Sn=null,kn=null,wn=null,Mo=new Map,Eo=new Map,an=[],OC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Uh(n,e){switch(n){case"focusin":case"focusout":Sn=null;break;case"dragenter":case"dragleave":kn=null;break;case"mouseover":case"mouseout":wn=null;break;case"pointerover":case"pointerout":Mo.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Eo.delete(e.pointerId)}}function gi(n,e,t,r,i,o){return n===null||n.nativeEvent!==o?(n={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},e!==null&&(e=Go(e),e!==null&&Df(e)),n):(n.eventSystemFlags|=r,e=n.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),n)}function DC(n,e,t,r,i){switch(e){case"focusin":return Sn=gi(Sn,n,e,t,r,i),!0;case"dragenter":return kn=gi(kn,n,e,t,r,i),!0;case"mouseover":return wn=gi(wn,n,e,t,r,i),!0;case"pointerover":var o=i.pointerId;return Mo.set(o,gi(Mo.get(o)||null,n,e,t,r,i)),!0;case"gotpointercapture":return o=i.pointerId,Eo.set(o,gi(Eo.get(o)||null,n,e,t,r,i)),!0}return!1}function Zy(n){var e=Kn(n.target);if(e!==null){var t=dr(e);if(t!==null){if(e=t.tag,e===13){if(e=Jy(t),e!==null){n.blockedOn=e,Xy(n.priority,function(){Yy(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Qs(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=ac(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var r=new t.constructor(t.type,t);nc=r,t.target.dispatchEvent(r),nc=null}else return e=Go(t),e!==null&&Df(e),n.blockedOn=t,!1;e.shift()}return!0}function Hh(n,e,t){Qs(n)&&t.delete(e)}function TC(){lc=!1,Sn!==null&&Qs(Sn)&&(Sn=null),kn!==null&&Qs(kn)&&(kn=null),wn!==null&&Qs(wn)&&(wn=null),Mo.forEach(Hh),Eo.forEach(Hh)}function yi(n,e){n.blockedOn===e&&(n.blockedOn=null,lc||(lc=!0,et.unstable_scheduleCallback(et.unstable_NormalPriority,TC)))}function Oo(n){function e(i){return yi(i,n)}if(0<ys.length){yi(ys[0],n);for(var t=1;t<ys.length;t++){var r=ys[t];r.blockedOn===n&&(r.blockedOn=null)}}for(Sn!==null&&yi(Sn,n),kn!==null&&yi(kn,n),wn!==null&&yi(wn,n),Mo.forEach(e),Eo.forEach(e),t=0;t<an.length;t++)r=an[t],r.blockedOn===n&&(r.blockedOn=null);for(;0<an.length&&(t=an[0],t.blockedOn===null);)Zy(t),t.blockedOn===null&&an.shift()}var Jr=Zt.ReactCurrentBatchConfig,xl=!0;function RC(n,e,t,r){var i=U,o=Jr.transition;Jr.transition=null;try{U=1,Tf(n,e,t,r)}finally{U=i,Jr.transition=o}}function AC(n,e,t,r){var i=U,o=Jr.transition;Jr.transition=null;try{U=4,Tf(n,e,t,r)}finally{U=i,Jr.transition=o}}function Tf(n,e,t,r){if(xl){var i=ac(n,e,t,r);if(i===null)nu(n,e,r,Cl,t),Uh(n,r);else if(DC(i,n,e,t,r))r.stopPropagation();else if(Uh(n,r),e&4&&-1<OC.indexOf(n)){for(;i!==null;){var o=Go(i);if(o!==null&&Qy(o),o=ac(n,e,t,r),o===null&&nu(n,e,r,Cl,t),o===i)break;i=o}i!==null&&r.stopPropagation()}else nu(n,e,r,null,t)}}var Cl=null;function ac(n,e,t,r){if(Cl=null,n=Mf(r),n=Kn(n),n!==null)if(e=dr(n),e===null)n=null;else if(t=e.tag,t===13){if(n=Jy(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return Cl=n,null}function e0(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(SC()){case Ef:return 1;case Hy:return 4;case wl:case kC:return 16;case jy:return 536870912;default:return 16}default:return 16}}var pn=null,Rf=null,Ys=null;function t0(){if(Ys)return Ys;var n,e=Rf,t=e.length,r,i="value"in pn?pn.value:pn.textContent,o=i.length;for(n=0;n<t&&e[n]===i[n];n++);var s=t-n;for(r=1;r<=s&&e[t-r]===i[o-r];r++);return Ys=i.slice(n,1<r?1-r:void 0)}function Gs(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function Ss(){return!0}function jh(){return!1}function nt(n){function e(t,r,i,o,s){this._reactName=t,this._targetInst=i,this.type=r,this.nativeEvent=o,this.target=s,this.currentTarget=null;for(var l in n)n.hasOwnProperty(l)&&(t=n[l],this[l]=t?t(o):o[l]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Ss:jh,this.isPropagationStopped=jh,this}return G(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Ss)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Ss)},persist:function(){},isPersistent:Ss}),e}var ci={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Af=nt(ci),Yo=G({},ci,{view:0,detail:0}),IC=nt(Yo),Ka,qa,Si,ql=G({},Yo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:If,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Si&&(Si&&n.type==="mousemove"?(Ka=n.screenX-Si.screenX,qa=n.screenY-Si.screenY):qa=Ka=0,Si=n),Ka)},movementY:function(n){return"movementY"in n?n.movementY:qa}}),Kh=nt(ql),bC=G({},ql,{dataTransfer:0}),zC=nt(bC),PC=G({},Yo,{relatedTarget:0}),Qa=nt(PC),FC=G({},ci,{animationName:0,elapsedTime:0,pseudoElement:0}),LC=nt(FC),$C=G({},ci,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),BC=nt($C),VC=G({},ci,{data:0}),qh=nt(VC),JC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_C={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},WC={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function UC(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=WC[n])?!!e[n]:!1}function If(){return UC}var HC=G({},Yo,{key:function(n){if(n.key){var e=JC[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=Gs(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?_C[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:If,charCode:function(n){return n.type==="keypress"?Gs(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Gs(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),jC=nt(HC),KC=G({},ql,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Qh=nt(KC),qC=G({},Yo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:If}),QC=nt(qC),YC=G({},ci,{propertyName:0,elapsedTime:0,pseudoElement:0}),GC=nt(YC),XC=G({},ql,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),ZC=nt(XC),eN=[9,13,27,32],bf=Qt&&"CompositionEvent"in window,no=null;Qt&&"documentMode"in document&&(no=document.documentMode);var tN=Qt&&"TextEvent"in window&&!no,n0=Qt&&(!bf||no&&8<no&&11>=no),Yh=" ",Gh=!1;function r0(n,e){switch(n){case"keyup":return eN.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function i0(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Mr=!1;function nN(n,e){switch(n){case"compositionend":return i0(e);case"keypress":return e.which!==32?null:(Gh=!0,Yh);case"textInput":return n=e.data,n===Yh&&Gh?null:n;default:return null}}function rN(n,e){if(Mr)return n==="compositionend"||!bf&&r0(n,e)?(n=t0(),Ys=Rf=pn=null,Mr=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return n0&&e.locale!=="ko"?null:e.data;default:return null}}var iN={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Xh(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!iN[n.type]:e==="textarea"}function o0(n,e,t,r){Fy(r),e=Nl(e,"onChange"),0<e.length&&(t=new Af("onChange","change",null,t,r),n.push({event:t,listeners:e}))}var ro=null,Do=null;function oN(n){g0(n,0)}function Ql(n){var e=Dr(n);if(Ty(e))return n}function sN(n,e){if(n==="change")return e}var s0=!1;if(Qt){var Ya;if(Qt){var Ga="oninput"in document;if(!Ga){var Zh=document.createElement("div");Zh.setAttribute("oninput","return;"),Ga=typeof Zh.oninput=="function"}Ya=Ga}else Ya=!1;s0=Ya&&(!document.documentMode||9<document.documentMode)}function ep(){ro&&(ro.detachEvent("onpropertychange",l0),Do=ro=null)}function l0(n){if(n.propertyName==="value"&&Ql(Do)){var e=[];o0(e,Do,n,Mf(n)),Vy(oN,e)}}function lN(n,e,t){n==="focusin"?(ep(),ro=e,Do=t,ro.attachEvent("onpropertychange",l0)):n==="focusout"&&ep()}function aN(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Ql(Do)}function uN(n,e){if(n==="click")return Ql(e)}function cN(n,e){if(n==="input"||n==="change")return Ql(e)}function fN(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var vt=typeof Object.is=="function"?Object.is:fN;function To(n,e){if(vt(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var i=t[r];if(!Uu.call(e,i)||!vt(n[i],e[i]))return!1}return!0}function tp(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function np(n,e){var t=tp(n);n=0;for(var r;t;){if(t.nodeType===3){if(r=n+t.textContent.length,n<=e&&r>=e)return{node:t,offset:e-n};n=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=tp(t)}}function a0(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?a0(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function u0(){for(var n=window,e=yl();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=yl(n.document)}return e}function zf(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function dN(n){var e=u0(),t=n.focusedElem,r=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&a0(t.ownerDocument.documentElement,t)){if(r!==null&&zf(t)){if(e=r.start,n=r.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var i=t.textContent.length,o=Math.min(r.start,i);r=r.end===void 0?o:Math.min(r.end,i),!n.extend&&o>r&&(i=r,r=o,o=i),i=np(t,o);var s=np(t,r);i&&s&&(n.rangeCount!==1||n.anchorNode!==i.node||n.anchorOffset!==i.offset||n.focusNode!==s.node||n.focusOffset!==s.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),n.removeAllRanges(),o>r?(n.addRange(e),n.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var hN=Qt&&"documentMode"in document&&11>=document.documentMode,Er=null,uc=null,io=null,cc=!1;function rp(n,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;cc||Er==null||Er!==yl(r)||(r=Er,"selectionStart"in r&&zf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),io&&To(io,r)||(io=r,r=Nl(uc,"onSelect"),0<r.length&&(e=new Af("onSelect","select",null,e,t),n.push({event:e,listeners:r}),e.target=Er)))}function ks(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var Or={animationend:ks("Animation","AnimationEnd"),animationiteration:ks("Animation","AnimationIteration"),animationstart:ks("Animation","AnimationStart"),transitionend:ks("Transition","TransitionEnd")},Xa={},c0={};Qt&&(c0=document.createElement("div").style,"AnimationEvent"in window||(delete Or.animationend.animation,delete Or.animationiteration.animation,delete Or.animationstart.animation),"TransitionEvent"in window||delete Or.transitionend.transition);function Yl(n){if(Xa[n])return Xa[n];if(!Or[n])return n;var e=Or[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in c0)return Xa[n]=e[t];return n}var f0=Yl("animationend"),d0=Yl("animationiteration"),h0=Yl("animationstart"),p0=Yl("transitionend"),m0=new Map,ip="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function An(n,e){m0.set(n,e),fr(e,[n])}for(var Za=0;Za<ip.length;Za++){var eu=ip[Za],pN=eu.toLowerCase(),mN=eu[0].toUpperCase()+eu.slice(1);An(pN,"on"+mN)}An(f0,"onAnimationEnd");An(d0,"onAnimationIteration");An(h0,"onAnimationStart");An("dblclick","onDoubleClick");An("focusin","onFocus");An("focusout","onBlur");An(p0,"onTransitionEnd");ei("onMouseEnter",["mouseout","mouseover"]);ei("onMouseLeave",["mouseout","mouseover"]);ei("onPointerEnter",["pointerout","pointerover"]);ei("onPointerLeave",["pointerout","pointerover"]);fr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fr("onBeforeInput",["compositionend","keypress","textInput","paste"]);fr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var qi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),gN=new Set("cancel close invalid load scroll toggle".split(" ").concat(qi));function op(n,e,t){var r=n.type||"unknown-event";n.currentTarget=t,pC(r,e,void 0,n),n.currentTarget=null}function g0(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var r=n[t],i=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var s=r.length-1;0<=s;s--){var l=r[s],a=l.instance,u=l.currentTarget;if(l=l.listener,a!==o&&i.isPropagationStopped())break e;op(i,l,u),o=a}else for(s=0;s<r.length;s++){if(l=r[s],a=l.instance,u=l.currentTarget,l=l.listener,a!==o&&i.isPropagationStopped())break e;op(i,l,u),o=a}}}if(kl)throw n=oc,kl=!1,oc=null,n}function j(n,e){var t=e[mc];t===void 0&&(t=e[mc]=new Set);var r=n+"__bubble";t.has(r)||(y0(e,n,2,!1),t.add(r))}function tu(n,e,t){var r=0;e&&(r|=4),y0(t,n,r,e)}var ws="_reactListening"+Math.random().toString(36).slice(2);function Ro(n){if(!n[ws]){n[ws]=!0,Ny.forEach(function(t){t!=="selectionchange"&&(gN.has(t)||tu(t,!1,n),tu(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[ws]||(e[ws]=!0,tu("selectionchange",!1,e))}}function y0(n,e,t,r){switch(e0(e)){case 1:var i=RC;break;case 4:i=AC;break;default:i=Tf}t=i.bind(null,e,t,n),i=void 0,!ic||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?n.addEventListener(e,t,{capture:!0,passive:i}):n.addEventListener(e,t,!0):i!==void 0?n.addEventListener(e,t,{passive:i}):n.addEventListener(e,t,!1)}function nu(n,e,t,r,i){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(s===4)for(s=r.return;s!==null;){var a=s.tag;if((a===3||a===4)&&(a=s.stateNode.containerInfo,a===i||a.nodeType===8&&a.parentNode===i))return;s=s.return}for(;l!==null;){if(s=Kn(l),s===null)return;if(a=s.tag,a===5||a===6){r=o=s;continue e}l=l.parentNode}}r=r.return}Vy(function(){var u=o,c=Mf(t),f=[];e:{var d=m0.get(n);if(d!==void 0){var p=Af,h=n;switch(n){case"keypress":if(Gs(t)===0)break e;case"keydown":case"keyup":p=jC;break;case"focusin":h="focus",p=Qa;break;case"focusout":h="blur",p=Qa;break;case"beforeblur":case"afterblur":p=Qa;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=Kh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=zC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=QC;break;case f0:case d0:case h0:p=LC;break;case p0:p=GC;break;case"scroll":p=IC;break;case"wheel":p=ZC;break;case"copy":case"cut":case"paste":p=BC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Qh}var m=(e&4)!==0,k=!m&&n==="scroll",g=m?d!==null?d+"Capture":null:d;m=[];for(var y=u,S;y!==null;){S=y;var x=S.stateNode;if(S.tag===5&&x!==null&&(S=x,g!==null&&(x=No(y,g),x!=null&&m.push(Ao(y,x,S)))),k)break;y=y.return}0<m.length&&(d=new p(d,h,null,t,c),f.push({event:d,listeners:m}))}}if(!(e&7)){e:{if(d=n==="mouseover"||n==="pointerover",p=n==="mouseout"||n==="pointerout",d&&t!==nc&&(h=t.relatedTarget||t.fromElement)&&(Kn(h)||h[Yt]))break e;if((p||d)&&(d=c.window===c?c:(d=c.ownerDocument)?d.defaultView||d.parentWindow:window,p?(h=t.relatedTarget||t.toElement,p=u,h=h?Kn(h):null,h!==null&&(k=dr(h),h!==k||h.tag!==5&&h.tag!==6)&&(h=null)):(p=null,h=u),p!==h)){if(m=Kh,x="onMouseLeave",g="onMouseEnter",y="mouse",(n==="pointerout"||n==="pointerover")&&(m=Qh,x="onPointerLeave",g="onPointerEnter",y="pointer"),k=p==null?d:Dr(p),S=h==null?d:Dr(h),d=new m(x,y+"leave",p,t,c),d.target=k,d.relatedTarget=S,x=null,Kn(c)===u&&(m=new m(g,y+"enter",h,t,c),m.target=S,m.relatedTarget=k,x=m),k=x,p&&h)t:{for(m=p,g=h,y=0,S=m;S;S=mr(S))y++;for(S=0,x=g;x;x=mr(x))S++;for(;0<y-S;)m=mr(m),y--;for(;0<S-y;)g=mr(g),S--;for(;y--;){if(m===g||g!==null&&m===g.alternate)break t;m=mr(m),g=mr(g)}m=null}else m=null;p!==null&&sp(f,d,p,m,!1),h!==null&&k!==null&&sp(f,k,h,m,!0)}}e:{if(d=u?Dr(u):window,p=d.nodeName&&d.nodeName.toLowerCase(),p==="select"||p==="input"&&d.type==="file")var M=sN;else if(Xh(d))if(s0)M=cN;else{M=aN;var O=lN}else(p=d.nodeName)&&p.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(M=uN);if(M&&(M=M(n,u))){o0(f,M,t,c);break e}O&&O(n,d,u),n==="focusout"&&(O=d._wrapperState)&&O.controlled&&d.type==="number"&&Gu(d,"number",d.value)}switch(O=u?Dr(u):window,n){case"focusin":(Xh(O)||O.contentEditable==="true")&&(Er=O,uc=u,io=null);break;case"focusout":io=uc=Er=null;break;case"mousedown":cc=!0;break;case"contextmenu":case"mouseup":case"dragend":cc=!1,rp(f,t,c);break;case"selectionchange":if(hN)break;case"keydown":case"keyup":rp(f,t,c)}var D;if(bf)e:{switch(n){case"compositionstart":var R="onCompositionStart";break e;case"compositionend":R="onCompositionEnd";break e;case"compositionupdate":R="onCompositionUpdate";break e}R=void 0}else Mr?r0(n,t)&&(R="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(R="onCompositionStart");R&&(n0&&t.locale!=="ko"&&(Mr||R!=="onCompositionStart"?R==="onCompositionEnd"&&Mr&&(D=t0()):(pn=c,Rf="value"in pn?pn.value:pn.textContent,Mr=!0)),O=Nl(u,R),0<O.length&&(R=new qh(R,n,null,t,c),f.push({event:R,listeners:O}),D?R.data=D:(D=i0(t),D!==null&&(R.data=D)))),(D=tN?nN(n,t):rN(n,t))&&(u=Nl(u,"onBeforeInput"),0<u.length&&(c=new qh("onBeforeInput","beforeinput",null,t,c),f.push({event:c,listeners:u}),c.data=D))}g0(f,e)})}function Ao(n,e,t){return{instance:n,listener:e,currentTarget:t}}function Nl(n,e){for(var t=e+"Capture",r=[];n!==null;){var i=n,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=No(n,t),o!=null&&r.unshift(Ao(n,o,i)),o=No(n,e),o!=null&&r.push(Ao(n,o,i))),n=n.return}return r}function mr(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function sp(n,e,t,r,i){for(var o=e._reactName,s=[];t!==null&&t!==r;){var l=t,a=l.alternate,u=l.stateNode;if(a!==null&&a===r)break;l.tag===5&&u!==null&&(l=u,i?(a=No(t,o),a!=null&&s.unshift(Ao(t,a,l))):i||(a=No(t,o),a!=null&&s.push(Ao(t,a,l)))),t=t.return}s.length!==0&&n.push({event:e,listeners:s})}var yN=/\r\n?/g,SN=/\u0000|\uFFFD/g;function lp(n){return(typeof n=="string"?n:""+n).replace(yN,`
`).replace(SN,"")}function vs(n,e,t){if(e=lp(e),lp(n)!==e&&t)throw Error(N(425))}function Ml(){}var fc=null,dc=null;function hc(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var pc=typeof setTimeout=="function"?setTimeout:void 0,kN=typeof clearTimeout=="function"?clearTimeout:void 0,ap=typeof Promise=="function"?Promise:void 0,wN=typeof queueMicrotask=="function"?queueMicrotask:typeof ap<"u"?function(n){return ap.resolve(null).then(n).catch(vN)}:pc;function vN(n){setTimeout(function(){throw n})}function ru(n,e){var t=e,r=0;do{var i=t.nextSibling;if(n.removeChild(t),i&&i.nodeType===8)if(t=i.data,t==="/$"){if(r===0){n.removeChild(i),Oo(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=i}while(t);Oo(e)}function vn(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function up(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var fi=Math.random().toString(36).slice(2),Mt="__reactFiber$"+fi,Io="__reactProps$"+fi,Yt="__reactContainer$"+fi,mc="__reactEvents$"+fi,xN="__reactListeners$"+fi,CN="__reactHandles$"+fi;function Kn(n){var e=n[Mt];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Yt]||t[Mt]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=up(n);n!==null;){if(t=n[Mt])return t;n=up(n)}return e}n=t,t=n.parentNode}return null}function Go(n){return n=n[Mt]||n[Yt],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Dr(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(N(33))}function Gl(n){return n[Io]||null}var gc=[],Tr=-1;function In(n){return{current:n}}function K(n){0>Tr||(n.current=gc[Tr],gc[Tr]=null,Tr--)}function H(n,e){Tr++,gc[Tr]=n.current,n.current=e}var Dn={},Ne=In(Dn),_e=In(!1),ir=Dn;function ti(n,e){var t=n.type.contextTypes;if(!t)return Dn;var r=n.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in t)i[o]=e[o];return r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=i),i}function We(n){return n=n.childContextTypes,n!=null}function El(){K(_e),K(Ne)}function cp(n,e,t){if(Ne.current!==Dn)throw Error(N(168));H(Ne,e),H(_e,t)}function S0(n,e,t){var r=n.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(N(108,lC(n)||"Unknown",i));return G({},t,r)}function Ol(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Dn,ir=Ne.current,H(Ne,n),H(_e,_e.current),!0}function fp(n,e,t){var r=n.stateNode;if(!r)throw Error(N(169));t?(n=S0(n,e,ir),r.__reactInternalMemoizedMergedChildContext=n,K(_e),K(Ne),H(Ne,n)):K(_e),H(_e,t)}var Wt=null,Xl=!1,iu=!1;function k0(n){Wt===null?Wt=[n]:Wt.push(n)}function NN(n){Xl=!0,k0(n)}function bn(){if(!iu&&Wt!==null){iu=!0;var n=0,e=U;try{var t=Wt;for(U=1;n<t.length;n++){var r=t[n];do r=r(!0);while(r!==null)}Wt=null,Xl=!1}catch(i){throw Wt!==null&&(Wt=Wt.slice(n+1)),Uy(Ef,bn),i}finally{U=e,iu=!1}}return null}var Rr=[],Ar=0,Dl=null,Tl=0,it=[],ot=0,or=null,Ht=1,jt="";function Jn(n,e){Rr[Ar++]=Tl,Rr[Ar++]=Dl,Dl=n,Tl=e}function w0(n,e,t){it[ot++]=Ht,it[ot++]=jt,it[ot++]=or,or=n;var r=Ht;n=jt;var i=32-St(r)-1;r&=~(1<<i),t+=1;var o=32-St(e)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,Ht=1<<32-St(e)+i|t<<i|r,jt=o+n}else Ht=1<<o|t<<i|r,jt=n}function Pf(n){n.return!==null&&(Jn(n,1),w0(n,1,0))}function Ff(n){for(;n===Dl;)Dl=Rr[--Ar],Rr[Ar]=null,Tl=Rr[--Ar],Rr[Ar]=null;for(;n===or;)or=it[--ot],it[ot]=null,jt=it[--ot],it[ot]=null,Ht=it[--ot],it[ot]=null}var Ze=null,Ge=null,q=!1,yt=null;function v0(n,e){var t=lt(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function dp(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Ze=n,Ge=vn(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Ze=n,Ge=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=or!==null?{id:Ht,overflow:jt}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=lt(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,Ze=n,Ge=null,!0):!1;default:return!1}}function yc(n){return(n.mode&1)!==0&&(n.flags&128)===0}function Sc(n){if(q){var e=Ge;if(e){var t=e;if(!dp(n,e)){if(yc(n))throw Error(N(418));e=vn(t.nextSibling);var r=Ze;e&&dp(n,e)?v0(r,t):(n.flags=n.flags&-4097|2,q=!1,Ze=n)}}else{if(yc(n))throw Error(N(418));n.flags=n.flags&-4097|2,q=!1,Ze=n}}}function hp(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Ze=n}function xs(n){if(n!==Ze)return!1;if(!q)return hp(n),q=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!hc(n.type,n.memoizedProps)),e&&(e=Ge)){if(yc(n))throw x0(),Error(N(418));for(;e;)v0(n,e),e=vn(e.nextSibling)}if(hp(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(N(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){Ge=vn(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}Ge=null}}else Ge=Ze?vn(n.stateNode.nextSibling):null;return!0}function x0(){for(var n=Ge;n;)n=vn(n.nextSibling)}function ni(){Ge=Ze=null,q=!1}function Lf(n){yt===null?yt=[n]:yt.push(n)}var MN=Zt.ReactCurrentBatchConfig;function pt(n,e){if(n&&n.defaultProps){e=G({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}var Rl=In(null),Al=null,Ir=null,$f=null;function Bf(){$f=Ir=Al=null}function Vf(n){var e=Rl.current;K(Rl),n._currentValue=e}function kc(n,e,t){for(;n!==null;){var r=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),n===t)break;n=n.return}}function _r(n,e){Al=n,$f=Ir=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(Ve=!0),n.firstContext=null)}function ct(n){var e=n._currentValue;if($f!==n)if(n={context:n,memoizedValue:e,next:null},Ir===null){if(Al===null)throw Error(N(308));Ir=n,Al.dependencies={lanes:0,firstContext:n}}else Ir=Ir.next=n;return e}var qn=null;function Jf(n){qn===null?qn=[n]:qn.push(n)}function C0(n,e,t,r){var i=e.interleaved;return i===null?(t.next=t,Jf(e)):(t.next=i.next,i.next=t),e.interleaved=t,Gt(n,r)}function Gt(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var on=!1;function _f(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function N0(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function qt(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function xn(n,e,t){var r=n.updateQueue;if(r===null)return null;if(r=r.shared,V&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Gt(n,t)}return i=r.interleaved,i===null?(e.next=e,Jf(r)):(e.next=i.next,i.next=e),r.interleaved=e,Gt(n,t)}function Xs(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,Of(n,t)}}function pp(n,e){var t=n.updateQueue,r=n.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var i=null,o=null;if(t=t.firstBaseUpdate,t!==null){do{var s={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};o===null?i=o=s:o=o.next=s,t=t.next}while(t!==null);o===null?i=o=e:o=o.next=e}else i=o=e;t={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function Il(n,e,t,r){var i=n.updateQueue;on=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var a=l,u=a.next;a.next=null,s===null?o=u:s.next=u,s=a;var c=n.alternate;c!==null&&(c=c.updateQueue,l=c.lastBaseUpdate,l!==s&&(l===null?c.firstBaseUpdate=u:l.next=u,c.lastBaseUpdate=a))}if(o!==null){var f=i.baseState;s=0,c=u=a=null,l=o;do{var d=l.lane,p=l.eventTime;if((r&d)===d){c!==null&&(c=c.next={eventTime:p,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var h=n,m=l;switch(d=e,p=t,m.tag){case 1:if(h=m.payload,typeof h=="function"){f=h.call(p,f,d);break e}f=h;break e;case 3:h.flags=h.flags&-65537|128;case 0:if(h=m.payload,d=typeof h=="function"?h.call(p,f,d):h,d==null)break e;f=G({},f,d);break e;case 2:on=!0}}l.callback!==null&&l.lane!==0&&(n.flags|=64,d=i.effects,d===null?i.effects=[l]:d.push(l))}else p={eventTime:p,lane:d,tag:l.tag,payload:l.payload,callback:l.callback,next:null},c===null?(u=c=p,a=f):c=c.next=p,s|=d;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;d=l,l=d.next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}while(!0);if(c===null&&(a=f),i.baseState=a,i.firstBaseUpdate=u,i.lastBaseUpdate=c,e=i.shared.interleaved,e!==null){i=e;do s|=i.lane,i=i.next;while(i!==e)}else o===null&&(i.shared.lanes=0);lr|=s,n.lanes=s,n.memoizedState=f}}function mp(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var r=n[e],i=r.callback;if(i!==null){if(r.callback=null,r=t,typeof i!="function")throw Error(N(191,i));i.call(r)}}}var M0=new Cy.Component().refs;function wc(n,e,t,r){e=n.memoizedState,t=t(r,e),t=t==null?e:G({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var Zl={isMounted:function(n){return(n=n._reactInternals)?dr(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var r=Te(),i=Nn(n),o=qt(r,i);o.payload=e,t!=null&&(o.callback=t),e=xn(n,o,i),e!==null&&(kt(e,n,i,r),Xs(e,n,i))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var r=Te(),i=Nn(n),o=qt(r,i);o.tag=1,o.payload=e,t!=null&&(o.callback=t),e=xn(n,o,i),e!==null&&(kt(e,n,i,r),Xs(e,n,i))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=Te(),r=Nn(n),i=qt(t,r);i.tag=2,e!=null&&(i.callback=e),e=xn(n,i,r),e!==null&&(kt(e,n,r,t),Xs(e,n,r))}};function gp(n,e,t,r,i,o,s){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(r,o,s):e.prototype&&e.prototype.isPureReactComponent?!To(t,r)||!To(i,o):!0}function E0(n,e,t){var r=!1,i=Dn,o=e.contextType;return typeof o=="object"&&o!==null?o=ct(o):(i=We(e)?ir:Ne.current,r=e.contextTypes,o=(r=r!=null)?ti(n,i):Dn),e=new e(t,o),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Zl,n.stateNode=e,e._reactInternals=n,r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=o),e}function yp(n,e,t,r){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==n&&Zl.enqueueReplaceState(e,e.state,null)}function vc(n,e,t,r){var i=n.stateNode;i.props=t,i.state=n.memoizedState,i.refs=M0,_f(n);var o=e.contextType;typeof o=="object"&&o!==null?i.context=ct(o):(o=We(e)?ir:Ne.current,i.context=ti(n,o)),i.state=n.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(wc(n,e,o,t),i.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Zl.enqueueReplaceState(i,i.state,null),Il(n,t,i,r),i.state=n.memoizedState),typeof i.componentDidMount=="function"&&(n.flags|=4194308)}function ki(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(N(309));var r=t.stateNode}if(!r)throw Error(N(147,n));var i=r,o=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(s){var l=i.refs;l===M0&&(l=i.refs={}),s===null?delete l[o]:l[o]=s},e._stringRef=o,e)}if(typeof n!="string")throw Error(N(284));if(!t._owner)throw Error(N(290,n))}return n}function Cs(n,e){throw n=Object.prototype.toString.call(e),Error(N(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function Sp(n){var e=n._init;return e(n._payload)}function O0(n){function e(g,y){if(n){var S=g.deletions;S===null?(g.deletions=[y],g.flags|=16):S.push(y)}}function t(g,y){if(!n)return null;for(;y!==null;)e(g,y),y=y.sibling;return null}function r(g,y){for(g=new Map;y!==null;)y.key!==null?g.set(y.key,y):g.set(y.index,y),y=y.sibling;return g}function i(g,y){return g=Mn(g,y),g.index=0,g.sibling=null,g}function o(g,y,S){return g.index=S,n?(S=g.alternate,S!==null?(S=S.index,S<y?(g.flags|=2,y):S):(g.flags|=2,y)):(g.flags|=1048576,y)}function s(g){return n&&g.alternate===null&&(g.flags|=2),g}function l(g,y,S,x){return y===null||y.tag!==6?(y=fu(S,g.mode,x),y.return=g,y):(y=i(y,S),y.return=g,y)}function a(g,y,S,x){var M=S.type;return M===Nr?c(g,y,S.props.children,x,S.key):y!==null&&(y.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===rn&&Sp(M)===y.type)?(x=i(y,S.props),x.ref=ki(g,y,S),x.return=g,x):(x=il(S.type,S.key,S.props,null,g.mode,x),x.ref=ki(g,y,S),x.return=g,x)}function u(g,y,S,x){return y===null||y.tag!==4||y.stateNode.containerInfo!==S.containerInfo||y.stateNode.implementation!==S.implementation?(y=du(S,g.mode,x),y.return=g,y):(y=i(y,S.children||[]),y.return=g,y)}function c(g,y,S,x,M){return y===null||y.tag!==7?(y=tr(S,g.mode,x,M),y.return=g,y):(y=i(y,S),y.return=g,y)}function f(g,y,S){if(typeof y=="string"&&y!==""||typeof y=="number")return y=fu(""+y,g.mode,S),y.return=g,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case ds:return S=il(y.type,y.key,y.props,null,g.mode,S),S.ref=ki(g,null,y),S.return=g,S;case Cr:return y=du(y,g.mode,S),y.return=g,y;case rn:var x=y._init;return f(g,x(y._payload),S)}if(ji(y)||pi(y))return y=tr(y,g.mode,S,null),y.return=g,y;Cs(g,y)}return null}function d(g,y,S,x){var M=y!==null?y.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return M!==null?null:l(g,y,""+S,x);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case ds:return S.key===M?a(g,y,S,x):null;case Cr:return S.key===M?u(g,y,S,x):null;case rn:return M=S._init,d(g,y,M(S._payload),x)}if(ji(S)||pi(S))return M!==null?null:c(g,y,S,x,null);Cs(g,S)}return null}function p(g,y,S,x,M){if(typeof x=="string"&&x!==""||typeof x=="number")return g=g.get(S)||null,l(y,g,""+x,M);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case ds:return g=g.get(x.key===null?S:x.key)||null,a(y,g,x,M);case Cr:return g=g.get(x.key===null?S:x.key)||null,u(y,g,x,M);case rn:var O=x._init;return p(g,y,S,O(x._payload),M)}if(ji(x)||pi(x))return g=g.get(S)||null,c(y,g,x,M,null);Cs(y,x)}return null}function h(g,y,S,x){for(var M=null,O=null,D=y,R=y=0,E=null;D!==null&&R<S.length;R++){D.index>R?(E=D,D=null):E=D.sibling;var b=d(g,D,S[R],x);if(b===null){D===null&&(D=E);break}n&&D&&b.alternate===null&&e(g,D),y=o(b,y,R),O===null?M=b:O.sibling=b,O=b,D=E}if(R===S.length)return t(g,D),q&&Jn(g,R),M;if(D===null){for(;R<S.length;R++)D=f(g,S[R],x),D!==null&&(y=o(D,y,R),O===null?M=D:O.sibling=D,O=D);return q&&Jn(g,R),M}for(D=r(g,D);R<S.length;R++)E=p(D,g,R,S[R],x),E!==null&&(n&&E.alternate!==null&&D.delete(E.key===null?R:E.key),y=o(E,y,R),O===null?M=E:O.sibling=E,O=E);return n&&D.forEach(function(ne){return e(g,ne)}),q&&Jn(g,R),M}function m(g,y,S,x){var M=pi(S);if(typeof M!="function")throw Error(N(150));if(S=M.call(S),S==null)throw Error(N(151));for(var O=M=null,D=y,R=y=0,E=null,b=S.next();D!==null&&!b.done;R++,b=S.next()){D.index>R?(E=D,D=null):E=D.sibling;var ne=d(g,D,b.value,x);if(ne===null){D===null&&(D=E);break}n&&D&&ne.alternate===null&&e(g,D),y=o(ne,y,R),O===null?M=ne:O.sibling=ne,O=ne,D=E}if(b.done)return t(g,D),q&&Jn(g,R),M;if(D===null){for(;!b.done;R++,b=S.next())b=f(g,b.value,x),b!==null&&(y=o(b,y,R),O===null?M=b:O.sibling=b,O=b);return q&&Jn(g,R),M}for(D=r(g,D);!b.done;R++,b=S.next())b=p(D,g,R,b.value,x),b!==null&&(n&&b.alternate!==null&&D.delete(b.key===null?R:b.key),y=o(b,y,R),O===null?M=b:O.sibling=b,O=b);return n&&D.forEach(function(Lt){return e(g,Lt)}),q&&Jn(g,R),M}function k(g,y,S,x){if(typeof S=="object"&&S!==null&&S.type===Nr&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case ds:e:{for(var M=S.key,O=y;O!==null;){if(O.key===M){if(M=S.type,M===Nr){if(O.tag===7){t(g,O.sibling),y=i(O,S.props.children),y.return=g,g=y;break e}}else if(O.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===rn&&Sp(M)===O.type){t(g,O.sibling),y=i(O,S.props),y.ref=ki(g,O,S),y.return=g,g=y;break e}t(g,O);break}else e(g,O);O=O.sibling}S.type===Nr?(y=tr(S.props.children,g.mode,x,S.key),y.return=g,g=y):(x=il(S.type,S.key,S.props,null,g.mode,x),x.ref=ki(g,y,S),x.return=g,g=x)}return s(g);case Cr:e:{for(O=S.key;y!==null;){if(y.key===O)if(y.tag===4&&y.stateNode.containerInfo===S.containerInfo&&y.stateNode.implementation===S.implementation){t(g,y.sibling),y=i(y,S.children||[]),y.return=g,g=y;break e}else{t(g,y);break}else e(g,y);y=y.sibling}y=du(S,g.mode,x),y.return=g,g=y}return s(g);case rn:return O=S._init,k(g,y,O(S._payload),x)}if(ji(S))return h(g,y,S,x);if(pi(S))return m(g,y,S,x);Cs(g,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,y!==null&&y.tag===6?(t(g,y.sibling),y=i(y,S),y.return=g,g=y):(t(g,y),y=fu(S,g.mode,x),y.return=g,g=y),s(g)):t(g,y)}return k}var ri=O0(!0),D0=O0(!1),Xo={},Rt=In(Xo),bo=In(Xo),zo=In(Xo);function Qn(n){if(n===Xo)throw Error(N(174));return n}function Wf(n,e){switch(H(zo,e),H(bo,n),H(Rt,Xo),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Zu(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=Zu(e,n)}K(Rt),H(Rt,e)}function ii(){K(Rt),K(bo),K(zo)}function T0(n){Qn(zo.current);var e=Qn(Rt.current),t=Zu(e,n.type);e!==t&&(H(bo,n),H(Rt,t))}function Uf(n){bo.current===n&&(K(Rt),K(bo))}var Q=In(0);function bl(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var ou=[];function Hf(){for(var n=0;n<ou.length;n++)ou[n]._workInProgressVersionPrimary=null;ou.length=0}var Zs=Zt.ReactCurrentDispatcher,su=Zt.ReactCurrentBatchConfig,sr=0,Y=null,se=null,ue=null,zl=!1,oo=!1,Po=0,EN=0;function Se(){throw Error(N(321))}function jf(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!vt(n[t],e[t]))return!1;return!0}function Kf(n,e,t,r,i,o){if(sr=o,Y=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Zs.current=n===null||n.memoizedState===null?RN:AN,n=t(r,i),oo){o=0;do{if(oo=!1,Po=0,25<=o)throw Error(N(301));o+=1,ue=se=null,e.updateQueue=null,Zs.current=IN,n=t(r,i)}while(oo)}if(Zs.current=Pl,e=se!==null&&se.next!==null,sr=0,ue=se=Y=null,zl=!1,e)throw Error(N(300));return n}function qf(){var n=Po!==0;return Po=0,n}function Ct(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ue===null?Y.memoizedState=ue=n:ue=ue.next=n,ue}function ft(){if(se===null){var n=Y.alternate;n=n!==null?n.memoizedState:null}else n=se.next;var e=ue===null?Y.memoizedState:ue.next;if(e!==null)ue=e,se=n;else{if(n===null)throw Error(N(310));se=n,n={memoizedState:se.memoizedState,baseState:se.baseState,baseQueue:se.baseQueue,queue:se.queue,next:null},ue===null?Y.memoizedState=ue=n:ue=ue.next=n}return ue}function Fo(n,e){return typeof e=="function"?e(n):e}function lu(n){var e=ft(),t=e.queue;if(t===null)throw Error(N(311));t.lastRenderedReducer=n;var r=se,i=r.baseQueue,o=t.pending;if(o!==null){if(i!==null){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,t.pending=null}if(i!==null){o=i.next,r=r.baseState;var l=s=null,a=null,u=o;do{var c=u.lane;if((sr&c)===c)a!==null&&(a=a.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:n(r,u.action);else{var f={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};a===null?(l=a=f,s=r):a=a.next=f,Y.lanes|=c,lr|=c}u=u.next}while(u!==null&&u!==o);a===null?s=r:a.next=l,vt(r,e.memoizedState)||(Ve=!0),e.memoizedState=r,e.baseState=s,e.baseQueue=a,t.lastRenderedState=r}if(n=t.interleaved,n!==null){i=n;do o=i.lane,Y.lanes|=o,lr|=o,i=i.next;while(i!==n)}else i===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function au(n){var e=ft(),t=e.queue;if(t===null)throw Error(N(311));t.lastRenderedReducer=n;var r=t.dispatch,i=t.pending,o=e.memoizedState;if(i!==null){t.pending=null;var s=i=i.next;do o=n(o,s.action),s=s.next;while(s!==i);vt(o,e.memoizedState)||(Ve=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),t.lastRenderedState=o}return[o,r]}function R0(){}function A0(n,e){var t=Y,r=ft(),i=e(),o=!vt(r.memoizedState,i);if(o&&(r.memoizedState=i,Ve=!0),r=r.queue,Qf(z0.bind(null,t,r,n),[n]),r.getSnapshot!==e||o||ue!==null&&ue.memoizedState.tag&1){if(t.flags|=2048,Lo(9,b0.bind(null,t,r,i,e),void 0,null),fe===null)throw Error(N(349));sr&30||I0(t,e,i)}return i}function I0(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=Y.updateQueue,e===null?(e={lastEffect:null,stores:null},Y.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function b0(n,e,t,r){e.value=t,e.getSnapshot=r,P0(e)&&F0(n)}function z0(n,e,t){return t(function(){P0(e)&&F0(n)})}function P0(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!vt(n,t)}catch{return!0}}function F0(n){var e=Gt(n,1);e!==null&&kt(e,n,1,-1)}function kp(n){var e=Ct();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Fo,lastRenderedState:n},e.queue=n,n=n.dispatch=TN.bind(null,Y,n),[e.memoizedState,n]}function Lo(n,e,t,r){return n={tag:n,create:e,destroy:t,deps:r,next:null},e=Y.updateQueue,e===null?(e={lastEffect:null,stores:null},Y.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(r=t.next,t.next=n,n.next=r,e.lastEffect=n)),n}function L0(){return ft().memoizedState}function el(n,e,t,r){var i=Ct();Y.flags|=n,i.memoizedState=Lo(1|e,t,void 0,r===void 0?null:r)}function ea(n,e,t,r){var i=ft();r=r===void 0?null:r;var o=void 0;if(se!==null){var s=se.memoizedState;if(o=s.destroy,r!==null&&jf(r,s.deps)){i.memoizedState=Lo(e,t,o,r);return}}Y.flags|=n,i.memoizedState=Lo(1|e,t,o,r)}function wp(n,e){return el(8390656,8,n,e)}function Qf(n,e){return ea(2048,8,n,e)}function $0(n,e){return ea(4,2,n,e)}function B0(n,e){return ea(4,4,n,e)}function V0(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function J0(n,e,t){return t=t!=null?t.concat([n]):null,ea(4,4,V0.bind(null,e,n),t)}function Yf(){}function _0(n,e){var t=ft();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&jf(e,r[1])?r[0]:(t.memoizedState=[n,e],n)}function W0(n,e){var t=ft();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&jf(e,r[1])?r[0]:(n=n(),t.memoizedState=[n,e],n)}function U0(n,e,t){return sr&21?(vt(t,e)||(t=Ky(),Y.lanes|=t,lr|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,Ve=!0),n.memoizedState=t)}function ON(n,e){var t=U;U=t!==0&&4>t?t:4,n(!0);var r=su.transition;su.transition={};try{n(!1),e()}finally{U=t,su.transition=r}}function H0(){return ft().memoizedState}function DN(n,e,t){var r=Nn(n);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},j0(n))K0(e,t);else if(t=C0(n,e,t,r),t!==null){var i=Te();kt(t,n,r,i),q0(t,e,r)}}function TN(n,e,t){var r=Nn(n),i={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(j0(n))K0(e,i);else{var o=n.alternate;if(n.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var s=e.lastRenderedState,l=o(s,t);if(i.hasEagerState=!0,i.eagerState=l,vt(l,s)){var a=e.interleaved;a===null?(i.next=i,Jf(e)):(i.next=a.next,a.next=i),e.interleaved=i;return}}catch{}finally{}t=C0(n,e,i,r),t!==null&&(i=Te(),kt(t,n,r,i),q0(t,e,r))}}function j0(n){var e=n.alternate;return n===Y||e!==null&&e===Y}function K0(n,e){oo=zl=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function q0(n,e,t){if(t&4194240){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,Of(n,t)}}var Pl={readContext:ct,useCallback:Se,useContext:Se,useEffect:Se,useImperativeHandle:Se,useInsertionEffect:Se,useLayoutEffect:Se,useMemo:Se,useReducer:Se,useRef:Se,useState:Se,useDebugValue:Se,useDeferredValue:Se,useTransition:Se,useMutableSource:Se,useSyncExternalStore:Se,useId:Se,unstable_isNewReconciler:!1},RN={readContext:ct,useCallback:function(n,e){return Ct().memoizedState=[n,e===void 0?null:e],n},useContext:ct,useEffect:wp,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,el(4194308,4,V0.bind(null,e,n),t)},useLayoutEffect:function(n,e){return el(4194308,4,n,e)},useInsertionEffect:function(n,e){return el(4,2,n,e)},useMemo:function(n,e){var t=Ct();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var r=Ct();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},r.queue=n,n=n.dispatch=DN.bind(null,Y,n),[r.memoizedState,n]},useRef:function(n){var e=Ct();return n={current:n},e.memoizedState=n},useState:kp,useDebugValue:Yf,useDeferredValue:function(n){return Ct().memoizedState=n},useTransition:function(){var n=kp(!1),e=n[0];return n=ON.bind(null,n[1]),Ct().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var r=Y,i=Ct();if(q){if(t===void 0)throw Error(N(407));t=t()}else{if(t=e(),fe===null)throw Error(N(349));sr&30||I0(r,e,t)}i.memoizedState=t;var o={value:t,getSnapshot:e};return i.queue=o,wp(z0.bind(null,r,o,n),[n]),r.flags|=2048,Lo(9,b0.bind(null,r,o,t,e),void 0,null),t},useId:function(){var n=Ct(),e=fe.identifierPrefix;if(q){var t=jt,r=Ht;t=(r&~(1<<32-St(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=Po++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=EN++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},AN={readContext:ct,useCallback:_0,useContext:ct,useEffect:Qf,useImperativeHandle:J0,useInsertionEffect:$0,useLayoutEffect:B0,useMemo:W0,useReducer:lu,useRef:L0,useState:function(){return lu(Fo)},useDebugValue:Yf,useDeferredValue:function(n){var e=ft();return U0(e,se.memoizedState,n)},useTransition:function(){var n=lu(Fo)[0],e=ft().memoizedState;return[n,e]},useMutableSource:R0,useSyncExternalStore:A0,useId:H0,unstable_isNewReconciler:!1},IN={readContext:ct,useCallback:_0,useContext:ct,useEffect:Qf,useImperativeHandle:J0,useInsertionEffect:$0,useLayoutEffect:B0,useMemo:W0,useReducer:au,useRef:L0,useState:function(){return au(Fo)},useDebugValue:Yf,useDeferredValue:function(n){var e=ft();return se===null?e.memoizedState=n:U0(e,se.memoizedState,n)},useTransition:function(){var n=au(Fo)[0],e=ft().memoizedState;return[n,e]},useMutableSource:R0,useSyncExternalStore:A0,useId:H0,unstable_isNewReconciler:!1};function oi(n,e){try{var t="",r=e;do t+=sC(r),r=r.return;while(r);var i=t}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:n,source:e,stack:i,digest:null}}function uu(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function xc(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var bN=typeof WeakMap=="function"?WeakMap:Map;function Q0(n,e,t){t=qt(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){Ll||(Ll=!0,Ic=r),xc(n,e)},t}function Y0(n,e,t){t=qt(-1,t),t.tag=3;var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;t.payload=function(){return r(i)},t.callback=function(){xc(n,e)}}var o=n.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(t.callback=function(){xc(n,e),typeof r!="function"&&(Cn===null?Cn=new Set([this]):Cn.add(this));var s=e.stack;this.componentDidCatch(e.value,{componentStack:s!==null?s:""})}),t}function vp(n,e,t){var r=n.pingCache;if(r===null){r=n.pingCache=new bN;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(t)||(i.add(t),n=KN.bind(null,n,e,t),e.then(n,n))}function xp(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function Cp(n,e,t,r,i){return n.mode&1?(n.flags|=65536,n.lanes=i,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=qt(-1,1),e.tag=2,xn(t,e,1))),t.lanes|=1),n)}var zN=Zt.ReactCurrentOwner,Ve=!1;function Ee(n,e,t,r){e.child=n===null?D0(e,null,t,r):ri(e,n.child,t,r)}function Np(n,e,t,r,i){t=t.render;var o=e.ref;return _r(e,i),r=Kf(n,e,t,r,o,i),t=qf(),n!==null&&!Ve?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Xt(n,e,i)):(q&&t&&Pf(e),e.flags|=1,Ee(n,e,r,i),e.child)}function Mp(n,e,t,r,i){if(n===null){var o=t.type;return typeof o=="function"&&!id(o)&&o.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=o,G0(n,e,o,r,i)):(n=il(t.type,null,r,e,e.mode,i),n.ref=e.ref,n.return=e,e.child=n)}if(o=n.child,!(n.lanes&i)){var s=o.memoizedProps;if(t=t.compare,t=t!==null?t:To,t(s,r)&&n.ref===e.ref)return Xt(n,e,i)}return e.flags|=1,n=Mn(o,r),n.ref=e.ref,n.return=e,e.child=n}function G0(n,e,t,r,i){if(n!==null){var o=n.memoizedProps;if(To(o,r)&&n.ref===e.ref)if(Ve=!1,e.pendingProps=r=o,(n.lanes&i)!==0)n.flags&131072&&(Ve=!0);else return e.lanes=n.lanes,Xt(n,e,i)}return Cc(n,e,t,r,i)}function X0(n,e,t){var r=e.pendingProps,i=r.children,o=n!==null?n.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},H(zr,Qe),Qe|=t;else{if(!(t&1073741824))return n=o!==null?o.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,H(zr,Qe),Qe|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:t,H(zr,Qe),Qe|=r}else o!==null?(r=o.baseLanes|t,e.memoizedState=null):r=t,H(zr,Qe),Qe|=r;return Ee(n,e,i,t),e.child}function Z0(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function Cc(n,e,t,r,i){var o=We(t)?ir:Ne.current;return o=ti(e,o),_r(e,i),t=Kf(n,e,t,r,o,i),r=qf(),n!==null&&!Ve?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Xt(n,e,i)):(q&&r&&Pf(e),e.flags|=1,Ee(n,e,t,i),e.child)}function Ep(n,e,t,r,i){if(We(t)){var o=!0;Ol(e)}else o=!1;if(_r(e,i),e.stateNode===null)tl(n,e),E0(e,t,r),vc(e,t,r,i),r=!0;else if(n===null){var s=e.stateNode,l=e.memoizedProps;s.props=l;var a=s.context,u=t.contextType;typeof u=="object"&&u!==null?u=ct(u):(u=We(t)?ir:Ne.current,u=ti(e,u));var c=t.getDerivedStateFromProps,f=typeof c=="function"||typeof s.getSnapshotBeforeUpdate=="function";f||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(l!==r||a!==u)&&yp(e,s,r,u),on=!1;var d=e.memoizedState;s.state=d,Il(e,r,s,i),a=e.memoizedState,l!==r||d!==a||_e.current||on?(typeof c=="function"&&(wc(e,t,c,r),a=e.memoizedState),(l=on||gp(e,t,l,r,d,a,u))?(f||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=a),s.props=r,s.state=a,s.context=u,r=l):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{s=e.stateNode,N0(n,e),l=e.memoizedProps,u=e.type===e.elementType?l:pt(e.type,l),s.props=u,f=e.pendingProps,d=s.context,a=t.contextType,typeof a=="object"&&a!==null?a=ct(a):(a=We(t)?ir:Ne.current,a=ti(e,a));var p=t.getDerivedStateFromProps;(c=typeof p=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(l!==f||d!==a)&&yp(e,s,r,a),on=!1,d=e.memoizedState,s.state=d,Il(e,r,s,i);var h=e.memoizedState;l!==f||d!==h||_e.current||on?(typeof p=="function"&&(wc(e,t,p,r),h=e.memoizedState),(u=on||gp(e,t,u,r,d,h,a)||!1)?(c||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(r,h,a),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(r,h,a)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||l===n.memoizedProps&&d===n.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||l===n.memoizedProps&&d===n.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=h),s.props=r,s.state=h,s.context=a,r=u):(typeof s.componentDidUpdate!="function"||l===n.memoizedProps&&d===n.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||l===n.memoizedProps&&d===n.memoizedState||(e.flags|=1024),r=!1)}return Nc(n,e,t,r,o,i)}function Nc(n,e,t,r,i,o){Z0(n,e);var s=(e.flags&128)!==0;if(!r&&!s)return i&&fp(e,t,!1),Xt(n,e,o);r=e.stateNode,zN.current=e;var l=s&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,n!==null&&s?(e.child=ri(e,n.child,null,o),e.child=ri(e,null,l,o)):Ee(n,e,l,o),e.memoizedState=r.state,i&&fp(e,t,!0),e.child}function e1(n){var e=n.stateNode;e.pendingContext?cp(n,e.pendingContext,e.pendingContext!==e.context):e.context&&cp(n,e.context,!1),Wf(n,e.containerInfo)}function Op(n,e,t,r,i){return ni(),Lf(i),e.flags|=256,Ee(n,e,t,r),e.child}var Mc={dehydrated:null,treeContext:null,retryLane:0};function Ec(n){return{baseLanes:n,cachePool:null,transitions:null}}function t1(n,e,t){var r=e.pendingProps,i=Q.current,o=!1,s=(e.flags&128)!==0,l;if((l=s)||(l=n!==null&&n.memoizedState===null?!1:(i&2)!==0),l?(o=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(i|=1),H(Q,i&1),n===null)return Sc(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(s=r.children,n=r.fallback,o?(r=e.mode,o=e.child,s={mode:"hidden",children:s},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=s):o=ra(s,r,0,null),n=tr(n,r,t,null),o.return=e,n.return=e,o.sibling=n,e.child=o,e.child.memoizedState=Ec(t),e.memoizedState=Mc,n):Gf(e,s));if(i=n.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return PN(n,e,s,r,l,i,t);if(o){o=r.fallback,s=e.mode,i=n.child,l=i.sibling;var a={mode:"hidden",children:r.children};return!(s&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=a,e.deletions=null):(r=Mn(i,a),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?o=Mn(l,o):(o=tr(o,s,t,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,s=n.child.memoizedState,s=s===null?Ec(t):{baseLanes:s.baseLanes|t,cachePool:null,transitions:s.transitions},o.memoizedState=s,o.childLanes=n.childLanes&~t,e.memoizedState=Mc,r}return o=n.child,n=o.sibling,r=Mn(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=r,e.memoizedState=null,r}function Gf(n,e){return e=ra({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function Ns(n,e,t,r){return r!==null&&Lf(r),ri(e,n.child,null,t),n=Gf(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function PN(n,e,t,r,i,o,s){if(t)return e.flags&256?(e.flags&=-257,r=uu(Error(N(422))),Ns(n,e,s,r)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(o=r.fallback,i=e.mode,r=ra({mode:"visible",children:r.children},i,0,null),o=tr(o,i,s,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&ri(e,n.child,null,s),e.child.memoizedState=Ec(s),e.memoizedState=Mc,o);if(!(e.mode&1))return Ns(n,e,s,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,o=Error(N(419)),r=uu(o,r,void 0),Ns(n,e,s,r)}if(l=(s&n.childLanes)!==0,Ve||l){if(r=fe,r!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|s)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,Gt(n,i),kt(r,n,i,-1))}return rd(),r=uu(Error(N(421))),Ns(n,e,s,r)}return i.data==="$?"?(e.flags|=128,e.child=n.child,e=qN.bind(null,n),i._reactRetry=e,null):(n=o.treeContext,Ge=vn(i.nextSibling),Ze=e,q=!0,yt=null,n!==null&&(it[ot++]=Ht,it[ot++]=jt,it[ot++]=or,Ht=n.id,jt=n.overflow,or=e),e=Gf(e,r.children),e.flags|=4096,e)}function Dp(n,e,t){n.lanes|=e;var r=n.alternate;r!==null&&(r.lanes|=e),kc(n.return,e,t)}function cu(n,e,t,r,i){var o=n.memoizedState;o===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:i}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=t,o.tailMode=i)}function n1(n,e,t){var r=e.pendingProps,i=r.revealOrder,o=r.tail;if(Ee(n,e,r.children,t),r=Q.current,r&2)r=r&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&Dp(n,t,e);else if(n.tag===19)Dp(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}r&=1}if(H(Q,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(t=e.child,i=null;t!==null;)n=t.alternate,n!==null&&bl(n)===null&&(i=t),t=t.sibling;t=i,t===null?(i=e.child,e.child=null):(i=t.sibling,t.sibling=null),cu(e,!1,i,t,o);break;case"backwards":for(t=null,i=e.child,e.child=null;i!==null;){if(n=i.alternate,n!==null&&bl(n)===null){e.child=i;break}n=i.sibling,i.sibling=t,t=i,i=n}cu(e,!0,t,null,o);break;case"together":cu(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function tl(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Xt(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),lr|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(N(153));if(e.child!==null){for(n=e.child,t=Mn(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=Mn(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function FN(n,e,t){switch(e.tag){case 3:e1(e),ni();break;case 5:T0(e);break;case 1:We(e.type)&&Ol(e);break;case 4:Wf(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;H(Rl,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(H(Q,Q.current&1),e.flags|=128,null):t&e.child.childLanes?t1(n,e,t):(H(Q,Q.current&1),n=Xt(n,e,t),n!==null?n.sibling:null);H(Q,Q.current&1);break;case 19:if(r=(t&e.childLanes)!==0,n.flags&128){if(r)return n1(n,e,t);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),H(Q,Q.current),r)break;return null;case 22:case 23:return e.lanes=0,X0(n,e,t)}return Xt(n,e,t)}var r1,Oc,i1,o1;r1=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};Oc=function(){};i1=function(n,e,t,r){var i=n.memoizedProps;if(i!==r){n=e.stateNode,Qn(Rt.current);var o=null;switch(t){case"input":i=Qu(n,i),r=Qu(n,r),o=[];break;case"select":i=G({},i,{value:void 0}),r=G({},r,{value:void 0}),o=[];break;case"textarea":i=Xu(n,i),r=Xu(n,r),o=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(n.onclick=Ml)}ec(t,r);var s;t=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var l=i[u];for(s in l)l.hasOwnProperty(s)&&(t||(t={}),t[s]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(xo.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in r){var a=r[u];if(l=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&a!==l&&(a!=null||l!=null))if(u==="style")if(l){for(s in l)!l.hasOwnProperty(s)||a&&a.hasOwnProperty(s)||(t||(t={}),t[s]="");for(s in a)a.hasOwnProperty(s)&&l[s]!==a[s]&&(t||(t={}),t[s]=a[s])}else t||(o||(o=[]),o.push(u,t)),t=a;else u==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,l=l?l.__html:void 0,a!=null&&l!==a&&(o=o||[]).push(u,a)):u==="children"?typeof a!="string"&&typeof a!="number"||(o=o||[]).push(u,""+a):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(xo.hasOwnProperty(u)?(a!=null&&u==="onScroll"&&j("scroll",n),o||l===a||(o=[])):(o=o||[]).push(u,a))}t&&(o=o||[]).push("style",t);var u=o;(e.updateQueue=u)&&(e.flags|=4)}};o1=function(n,e,t,r){t!==r&&(e.flags|=4)};function wi(n,e){if(!q)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:r.sibling=null}}function ke(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,r=0;if(e)for(var i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=n,i=i.sibling;else for(i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=n,i=i.sibling;return n.subtreeFlags|=r,n.childLanes=t,e}function LN(n,e,t){var r=e.pendingProps;switch(Ff(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ke(e),null;case 1:return We(e.type)&&El(),ke(e),null;case 3:return r=e.stateNode,ii(),K(_e),K(Ne),Hf(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(xs(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,yt!==null&&(Pc(yt),yt=null))),Oc(n,e),ke(e),null;case 5:Uf(e);var i=Qn(zo.current);if(t=e.type,n!==null&&e.stateNode!=null)i1(n,e,t,r,i),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(N(166));return ke(e),null}if(n=Qn(Rt.current),xs(e)){r=e.stateNode,t=e.type;var o=e.memoizedProps;switch(r[Mt]=e,r[Io]=o,n=(e.mode&1)!==0,t){case"dialog":j("cancel",r),j("close",r);break;case"iframe":case"object":case"embed":j("load",r);break;case"video":case"audio":for(i=0;i<qi.length;i++)j(qi[i],r);break;case"source":j("error",r);break;case"img":case"image":case"link":j("error",r),j("load",r);break;case"details":j("toggle",r);break;case"input":Lh(r,o),j("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},j("invalid",r);break;case"textarea":Bh(r,o),j("invalid",r)}ec(t,o),i=null;for(var s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="children"?typeof l=="string"?r.textContent!==l&&(o.suppressHydrationWarning!==!0&&vs(r.textContent,l,n),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(o.suppressHydrationWarning!==!0&&vs(r.textContent,l,n),i=["children",""+l]):xo.hasOwnProperty(s)&&l!=null&&s==="onScroll"&&j("scroll",r)}switch(t){case"input":hs(r),$h(r,o,!0);break;case"textarea":hs(r),Vh(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=Ml)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=Iy(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=s.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof r.is=="string"?n=s.createElement(t,{is:r.is}):(n=s.createElement(t),t==="select"&&(s=n,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):n=s.createElementNS(n,t),n[Mt]=e,n[Io]=r,r1(n,e,!1,!1),e.stateNode=n;e:{switch(s=tc(t,r),t){case"dialog":j("cancel",n),j("close",n),i=r;break;case"iframe":case"object":case"embed":j("load",n),i=r;break;case"video":case"audio":for(i=0;i<qi.length;i++)j(qi[i],n);i=r;break;case"source":j("error",n),i=r;break;case"img":case"image":case"link":j("error",n),j("load",n),i=r;break;case"details":j("toggle",n),i=r;break;case"input":Lh(n,r),i=Qu(n,r),j("invalid",n);break;case"option":i=r;break;case"select":n._wrapperState={wasMultiple:!!r.multiple},i=G({},r,{value:void 0}),j("invalid",n);break;case"textarea":Bh(n,r),i=Xu(n,r),j("invalid",n);break;default:i=r}ec(t,i),l=i;for(o in l)if(l.hasOwnProperty(o)){var a=l[o];o==="style"?Py(n,a):o==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,a!=null&&by(n,a)):o==="children"?typeof a=="string"?(t!=="textarea"||a!=="")&&Co(n,a):typeof a=="number"&&Co(n,""+a):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(xo.hasOwnProperty(o)?a!=null&&o==="onScroll"&&j("scroll",n):a!=null&&vf(n,o,a,s))}switch(t){case"input":hs(n),$h(n,r,!1);break;case"textarea":hs(n),Vh(n);break;case"option":r.value!=null&&n.setAttribute("value",""+On(r.value));break;case"select":n.multiple=!!r.multiple,o=r.value,o!=null?$r(n,!!r.multiple,o,!1):r.defaultValue!=null&&$r(n,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(n.onclick=Ml)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ke(e),null;case 6:if(n&&e.stateNode!=null)o1(n,e,n.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(N(166));if(t=Qn(zo.current),Qn(Rt.current),xs(e)){if(r=e.stateNode,t=e.memoizedProps,r[Mt]=e,(o=r.nodeValue!==t)&&(n=Ze,n!==null))switch(n.tag){case 3:vs(r.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&vs(r.nodeValue,t,(n.mode&1)!==0)}o&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[Mt]=e,e.stateNode=r}return ke(e),null;case 13:if(K(Q),r=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(q&&Ge!==null&&e.mode&1&&!(e.flags&128))x0(),ni(),e.flags|=98560,o=!1;else if(o=xs(e),r!==null&&r.dehydrated!==null){if(n===null){if(!o)throw Error(N(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(N(317));o[Mt]=e}else ni(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ke(e),o=!1}else yt!==null&&(Pc(yt),yt=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(n!==null&&n.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(n===null||Q.current&1?le===0&&(le=3):rd())),e.updateQueue!==null&&(e.flags|=4),ke(e),null);case 4:return ii(),Oc(n,e),n===null&&Ro(e.stateNode.containerInfo),ke(e),null;case 10:return Vf(e.type._context),ke(e),null;case 17:return We(e.type)&&El(),ke(e),null;case 19:if(K(Q),o=e.memoizedState,o===null)return ke(e),null;if(r=(e.flags&128)!==0,s=o.rendering,s===null)if(r)wi(o,!1);else{if(le!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(s=bl(n),s!==null){for(e.flags|=128,wi(o,!1),r=s.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)o=t,n=r,o.flags&=14680066,s=o.alternate,s===null?(o.childLanes=0,o.lanes=n,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,n=s.dependencies,o.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return H(Q,Q.current&1|2),e.child}n=n.sibling}o.tail!==null&&te()>si&&(e.flags|=128,r=!0,wi(o,!1),e.lanes=4194304)}else{if(!r)if(n=bl(s),n!==null){if(e.flags|=128,r=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),wi(o,!0),o.tail===null&&o.tailMode==="hidden"&&!s.alternate&&!q)return ke(e),null}else 2*te()-o.renderingStartTime>si&&t!==1073741824&&(e.flags|=128,r=!0,wi(o,!1),e.lanes=4194304);o.isBackwards?(s.sibling=e.child,e.child=s):(t=o.last,t!==null?t.sibling=s:e.child=s,o.last=s)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=te(),e.sibling=null,t=Q.current,H(Q,r?t&1|2:t&1),e):(ke(e),null);case 22:case 23:return nd(),r=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Qe&1073741824&&(ke(e),e.subtreeFlags&6&&(e.flags|=8192)):ke(e),null;case 24:return null;case 25:return null}throw Error(N(156,e.tag))}function $N(n,e){switch(Ff(e),e.tag){case 1:return We(e.type)&&El(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return ii(),K(_e),K(Ne),Hf(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return Uf(e),null;case 13:if(K(Q),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(N(340));ni()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return K(Q),null;case 4:return ii(),null;case 10:return Vf(e.type._context),null;case 22:case 23:return nd(),null;case 24:return null;default:return null}}var Ms=!1,ve=!1,BN=typeof WeakSet=="function"?WeakSet:Set,T=null;function br(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){X(n,e,r)}else t.current=null}function Dc(n,e,t){try{t()}catch(r){X(n,e,r)}}var Tp=!1;function VN(n,e){if(fc=xl,n=u0(),zf(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{t.nodeType,o.nodeType}catch{t=null;break e}var s=0,l=-1,a=-1,u=0,c=0,f=n,d=null;t:for(;;){for(var p;f!==t||i!==0&&f.nodeType!==3||(l=s+i),f!==o||r!==0&&f.nodeType!==3||(a=s+r),f.nodeType===3&&(s+=f.nodeValue.length),(p=f.firstChild)!==null;)d=f,f=p;for(;;){if(f===n)break t;if(d===t&&++u===i&&(l=s),d===o&&++c===r&&(a=s),(p=f.nextSibling)!==null)break;f=d,d=f.parentNode}f=p}t=l===-1||a===-1?null:{start:l,end:a}}else t=null}t=t||{start:0,end:0}}else t=null;for(dc={focusedElem:n,selectionRange:t},xl=!1,T=e;T!==null;)if(e=T,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,T=n;else for(;T!==null;){e=T;try{var h=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(h!==null){var m=h.memoizedProps,k=h.memoizedState,g=e.stateNode,y=g.getSnapshotBeforeUpdate(e.elementType===e.type?m:pt(e.type,m),k);g.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(N(163))}}catch(x){X(e,e.return,x)}if(n=e.sibling,n!==null){n.return=e.return,T=n;break}T=e.return}return h=Tp,Tp=!1,h}function so(n,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&n)===n){var o=i.destroy;i.destroy=void 0,o!==void 0&&Dc(e,t,o)}i=i.next}while(i!==r)}}function ta(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function Tc(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function s1(n){var e=n.alternate;e!==null&&(n.alternate=null,s1(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[Mt],delete e[Io],delete e[mc],delete e[xN],delete e[CN])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function l1(n){return n.tag===5||n.tag===3||n.tag===4}function Rp(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||l1(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Rc(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=Ml));else if(r!==4&&(n=n.child,n!==null))for(Rc(n,e,t),n=n.sibling;n!==null;)Rc(n,e,t),n=n.sibling}function Ac(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(r!==4&&(n=n.child,n!==null))for(Ac(n,e,t),n=n.sibling;n!==null;)Ac(n,e,t),n=n.sibling}var he=null,mt=!1;function en(n,e,t){for(t=t.child;t!==null;)a1(n,e,t),t=t.sibling}function a1(n,e,t){if(Tt&&typeof Tt.onCommitFiberUnmount=="function")try{Tt.onCommitFiberUnmount(Kl,t)}catch{}switch(t.tag){case 5:ve||br(t,e);case 6:var r=he,i=mt;he=null,en(n,e,t),he=r,mt=i,he!==null&&(mt?(n=he,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):he.removeChild(t.stateNode));break;case 18:he!==null&&(mt?(n=he,t=t.stateNode,n.nodeType===8?ru(n.parentNode,t):n.nodeType===1&&ru(n,t),Oo(n)):ru(he,t.stateNode));break;case 4:r=he,i=mt,he=t.stateNode.containerInfo,mt=!0,en(n,e,t),he=r,mt=i;break;case 0:case 11:case 14:case 15:if(!ve&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var o=i,s=o.destroy;o=o.tag,s!==void 0&&(o&2||o&4)&&Dc(t,e,s),i=i.next}while(i!==r)}en(n,e,t);break;case 1:if(!ve&&(br(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(l){X(t,e,l)}en(n,e,t);break;case 21:en(n,e,t);break;case 22:t.mode&1?(ve=(r=ve)||t.memoizedState!==null,en(n,e,t),ve=r):en(n,e,t);break;default:en(n,e,t)}}function Ap(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new BN),e.forEach(function(r){var i=QN.bind(null,n,r);t.has(r)||(t.add(r),r.then(i,i))})}}function ht(n,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var i=t[r];try{var o=n,s=e,l=s;e:for(;l!==null;){switch(l.tag){case 5:he=l.stateNode,mt=!1;break e;case 3:he=l.stateNode.containerInfo,mt=!0;break e;case 4:he=l.stateNode.containerInfo,mt=!0;break e}l=l.return}if(he===null)throw Error(N(160));a1(o,s,i),he=null,mt=!1;var a=i.alternate;a!==null&&(a.return=null),i.return=null}catch(u){X(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)u1(e,n),e=e.sibling}function u1(n,e){var t=n.alternate,r=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(ht(e,n),xt(n),r&4){try{so(3,n,n.return),ta(3,n)}catch(m){X(n,n.return,m)}try{so(5,n,n.return)}catch(m){X(n,n.return,m)}}break;case 1:ht(e,n),xt(n),r&512&&t!==null&&br(t,t.return);break;case 5:if(ht(e,n),xt(n),r&512&&t!==null&&br(t,t.return),n.flags&32){var i=n.stateNode;try{Co(i,"")}catch(m){X(n,n.return,m)}}if(r&4&&(i=n.stateNode,i!=null)){var o=n.memoizedProps,s=t!==null?t.memoizedProps:o,l=n.type,a=n.updateQueue;if(n.updateQueue=null,a!==null)try{l==="input"&&o.type==="radio"&&o.name!=null&&Ry(i,o),tc(l,s);var u=tc(l,o);for(s=0;s<a.length;s+=2){var c=a[s],f=a[s+1];c==="style"?Py(i,f):c==="dangerouslySetInnerHTML"?by(i,f):c==="children"?Co(i,f):vf(i,c,f,u)}switch(l){case"input":Yu(i,o);break;case"textarea":Ay(i,o);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var p=o.value;p!=null?$r(i,!!o.multiple,p,!1):d!==!!o.multiple&&(o.defaultValue!=null?$r(i,!!o.multiple,o.defaultValue,!0):$r(i,!!o.multiple,o.multiple?[]:"",!1))}i[Io]=o}catch(m){X(n,n.return,m)}}break;case 6:if(ht(e,n),xt(n),r&4){if(n.stateNode===null)throw Error(N(162));i=n.stateNode,o=n.memoizedProps;try{i.nodeValue=o}catch(m){X(n,n.return,m)}}break;case 3:if(ht(e,n),xt(n),r&4&&t!==null&&t.memoizedState.isDehydrated)try{Oo(e.containerInfo)}catch(m){X(n,n.return,m)}break;case 4:ht(e,n),xt(n);break;case 13:ht(e,n),xt(n),i=n.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(ed=te())),r&4&&Ap(n);break;case 22:if(c=t!==null&&t.memoizedState!==null,n.mode&1?(ve=(u=ve)||c,ht(e,n),ve=u):ht(e,n),xt(n),r&8192){if(u=n.memoizedState!==null,(n.stateNode.isHidden=u)&&!c&&n.mode&1)for(T=n,c=n.child;c!==null;){for(f=T=c;T!==null;){switch(d=T,p=d.child,d.tag){case 0:case 11:case 14:case 15:so(4,d,d.return);break;case 1:br(d,d.return);var h=d.stateNode;if(typeof h.componentWillUnmount=="function"){r=d,t=d.return;try{e=r,h.props=e.memoizedProps,h.state=e.memoizedState,h.componentWillUnmount()}catch(m){X(r,t,m)}}break;case 5:br(d,d.return);break;case 22:if(d.memoizedState!==null){bp(f);continue}}p!==null?(p.return=d,T=p):bp(f)}c=c.sibling}e:for(c=null,f=n;;){if(f.tag===5){if(c===null){c=f;try{i=f.stateNode,u?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(l=f.stateNode,a=f.memoizedProps.style,s=a!=null&&a.hasOwnProperty("display")?a.display:null,l.style.display=zy("display",s))}catch(m){X(n,n.return,m)}}}else if(f.tag===6){if(c===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(m){X(n,n.return,m)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===n)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===n)break e;for(;f.sibling===null;){if(f.return===null||f.return===n)break e;c===f&&(c=null),f=f.return}c===f&&(c=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:ht(e,n),xt(n),r&4&&Ap(n);break;case 21:break;default:ht(e,n),xt(n)}}function xt(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(l1(t)){var r=t;break e}t=t.return}throw Error(N(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Co(i,""),r.flags&=-33);var o=Rp(n);Ac(n,o,i);break;case 3:case 4:var s=r.stateNode.containerInfo,l=Rp(n);Rc(n,l,s);break;default:throw Error(N(161))}}catch(a){X(n,n.return,a)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function JN(n,e,t){T=n,c1(n)}function c1(n,e,t){for(var r=(n.mode&1)!==0;T!==null;){var i=T,o=i.child;if(i.tag===22&&r){var s=i.memoizedState!==null||Ms;if(!s){var l=i.alternate,a=l!==null&&l.memoizedState!==null||ve;l=Ms;var u=ve;if(Ms=s,(ve=a)&&!u)for(T=i;T!==null;)s=T,a=s.child,s.tag===22&&s.memoizedState!==null?zp(i):a!==null?(a.return=s,T=a):zp(i);for(;o!==null;)T=o,c1(o),o=o.sibling;T=i,Ms=l,ve=u}Ip(n)}else i.subtreeFlags&8772&&o!==null?(o.return=i,T=o):Ip(n)}}function Ip(n){for(;T!==null;){var e=T;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ve||ta(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!ve)if(t===null)r.componentDidMount();else{var i=e.elementType===e.type?t.memoizedProps:pt(e.type,t.memoizedProps);r.componentDidUpdate(i,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&mp(e,o,r);break;case 3:var s=e.updateQueue;if(s!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}mp(e,s,t)}break;case 5:var l=e.stateNode;if(t===null&&e.flags&4){t=l;var a=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":a.autoFocus&&t.focus();break;case"img":a.src&&(t.src=a.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var f=c.dehydrated;f!==null&&Oo(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(N(163))}ve||e.flags&512&&Tc(e)}catch(d){X(e,e.return,d)}}if(e===n){T=null;break}if(t=e.sibling,t!==null){t.return=e.return,T=t;break}T=e.return}}function bp(n){for(;T!==null;){var e=T;if(e===n){T=null;break}var t=e.sibling;if(t!==null){t.return=e.return,T=t;break}T=e.return}}function zp(n){for(;T!==null;){var e=T;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{ta(4,e)}catch(a){X(e,t,a)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(a){X(e,i,a)}}var o=e.return;try{Tc(e)}catch(a){X(e,o,a)}break;case 5:var s=e.return;try{Tc(e)}catch(a){X(e,s,a)}}}catch(a){X(e,e.return,a)}if(e===n){T=null;break}var l=e.sibling;if(l!==null){l.return=e.return,T=l;break}T=e.return}}var _N=Math.ceil,Fl=Zt.ReactCurrentDispatcher,Xf=Zt.ReactCurrentOwner,ut=Zt.ReactCurrentBatchConfig,V=0,fe=null,ie=null,ge=0,Qe=0,zr=In(0),le=0,$o=null,lr=0,na=0,Zf=0,lo=null,Pe=null,ed=0,si=1/0,Jt=null,Ll=!1,Ic=null,Cn=null,Es=!1,mn=null,$l=0,ao=0,bc=null,nl=-1,rl=0;function Te(){return V&6?te():nl!==-1?nl:nl=te()}function Nn(n){return n.mode&1?V&2&&ge!==0?ge&-ge:MN.transition!==null?(rl===0&&(rl=Ky()),rl):(n=U,n!==0||(n=window.event,n=n===void 0?16:e0(n.type)),n):1}function kt(n,e,t,r){if(50<ao)throw ao=0,bc=null,Error(N(185));Qo(n,t,r),(!(V&2)||n!==fe)&&(n===fe&&(!(V&2)&&(na|=t),le===4&&un(n,ge)),Ue(n,r),t===1&&V===0&&!(e.mode&1)&&(si=te()+500,Xl&&bn()))}function Ue(n,e){var t=n.callbackNode;MC(n,e);var r=vl(n,n===fe?ge:0);if(r===0)t!==null&&Wh(t),n.callbackNode=null,n.callbackPriority=0;else if(e=r&-r,n.callbackPriority!==e){if(t!=null&&Wh(t),e===1)n.tag===0?NN(Pp.bind(null,n)):k0(Pp.bind(null,n)),wN(function(){!(V&6)&&bn()}),t=null;else{switch(qy(r)){case 1:t=Ef;break;case 4:t=Hy;break;case 16:t=wl;break;case 536870912:t=jy;break;default:t=wl}t=S1(t,f1.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function f1(n,e){if(nl=-1,rl=0,V&6)throw Error(N(327));var t=n.callbackNode;if(Wr()&&n.callbackNode!==t)return null;var r=vl(n,n===fe?ge:0);if(r===0)return null;if(r&30||r&n.expiredLanes||e)e=Bl(n,r);else{e=r;var i=V;V|=2;var o=h1();(fe!==n||ge!==e)&&(Jt=null,si=te()+500,er(n,e));do try{HN();break}catch(l){d1(n,l)}while(!0);Bf(),Fl.current=o,V=i,ie!==null?e=0:(fe=null,ge=0,e=le)}if(e!==0){if(e===2&&(i=sc(n),i!==0&&(r=i,e=zc(n,i))),e===1)throw t=$o,er(n,0),un(n,r),Ue(n,te()),t;if(e===6)un(n,r);else{if(i=n.current.alternate,!(r&30)&&!WN(i)&&(e=Bl(n,r),e===2&&(o=sc(n),o!==0&&(r=o,e=zc(n,o))),e===1))throw t=$o,er(n,0),un(n,r),Ue(n,te()),t;switch(n.finishedWork=i,n.finishedLanes=r,e){case 0:case 1:throw Error(N(345));case 2:_n(n,Pe,Jt);break;case 3:if(un(n,r),(r&130023424)===r&&(e=ed+500-te(),10<e)){if(vl(n,0)!==0)break;if(i=n.suspendedLanes,(i&r)!==r){Te(),n.pingedLanes|=n.suspendedLanes&i;break}n.timeoutHandle=pc(_n.bind(null,n,Pe,Jt),e);break}_n(n,Pe,Jt);break;case 4:if(un(n,r),(r&4194240)===r)break;for(e=n.eventTimes,i=-1;0<r;){var s=31-St(r);o=1<<s,s=e[s],s>i&&(i=s),r&=~o}if(r=i,r=te()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*_N(r/1960))-r,10<r){n.timeoutHandle=pc(_n.bind(null,n,Pe,Jt),r);break}_n(n,Pe,Jt);break;case 5:_n(n,Pe,Jt);break;default:throw Error(N(329))}}}return Ue(n,te()),n.callbackNode===t?f1.bind(null,n):null}function zc(n,e){var t=lo;return n.current.memoizedState.isDehydrated&&(er(n,e).flags|=256),n=Bl(n,e),n!==2&&(e=Pe,Pe=t,e!==null&&Pc(e)),n}function Pc(n){Pe===null?Pe=n:Pe.push.apply(Pe,n)}function WN(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var i=t[r],o=i.getSnapshot;i=i.value;try{if(!vt(o(),i))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function un(n,e){for(e&=~Zf,e&=~na,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-St(e),r=1<<t;n[t]=-1,e&=~r}}function Pp(n){if(V&6)throw Error(N(327));Wr();var e=vl(n,0);if(!(e&1))return Ue(n,te()),null;var t=Bl(n,e);if(n.tag!==0&&t===2){var r=sc(n);r!==0&&(e=r,t=zc(n,r))}if(t===1)throw t=$o,er(n,0),un(n,e),Ue(n,te()),t;if(t===6)throw Error(N(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,_n(n,Pe,Jt),Ue(n,te()),null}function td(n,e){var t=V;V|=1;try{return n(e)}finally{V=t,V===0&&(si=te()+500,Xl&&bn())}}function ar(n){mn!==null&&mn.tag===0&&!(V&6)&&Wr();var e=V;V|=1;var t=ut.transition,r=U;try{if(ut.transition=null,U=1,n)return n()}finally{U=r,ut.transition=t,V=e,!(V&6)&&bn()}}function nd(){Qe=zr.current,K(zr)}function er(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,kN(t)),ie!==null)for(t=ie.return;t!==null;){var r=t;switch(Ff(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&El();break;case 3:ii(),K(_e),K(Ne),Hf();break;case 5:Uf(r);break;case 4:ii();break;case 13:K(Q);break;case 19:K(Q);break;case 10:Vf(r.type._context);break;case 22:case 23:nd()}t=t.return}if(fe=n,ie=n=Mn(n.current,null),ge=Qe=e,le=0,$o=null,Zf=na=lr=0,Pe=lo=null,qn!==null){for(e=0;e<qn.length;e++)if(t=qn[e],r=t.interleaved,r!==null){t.interleaved=null;var i=r.next,o=t.pending;if(o!==null){var s=o.next;o.next=i,r.next=s}t.pending=r}qn=null}return n}function d1(n,e){do{var t=ie;try{if(Bf(),Zs.current=Pl,zl){for(var r=Y.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}zl=!1}if(sr=0,ue=se=Y=null,oo=!1,Po=0,Xf.current=null,t===null||t.return===null){le=1,$o=e,ie=null;break}e:{var o=n,s=t.return,l=t,a=e;if(e=ge,l.flags|=32768,a!==null&&typeof a=="object"&&typeof a.then=="function"){var u=a,c=l,f=c.tag;if(!(c.mode&1)&&(f===0||f===11||f===15)){var d=c.alternate;d?(c.updateQueue=d.updateQueue,c.memoizedState=d.memoizedState,c.lanes=d.lanes):(c.updateQueue=null,c.memoizedState=null)}var p=xp(s);if(p!==null){p.flags&=-257,Cp(p,s,l,o,e),p.mode&1&&vp(o,u,e),e=p,a=u;var h=e.updateQueue;if(h===null){var m=new Set;m.add(a),e.updateQueue=m}else h.add(a);break e}else{if(!(e&1)){vp(o,u,e),rd();break e}a=Error(N(426))}}else if(q&&l.mode&1){var k=xp(s);if(k!==null){!(k.flags&65536)&&(k.flags|=256),Cp(k,s,l,o,e),Lf(oi(a,l));break e}}o=a=oi(a,l),le!==4&&(le=2),lo===null?lo=[o]:lo.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var g=Q0(o,a,e);pp(o,g);break e;case 1:l=a;var y=o.type,S=o.stateNode;if(!(o.flags&128)&&(typeof y.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(Cn===null||!Cn.has(S)))){o.flags|=65536,e&=-e,o.lanes|=e;var x=Y0(o,l,e);pp(o,x);break e}}o=o.return}while(o!==null)}m1(t)}catch(M){e=M,ie===t&&t!==null&&(ie=t=t.return);continue}break}while(!0)}function h1(){var n=Fl.current;return Fl.current=Pl,n===null?Pl:n}function rd(){(le===0||le===3||le===2)&&(le=4),fe===null||!(lr&268435455)&&!(na&268435455)||un(fe,ge)}function Bl(n,e){var t=V;V|=2;var r=h1();(fe!==n||ge!==e)&&(Jt=null,er(n,e));do try{UN();break}catch(i){d1(n,i)}while(!0);if(Bf(),V=t,Fl.current=r,ie!==null)throw Error(N(261));return fe=null,ge=0,le}function UN(){for(;ie!==null;)p1(ie)}function HN(){for(;ie!==null&&!gC();)p1(ie)}function p1(n){var e=y1(n.alternate,n,Qe);n.memoizedProps=n.pendingProps,e===null?m1(n):ie=e,Xf.current=null}function m1(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=$N(t,e),t!==null){t.flags&=32767,ie=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{le=6,ie=null;return}}else if(t=LN(t,e,Qe),t!==null){ie=t;return}if(e=e.sibling,e!==null){ie=e;return}ie=e=n}while(e!==null);le===0&&(le=5)}function _n(n,e,t){var r=U,i=ut.transition;try{ut.transition=null,U=1,jN(n,e,t,r)}finally{ut.transition=i,U=r}return null}function jN(n,e,t,r){do Wr();while(mn!==null);if(V&6)throw Error(N(327));t=n.finishedWork;var i=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(N(177));n.callbackNode=null,n.callbackPriority=0;var o=t.lanes|t.childLanes;if(EC(n,o),n===fe&&(ie=fe=null,ge=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||Es||(Es=!0,S1(wl,function(){return Wr(),null})),o=(t.flags&15990)!==0,t.subtreeFlags&15990||o){o=ut.transition,ut.transition=null;var s=U;U=1;var l=V;V|=4,Xf.current=null,VN(n,t),u1(t,n),dN(dc),xl=!!fc,dc=fc=null,n.current=t,JN(t),yC(),V=l,U=s,ut.transition=o}else n.current=t;if(Es&&(Es=!1,mn=n,$l=i),o=n.pendingLanes,o===0&&(Cn=null),wC(t.stateNode),Ue(n,te()),e!==null)for(r=n.onRecoverableError,t=0;t<e.length;t++)i=e[t],r(i.value,{componentStack:i.stack,digest:i.digest});if(Ll)throw Ll=!1,n=Ic,Ic=null,n;return $l&1&&n.tag!==0&&Wr(),o=n.pendingLanes,o&1?n===bc?ao++:(ao=0,bc=n):ao=0,bn(),null}function Wr(){if(mn!==null){var n=qy($l),e=ut.transition,t=U;try{if(ut.transition=null,U=16>n?16:n,mn===null)var r=!1;else{if(n=mn,mn=null,$l=0,V&6)throw Error(N(331));var i=V;for(V|=4,T=n.current;T!==null;){var o=T,s=o.child;if(T.flags&16){var l=o.deletions;if(l!==null){for(var a=0;a<l.length;a++){var u=l[a];for(T=u;T!==null;){var c=T;switch(c.tag){case 0:case 11:case 15:so(8,c,o)}var f=c.child;if(f!==null)f.return=c,T=f;else for(;T!==null;){c=T;var d=c.sibling,p=c.return;if(s1(c),c===u){T=null;break}if(d!==null){d.return=p,T=d;break}T=p}}}var h=o.alternate;if(h!==null){var m=h.child;if(m!==null){h.child=null;do{var k=m.sibling;m.sibling=null,m=k}while(m!==null)}}T=o}}if(o.subtreeFlags&2064&&s!==null)s.return=o,T=s;else e:for(;T!==null;){if(o=T,o.flags&2048)switch(o.tag){case 0:case 11:case 15:so(9,o,o.return)}var g=o.sibling;if(g!==null){g.return=o.return,T=g;break e}T=o.return}}var y=n.current;for(T=y;T!==null;){s=T;var S=s.child;if(s.subtreeFlags&2064&&S!==null)S.return=s,T=S;else e:for(s=y;T!==null;){if(l=T,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:ta(9,l)}}catch(M){X(l,l.return,M)}if(l===s){T=null;break e}var x=l.sibling;if(x!==null){x.return=l.return,T=x;break e}T=l.return}}if(V=i,bn(),Tt&&typeof Tt.onPostCommitFiberRoot=="function")try{Tt.onPostCommitFiberRoot(Kl,n)}catch{}r=!0}return r}finally{U=t,ut.transition=e}}return!1}function Fp(n,e,t){e=oi(t,e),e=Q0(n,e,1),n=xn(n,e,1),e=Te(),n!==null&&(Qo(n,1,e),Ue(n,e))}function X(n,e,t){if(n.tag===3)Fp(n,n,t);else for(;e!==null;){if(e.tag===3){Fp(e,n,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Cn===null||!Cn.has(r))){n=oi(t,n),n=Y0(e,n,1),e=xn(e,n,1),n=Te(),e!==null&&(Qo(e,1,n),Ue(e,n));break}}e=e.return}}function KN(n,e,t){var r=n.pingCache;r!==null&&r.delete(e),e=Te(),n.pingedLanes|=n.suspendedLanes&t,fe===n&&(ge&t)===t&&(le===4||le===3&&(ge&130023424)===ge&&500>te()-ed?er(n,0):Zf|=t),Ue(n,e)}function g1(n,e){e===0&&(n.mode&1?(e=gs,gs<<=1,!(gs&130023424)&&(gs=4194304)):e=1);var t=Te();n=Gt(n,e),n!==null&&(Qo(n,e,t),Ue(n,t))}function qN(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),g1(n,t)}function QN(n,e){var t=0;switch(n.tag){case 13:var r=n.stateNode,i=n.memoizedState;i!==null&&(t=i.retryLane);break;case 19:r=n.stateNode;break;default:throw Error(N(314))}r!==null&&r.delete(e),g1(n,t)}var y1;y1=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||_e.current)Ve=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return Ve=!1,FN(n,e,t);Ve=!!(n.flags&131072)}else Ve=!1,q&&e.flags&1048576&&w0(e,Tl,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;tl(n,e),n=e.pendingProps;var i=ti(e,Ne.current);_r(e,t),i=Kf(null,e,r,n,i,t);var o=qf();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,We(r)?(o=!0,Ol(e)):o=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,_f(e),i.updater=Zl,e.stateNode=i,i._reactInternals=e,vc(e,r,n,t),e=Nc(null,e,r,!0,o,t)):(e.tag=0,q&&o&&Pf(e),Ee(null,e,i,t),e=e.child),e;case 16:r=e.elementType;e:{switch(tl(n,e),n=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=GN(r),n=pt(r,n),i){case 0:e=Cc(null,e,r,n,t);break e;case 1:e=Ep(null,e,r,n,t);break e;case 11:e=Np(null,e,r,n,t);break e;case 14:e=Mp(null,e,r,pt(r.type,n),t);break e}throw Error(N(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:pt(r,i),Cc(n,e,r,i,t);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:pt(r,i),Ep(n,e,r,i,t);case 3:e:{if(e1(e),n===null)throw Error(N(387));r=e.pendingProps,o=e.memoizedState,i=o.element,N0(n,e),Il(e,r,null,t);var s=e.memoizedState;if(r=s.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){i=oi(Error(N(423)),e),e=Op(n,e,r,t,i);break e}else if(r!==i){i=oi(Error(N(424)),e),e=Op(n,e,r,t,i);break e}else for(Ge=vn(e.stateNode.containerInfo.firstChild),Ze=e,q=!0,yt=null,t=D0(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(ni(),r===i){e=Xt(n,e,t);break e}Ee(n,e,r,t)}e=e.child}return e;case 5:return T0(e),n===null&&Sc(e),r=e.type,i=e.pendingProps,o=n!==null?n.memoizedProps:null,s=i.children,hc(r,i)?s=null:o!==null&&hc(r,o)&&(e.flags|=32),Z0(n,e),Ee(n,e,s,t),e.child;case 6:return n===null&&Sc(e),null;case 13:return t1(n,e,t);case 4:return Wf(e,e.stateNode.containerInfo),r=e.pendingProps,n===null?e.child=ri(e,null,r,t):Ee(n,e,r,t),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:pt(r,i),Np(n,e,r,i,t);case 7:return Ee(n,e,e.pendingProps,t),e.child;case 8:return Ee(n,e,e.pendingProps.children,t),e.child;case 12:return Ee(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,o=e.memoizedProps,s=i.value,H(Rl,r._currentValue),r._currentValue=s,o!==null)if(vt(o.value,s)){if(o.children===i.children&&!_e.current){e=Xt(n,e,t);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var l=o.dependencies;if(l!==null){s=o.child;for(var a=l.firstContext;a!==null;){if(a.context===r){if(o.tag===1){a=qt(-1,t&-t),a.tag=2;var u=o.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?a.next=a:(a.next=c.next,c.next=a),u.pending=a}}o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),kc(o.return,t,e),l.lanes|=t;break}a=a.next}}else if(o.tag===10)s=o.type===e.type?null:o.child;else if(o.tag===18){if(s=o.return,s===null)throw Error(N(341));s.lanes|=t,l=s.alternate,l!==null&&(l.lanes|=t),kc(s,t,e),s=o.sibling}else s=o.child;if(s!==null)s.return=o;else for(s=o;s!==null;){if(s===e){s=null;break}if(o=s.sibling,o!==null){o.return=s.return,s=o;break}s=s.return}o=s}Ee(n,e,i.children,t),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,_r(e,t),i=ct(i),r=r(i),e.flags|=1,Ee(n,e,r,t),e.child;case 14:return r=e.type,i=pt(r,e.pendingProps),i=pt(r.type,i),Mp(n,e,r,i,t);case 15:return G0(n,e,e.type,e.pendingProps,t);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:pt(r,i),tl(n,e),e.tag=1,We(r)?(n=!0,Ol(e)):n=!1,_r(e,t),E0(e,r,i),vc(e,r,i,t),Nc(null,e,r,!0,n,t);case 19:return n1(n,e,t);case 22:return X0(n,e,t)}throw Error(N(156,e.tag))};function S1(n,e){return Uy(n,e)}function YN(n,e,t,r){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function lt(n,e,t,r){return new YN(n,e,t,r)}function id(n){return n=n.prototype,!(!n||!n.isReactComponent)}function GN(n){if(typeof n=="function")return id(n)?1:0;if(n!=null){if(n=n.$$typeof,n===Cf)return 11;if(n===Nf)return 14}return 2}function Mn(n,e){var t=n.alternate;return t===null?(t=lt(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function il(n,e,t,r,i,o){var s=2;if(r=n,typeof n=="function")id(n)&&(s=1);else if(typeof n=="string")s=5;else e:switch(n){case Nr:return tr(t.children,i,o,e);case xf:s=8,i|=8;break;case Hu:return n=lt(12,t,e,i|2),n.elementType=Hu,n.lanes=o,n;case ju:return n=lt(13,t,e,i),n.elementType=ju,n.lanes=o,n;case Ku:return n=lt(19,t,e,i),n.elementType=Ku,n.lanes=o,n;case Oy:return ra(t,i,o,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case My:s=10;break e;case Ey:s=9;break e;case Cf:s=11;break e;case Nf:s=14;break e;case rn:s=16,r=null;break e}throw Error(N(130,n==null?n:typeof n,""))}return e=lt(s,t,e,i),e.elementType=n,e.type=r,e.lanes=o,e}function tr(n,e,t,r){return n=lt(7,n,r,e),n.lanes=t,n}function ra(n,e,t,r){return n=lt(22,n,r,e),n.elementType=Oy,n.lanes=t,n.stateNode={isHidden:!1},n}function fu(n,e,t){return n=lt(6,n,null,e),n.lanes=t,n}function du(n,e,t){return e=lt(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function XN(n,e,t,r,i){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ja(0),this.expirationTimes=ja(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ja(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function od(n,e,t,r,i,o,s,l,a){return n=new XN(n,e,t,l,a),e===1?(e=1,o===!0&&(e|=8)):e=0,o=lt(3,null,null,e),n.current=o,o.stateNode=n,o.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},_f(o),n}function ZN(n,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Cr,key:r==null?null:""+r,children:n,containerInfo:e,implementation:t}}function k1(n){if(!n)return Dn;n=n._reactInternals;e:{if(dr(n)!==n||n.tag!==1)throw Error(N(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(We(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(N(171))}if(n.tag===1){var t=n.type;if(We(t))return S0(n,t,e)}return e}function w1(n,e,t,r,i,o,s,l,a){return n=od(t,r,!0,n,i,o,s,l,a),n.context=k1(null),t=n.current,r=Te(),i=Nn(t),o=qt(r,i),o.callback=e??null,xn(t,o,i),n.current.lanes=i,Qo(n,i,r),Ue(n,r),n}function ia(n,e,t,r){var i=e.current,o=Te(),s=Nn(i);return t=k1(t),e.context===null?e.context=t:e.pendingContext=t,e=qt(o,s),e.payload={element:n},r=r===void 0?null:r,r!==null&&(e.callback=r),n=xn(i,e,s),n!==null&&(kt(n,i,s,o),Xs(n,i,s)),s}function Vl(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function Lp(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function sd(n,e){Lp(n,e),(n=n.alternate)&&Lp(n,e)}function eM(){return null}var v1=typeof reportError=="function"?reportError:function(n){console.error(n)};function ld(n){this._internalRoot=n}oa.prototype.render=ld.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(N(409));ia(n,e,null,null)};oa.prototype.unmount=ld.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;ar(function(){ia(null,n,null,null)}),e[Yt]=null}};function oa(n){this._internalRoot=n}oa.prototype.unstable_scheduleHydration=function(n){if(n){var e=Gy();n={blockedOn:null,target:n,priority:e};for(var t=0;t<an.length&&e!==0&&e<an[t].priority;t++);an.splice(t,0,n),t===0&&Zy(n)}};function ad(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function sa(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function $p(){}function tM(n,e,t,r,i){if(i){if(typeof r=="function"){var o=r;r=function(){var u=Vl(s);o.call(u)}}var s=w1(e,r,n,0,null,!1,!1,"",$p);return n._reactRootContainer=s,n[Yt]=s.current,Ro(n.nodeType===8?n.parentNode:n),ar(),s}for(;i=n.lastChild;)n.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var u=Vl(a);l.call(u)}}var a=od(n,0,!1,null,null,!1,!1,"",$p);return n._reactRootContainer=a,n[Yt]=a.current,Ro(n.nodeType===8?n.parentNode:n),ar(function(){ia(e,a,t,r)}),a}function la(n,e,t,r,i){var o=t._reactRootContainer;if(o){var s=o;if(typeof i=="function"){var l=i;i=function(){var a=Vl(s);l.call(a)}}ia(e,s,n,i)}else s=tM(t,e,n,i,r);return Vl(s)}Qy=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=Ki(e.pendingLanes);t!==0&&(Of(e,t|1),Ue(e,te()),!(V&6)&&(si=te()+500,bn()))}break;case 13:ar(function(){var r=Gt(n,1);if(r!==null){var i=Te();kt(r,n,1,i)}}),sd(n,1)}};Df=function(n){if(n.tag===13){var e=Gt(n,134217728);if(e!==null){var t=Te();kt(e,n,134217728,t)}sd(n,134217728)}};Yy=function(n){if(n.tag===13){var e=Nn(n),t=Gt(n,e);if(t!==null){var r=Te();kt(t,n,e,r)}sd(n,e)}};Gy=function(){return U};Xy=function(n,e){var t=U;try{return U=n,e()}finally{U=t}};rc=function(n,e,t){switch(e){case"input":if(Yu(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==n&&r.form===n.form){var i=Gl(r);if(!i)throw Error(N(90));Ty(r),Yu(r,i)}}}break;case"textarea":Ay(n,t);break;case"select":e=t.value,e!=null&&$r(n,!!t.multiple,e,!1)}};$y=td;By=ar;var nM={usingClientEntryPoint:!1,Events:[Go,Dr,Gl,Fy,Ly,td]},vi={findFiberByHostInstance:Kn,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},rM={bundleType:vi.bundleType,version:vi.version,rendererPackageName:vi.rendererPackageName,rendererConfig:vi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Zt.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=_y(n),n===null?null:n.stateNode},findFiberByHostInstance:vi.findFiberByHostInstance||eM,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Os=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Os.isDisabled&&Os.supportsFiber)try{Kl=Os.inject(rM),Tt=Os}catch{}}tt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=nM;tt.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ad(e))throw Error(N(200));return ZN(n,e,null,t)};tt.createRoot=function(n,e){if(!ad(n))throw Error(N(299));var t=!1,r="",i=v1;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=od(n,1,!1,null,null,t,!1,r,i),n[Yt]=e.current,Ro(n.nodeType===8?n.parentNode:n),new ld(e)};tt.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(N(188)):(n=Object.keys(n).join(","),Error(N(268,n)));return n=_y(e),n=n===null?null:n.stateNode,n};tt.flushSync=function(n){return ar(n)};tt.hydrate=function(n,e,t){if(!sa(e))throw Error(N(200));return la(null,n,e,!0,t)};tt.hydrateRoot=function(n,e,t){if(!ad(n))throw Error(N(405));var r=t!=null&&t.hydratedSources||null,i=!1,o="",s=v1;if(t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(o=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),e=w1(e,null,n,1,t??null,i,!1,o,s),n[Yt]=e.current,Ro(n),r)for(n=0;n<r.length;n++)t=r[n],i=t._getVersion,i=i(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,i]:e.mutableSourceEagerHydrationData.push(t,i);return new oa(e)};tt.render=function(n,e,t){if(!sa(e))throw Error(N(200));return la(null,n,e,!1,t)};tt.unmountComponentAtNode=function(n){if(!sa(n))throw Error(N(40));return n._reactRootContainer?(ar(function(){la(null,null,n,!1,function(){n._reactRootContainer=null,n[Yt]=null})}),!0):!1};tt.unstable_batchedUpdates=td;tt.unstable_renderSubtreeIntoContainer=function(n,e,t,r){if(!sa(t))throw Error(N(200));if(n==null||n._reactInternals===void 0)throw Error(N(38));return la(n,e,t,!1,r)};tt.version="18.2.0-next-9e3b772b8-20220608";function x1(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(x1)}catch(n){console.error(n)}}x1(),wy.exports=tt;var li=wy.exports,C1,Bp=li;C1=Bp.createRoot,Bp.hydrateRoot;const Zo=C.createContext(null),N1=C.createContext(null);function iM(n){const e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(n.editable),n.someProp("attributes",t=>{if(typeof t=="function"&&(t=t(n.state)),t)for(const r in t)r=="class"?e.class+=" "+t[r]:r=="style"?e.style=(e.style?e.style+";":"")+t[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(t[r]))}),e.translate||(e.translate="no"),[me.node(0,n.state.doc.content.size,e)]}const oM=[],sM={},Fc=W.empty;class Un{constructor(e){this.members=e}map(e,t){const r=this.members.map(i=>i.map(e,t,sM));return Un.from(r)}forChild(e,t){if(t.isLeaf)return W.empty;let r=[];for(let i=0;i<this.members.length;i++){const o=this.members[i].forChild(e,t);o!=Fc&&(o instanceof Un?r=r.concat(o.members):r.push(o))}return Un.from(r)}eq(e){if(!(e instanceof Un)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,r=!0;for(let i=0;i<this.members.length;i++){const o=this.members[i].localsInner(e);if(o.length)if(!t)t=o;else{r&&(t=t.slice(),r=!1);for(let s=0;s<o.length;s++)t.push(o[s])}}return t?lM(r?t:t.sort(M1)):oM}static from(e){switch(e.length){case 0:return Fc;case 1:return e[0];default:return new Un(e.every(t=>t instanceof W)?e:e.reduce((t,r)=>t.concat(r instanceof W?r:r.members),[]))}}}function M1(n,e){return n.from-e.from||n.to-e.to}function lM(n){let e=n;for(let t=0;t<e.length-1;t++){const r=e[t];if(r.from!=r.to)for(let i=t+1;i<e.length;i++){const o=e[i];if(o.from==r.from){o.to!=r.to&&(e==n&&(e=n.slice()),e[i]=o.copy(o.from,r.to),Vp(e,i+1,o.copy(r.to,o.to)));continue}else{o.from<r.to&&(e==n&&(e=n.slice()),e[t]=r.copy(r.from,o.from),Vp(e,i,r.copy(o.from,r.to)));break}}}return e}function Vp(n,e,t){for(;e<n.length&&M1(t,n[e])>0;)e++;n.splice(e,0,t)}function aM(n,e){const t=[];return n.someProp("decorations",r=>{const i=r(n.state);i&&i!=Fc&&t.push(i)}),e&&t.push(W.create(n.state.doc,[e])),Un.from(t)}const ud=function(n){for(let e=0;;e++)if(n=n.previousSibling,!n)return e},Jp=function(n){const e=n.assignedSlot||n.parentNode;return e&&e.nodeType==11?e.host:e},uM=function(n,e,t,r){return t&&(_p(n,e,t,r,-1)||_p(n,e,t,r,1))},cM=/^(img|br|input|textarea|hr)$/i;function _p(n,e,t,r,i){for(;;){if(n==t&&e==r)return!0;if(e==(i<0?0:Jl(n))){const o=n.parentNode;if(!o||o.nodeType!=1||dM(n)||cM.test(n.nodeName)||n.contentEditable=="false")return!1;e=ud(n)+(i<0?0:1),n=o}else if(n.nodeType==1){if(n=n.childNodes[e+(i<0?-1:0)],n.contentEditable=="false")return!1;e=i<0?Jl(n):0}else return!1}}function Jl(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function fM(n,e,t){for(let r=e==0,i=e==Jl(n);r||i;){if(n==t)return!0;const o=ud(n);if(n=n.parentNode,!n)return!1;r=r&&o==0,i=i&&o==Jl(n)}return!1}function dM(n){let e;for(let t=n;t&&!(e=t.pmViewDesc);t=t.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==n||e.contentDOM==n)}const E1=function(n){return n.focusNode&&uM(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)},O1=C.createContext(null);function hM(n,e){const t=C.useContext(O1);C.useLayoutEffect(()=>t(n),e)}function D1(n,e){const{view:t}=C.useContext(Zo);hM(()=>{if(t)return n(t)},e&&[t,...e])}const pM=C.forwardRef(function({widget:e,pos:t,...r},i){const[o,s]=C.useState(!0),l=C.useRef(null);return C.useImperativeHandle(i,()=>l.current,[]),D1(a=>{if(!a||!l.current)return;a.domObserver.disconnectSelection();const u=a.domSelection(),c=document.createRange(),f=l.current;f.nodeName=="IMG"&&f.parentNode?c.setEnd(f.parentNode,ud(f)+1):c.setEnd(f,0),c.collapse(!1),u.removeAllRanges(),u.addRange(c),s(!1),a.domObserver.connectSelection()},[]),o?I.jsx("img",{ref:l,className:"ProseMirror-separator","mark-placeholder":"true",alt:"",...r}):null});function mM(n,e){if(n==e)return!0;for(const t in n)if(n[t]!==e[t])return!1;for(const t in e)if(!(t in n))return!1;return!0}const gM={side:0};class Bo{constructor(e,t){this.Component=e,this.spec=t??gM,this.side=this.spec.side??0}map(e,t,r,i){const{pos:o,deleted:s}=e.mapResult(t.from+i,this.side<0?-1:1);return s?null:new me(o-r,o-r,this)}valid(){return!0}eq(e){return this==e||e instanceof Bo&&(this.spec.key&&this.spec.key==e.spec.key||this.Component==e.Component&&mM(this.spec,e.spec))}destroy(){}}function T1(n,e,t){return new me(n,n,new Bo(e,t))}function hu(){return Math.floor(Math.random()*16777215).toString(16)}const Vo=new Ho("@nytimes/react-prosemirror/reactKeys");function yM(){let n=!1;return new Ft({key:Vo,state:{init(e,t){const r={posToKey:new Map,keyToPos:new Map};return t.doc.descendants((i,o)=>{const s=hu();return r.posToKey.set(o,s),r.keyToPos.set(s,o),!0}),r},apply(e,t,r,i){if(!e.docChanged||n)return t;const o=e.getMeta(Vo),s=(o==null?void 0:o.type)==="bustKey"&&o.payload.key,l={posToKey:new Map,keyToPos:new Map},a=Array.from(t.posToKey.entries()).sort(([u],[c])=>u-c);for(const[u,c]of a){const{pos:f,deleted:d}=e.mapping.mapResult(u);if(d)continue;let p=c;s===c&&(p=hu()),l.posToKey.set(f,p),l.keyToPos.set(p,f)}return i.doc.descendants((u,c)=>{if(l.posToKey.has(c))return!0;const f=hu();return l.posToKey.set(c,f),l.keyToPos.set(f,c),!0}),l}},props:{handleDOMEvents:{compositionstart:()=>{n=!0},compositionend:()=>{n=!1}}}})}function pu(n,e,t={}){var s;if(e===null)return!1;const r=t.from??n.state.selection.from,i=t.to??n.state.selection.to;if(n.someProp("handleTextInput",l=>l(n,r,i,e)))return!0;const{tr:o}=n.state;if(t.marks&&o.ensureMarks(t.marks),o.insertText(e,r,i),t.bust){const l=n.state.doc.resolve(r),a=l.sharedDepth(i),u=l.start(a),c=(s=Vo.getState(n.state))==null?void 0:s.posToKey.get(u-1);o.setMeta(Vo,{type:"bustKey",payload:{key:c}})}return n.dispatch(o),!0}function SM(n){let e=null,t=null;return new Ft({props:{handleDOMEvents:{compositionstart(r){var s;const{state:i}=r;r.dispatch(i.tr.deleteSelection());const o=i.selection.$from;return i.selection.empty&&(i.storedMarks||!o.textOffset&&o.parentOffset&&((s=o.nodeBefore)!=null&&s.marks.some(l=>l.type.spec.inclusive===!1)))&&n(T1(i.selection.from,pM,{key:"cursor-wrapper",marks:i.storedMarks??o.marks()})),t=i.storedMarks??o.marks(),r.input.composing=!0,!0},compositionupdate(){return!0},compositionend(r){if(r.input.composing=!1,e!==null)return pu(r,e,{bust:!0,marks:t}),e=null,t=null,n(null),!0},beforeinput(r,i){var o,s;switch(i.preventDefault(),i.inputType){case"insertCompositionText":{if(i.data===null)break;e=i.data;break}case"insertReplacementText":{const l=i.getTargetRanges();(s=(o=i.dataTransfer)==null?void 0:o.items[0])==null||s.getAsString(a=>{for(const u of l){const c=r.posAtDOM(u.startContainer,u.startOffset,1),f=r.posAtDOM(u.endContainer,u.endOffset,1);pu(r,a,{from:c,to:f})}});break}case"insertText":{pu(r,i.data);break}case"deleteWordBackward":case"deleteContentBackward":case"deleteWordForward":case"deleteContentForward":case"deleteContent":{const l=i.getTargetRanges(),{tr:a}=r.state;for(const u of l){const c=r.posAtDOM(u.startContainer,u.startOffset),f=r.posAtDOM(u.endContainer,u.endOffset),{doc:d}=r.state,p=d.resolve(c).marksAcross(d.resolve(f));a.delete(c,f).setStoredMarks(p)}r.dispatch(a);break}}return!0}}}})}const Pt=typeof navigator<"u"?navigator:null,Wp=typeof document<"u"?document:null,zn=Pt&&Pt.userAgent||"",Lc=/Edge\/(\d+)/.exec(zn),R1=/MSIE \d/.exec(zn),$c=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(zn),aa=!!(R1||$c||Lc),kM=R1?document.documentMode:$c?+$c[1]:Lc?+Lc[1]:0,A1=!aa&&/gecko\/(\d+)/i.test(zn),wM=A1&&+(/Firefox\/(\d+)/.exec(zn)||[0,0])[1],Bc=!aa&&/Chrome\/(\d+)/.exec(zn),vM=!!Bc,xM=Bc?+Bc[1]:0,I1=!aa&&!!Pt&&/Apple Computer/.test(Pt.vendor),b1=I1&&(/Mobile\/\w+/.test(zn)||!!Pt&&Pt.maxTouchPoints>2),CM=b1||(Pt?/Mac/.test(Pt.platform):!1),NM=Pt?/Win/.test(Pt.platform):!1,MM=/Android \d/.test(zn),z1=!!Wp&&"webkitFontSmoothing"in Wp.documentElement.style,EM=z1?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,Ce={ie:aa,ie_version:kM,gecko:A1,gecko_version:wM,chrome:vM,chrome_version:xM,safari:I1,ios:b1,mac:CM,windows:NM,android:MM,webkit:z1,webkit_version:EM};function Up(n){return n.editable&&!n.hasFocus()?!1:OM(n)}function OM(n){var t,r;const e=n.domSelectionRange();if(!e.anchorNode)return!1;try{return n.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(n.editable||n.dom.contains(((t=e.focusNode)==null?void 0:t.nodeType)==3?(r=e.focusNode)==null?void 0:r.parentNode:e.focusNode))}catch{return!1}}function DM(n,e,t,r){return n.someProp("createSelectionBetween",i=>i(n,e,t))||$.between(e,t,r)}function Hp(n,e=null){const t=n.domSelectionRange(),r=n.state.doc;if(!t.focusNode)return null;let i=n.docView.nearestDesc(t.focusNode);const o=i&&i.size==0,s=n.docView.posFromDOM(t.focusNode,t.focusOffset,1);if(s<0)return null;const l=r.resolve(s);let a,u;if(E1(t)){for(a=l;i&&!i.node;)i=i.parent;const c=i.node;if(i&&c.isAtom&&z.isSelectable(c)&&i.parent&&!(c.isInline&&fM(t.focusNode,t.focusOffset,i.dom))){const f=i.posBefore;u=new z(s==f?l:r.resolve(f))}}else{const c=n.docView.posFromDOM(t.anchorNode,t.anchorOffset,1);if(c<0)return null;a=r.resolve(c)}if(!u){const c=e=="pointer"||n.state.selection.head<l.pos&&!o?1:-1;u=DM(n,a,l,c)}return u}const _l=function(n,e,t,r){return t&&(jp(n,e,t,r,-1)||jp(n,e,t,r,1))};function TM(n){let e;for(let t=n;t&&!(e=t.pmViewDesc);t=t.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==n||e.contentDOM==n)}const RM=/^(img|br|input|textarea|hr)$/i;function jp(n,e,t,r,i){for(;;){if(n==t&&e==r)return!0;if(e==(i<0?0:Kp(n))){const o=n.parentNode;if(!o||o.nodeType!=1||TM(n)||RM.test(n.nodeName)||n.contentEditable=="false")return!1;e=sn(n)+(i<0?0:1),n=o}else if(n.nodeType==1){if(n=n.childNodes[e+(i<0?-1:0)],n.contentEditable=="false")return!1;e=i<0?Kp(n):0}else return!1}}const sn=function(n){let e=n;for(let t=0;;t++)if(e=e.previousSibling,!e)return t};function Kp(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function AM(n,e){const t=n;if(e instanceof z){const r=t.docView.descAt(e.from);r!=t.lastSelectedViewDesc&&(qp(t),r&&r.selectNode(),t.lastSelectedViewDesc=r)}else qp(t)}function qp(n){const e=n;e.lastSelectedViewDesc&&(e.lastSelectedViewDesc.parent&&e.lastSelectedViewDesc.deselectNode(),e.lastSelectedViewDesc=void 0)}function IM(n){const e=n,t=e.domSelectionRange();if(!t.anchorNode)return!1;try{return e.dom.contains(t.anchorNode.nodeType==3?t.anchorNode.parentNode:t.anchorNode)&&(e.editable||e.dom.contains(t.focusNode.nodeType==3?t.focusNode.parentNode:t.focusNode))}catch{return!1}}function P1(n){return n.editable?n.hasFocus():IM(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function bM(n){const e=n,t=e.domSelection(),r=document.createRange(),i=e.cursorWrapper.dom,o=i.nodeName=="IMG";o?r.setEnd(i.parentNode,sn(i)+1):r.setEnd(i,0),r.collapse(!1),t.removeAllRanges(),t.addRange(r),!o&&!e.state.selection.visible&&Ce.ie&&Ce.ie_version<=11&&(i.disabled=!0,i.disabled=!1)}function Qp(n,e){const t=n,{node:r,offset:i}=t.docView.domFromPos(e,0),o=i<r.childNodes.length?r.childNodes[i]:null,s=i?r.childNodes[i-1]:null;if(Ce.safari&&o&&o.contentEditable=="false")return mu(o);if((!o||o.contentEditable=="false")&&(!s||s.contentEditable=="false")){if(o)return mu(o);if(s)return mu(s)}}function mu(n){return n.contentEditable="true",Ce.safari&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function Yp(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function zM(n){const e=n,t=e.dom.ownerDocument;t.removeEventListener("selectionchange",e.input.hideSelectionGuard);const r=e.domSelectionRange(),i=r.anchorNode,o=r.anchorOffset;t.addEventListener("selectionchange",e.input.hideSelectionGuard=()=>{(r.anchorNode!=i||r.anchorOffset!=o)&&(t.removeEventListener("selectionchange",e.input.hideSelectionGuard),setTimeout(()=>{(!P1(e)||e.state.selection.visible)&&e.dom.classList.remove("ProseMirror-hideselection")},20))})}const Gp=Ce.safari||Ce.chrome&&Ce.chrome_version<63;function Ds(n,e=!1){const t=n,r=t.state.selection;if(AM(t,r),!!P1(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&Ce.chrome){const i=t.domSelectionRange(),o=t.domObserver.currentSelection;if(i.anchorNode&&o.anchorNode&&_l(i.anchorNode,i.anchorOffset,o.anchorNode,o.anchorOffset)){t.input.mouseDown.delayedSelectionSync=!0,t.domObserver.setCurSelection();return}}if(t.domObserver.disconnectSelection(),t.cursorWrapper)bM(t);else{const{anchor:i,head:o}=r;let s,l;Gp&&!(r instanceof $)&&(r.$from.parent.inlineContent||(s=Qp(t,r.from)),!r.empty&&!r.$from.parent.inlineContent&&(l=Qp(t,r.to))),t.docView.setSelection(i,o,t.root,e),Gp&&(s&&Yp(s),l&&Yp(l)),r.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&zM(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}class PM{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class FM{constructor(e){this.view=e,this.flushingSoon=-1,this.currentSelection=new PM,this.suppressingSelectionUpdates=!1,this.view=e,this.onSelectionChange=this.onSelectionChange.bind(this)}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}stop(){this.disconnectSelection()}start(){this.connectSelection()}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;const t=new Set;let r;for(let o=e.focusNode;o;o=Jp(o))t.add(o);for(let o=e.anchorNode;o;o=Jp(o))if(t.has(o)){r=o;break}const i=r&&this.view.docView.nearestDesc(r);if(i&&i.ignoreMutation({type:"selection",target:(r==null?void 0:r.nodeType)==3?r==null?void 0:r.parentNode:r}))return this.setCurSelection(),!0}registerMutation(){}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}updateSelection(){const{view:e}=this,t=e.input.compositionPendingChanges||(e.composing?e.input.compositionID:0);e.input.compositionPendingChanges=0;const r=e.input.lastSelectionTime>Date.now()-50?e.input.lastSelectionOrigin:null,i=Hp(e,r);if(i&&!e.state.selection.eq(i)){const o=e.state.tr.setSelection(i);r=="pointer"?o.setMeta("pointer",!0):r=="key"&&o.scrollIntoView(),t&&o.setMeta("composition",t),e.dispatch(o)}}selectionToDOM(){const{view:e}=this;Ds(e);const t=e.domSelectionRange();this.currentSelection.set(t)}flush(){const{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;const t=e.domSelectionRange(),r=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(t)&&Up(e)&&!this.ignoreSelectionChange(t);let i=null;r&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&E1(t)&&(i=Hp(e))&&i.eq(P.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,Ds(e),this.currentSelection.set(t),e.scrollToSelection()):r&&(this.updateSelection(),this.currentSelection.eq(t)||Ds(e),this.currentSelection.set(t))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}onSelectionChange(){if(Up(this.view)&&!this.view.composing){if(this.suppressingSelectionUpdates)return Ds(this.view);if(Ce.ie&&Ce.ie_version<=11&&!this.view.state.selection.empty){const e=this.view.domSelectionRange();if(e.focusNode&&_l(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}}const ai=0,Xp=1,Ts=2,Jo=3;class es{constructor(e,t,r,i){this.parent=e,this.children=t,this.dom=r,this.contentDOM=i,this.dirty=ai,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){}posBeforeChild(e){for(let t=0,r=this.posAtStart;;t++){const i=this.children[t];if(i==e)return r;r+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let o,s;if(e==this.contentDOM)o=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.previousSibling}for(;o&&!((s=o.pmViewDesc)&&s.parent==this);)o=o.previousSibling;return o?this.posBeforeChild(s)+s.size:this.posAtStart}else{let o,s;if(e==this.contentDOM)o=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.nextSibling}for(;o&&!((s=o.pmViewDesc)&&s.parent==this);)o=o.nextSibling;return o?this.posBeforeChild(s):this.posAtEnd}let i;if(e==this.dom&&this.contentDOM)i=t>sn(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(t==0)for(let o=e;;o=o.parentNode){if(o==this.dom){i=!1;break}if(o.previousSibling)break}if(i==null&&t==e.childNodes.length)for(let o=e;;o=o.parentNode){if(o==this.dom){i=!0;break}if(o.nextSibling)break}}return i??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,t=!1){for(let r=!0,i=e;i;i=i.parentNode){const o=this.getDesc(i);let s;if(o&&(!t||o.node))if(r&&(s=o.nodeDOM)&&!(s.nodeType==1?s.contains(e.nodeType==1?e:e.parentNode):s==e))r=!1;else return o}}getDesc(e){const t=e.pmViewDesc;for(let r=t;r;r=r.parent)if(r==this)return t}posFromDOM(e,t,r){for(let i=e;i;i=i.parentNode){const o=this.getDesc(i);if(o)return o.localPosFromDOM(e,t,r)}return-1}descAt(e){for(let t=0,r=0;t<this.children.length;t++){let i=this.children[t];const o=r+i.size;if(r==e&&o!=r){for(;!i.border&&i.children.length;)i=i.children[0];return i}if(e<o)return i.descAt(e-r-i.border);r=o}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,i=0;for(let o=0;r<this.children.length;r++){const s=this.children[r],l=o+s.size;if(l>e||s instanceof dd){i=e-o;break}o=l}if(i)return this.children[r].domFromPos(i-this.children[r].border,t);for(let o;r&&!(o=this.children[r-1]).size&&o instanceof cd&&o.side>=0;r--);if(t<=0){let o,s=!0;for(;o=r?this.children[r-1]:null,!(!o||o.dom.parentNode==this.contentDOM);r--,s=!1);return o&&t&&s&&!o.border&&!o.domAtom?o.domFromPos(o.size,t):{node:this.contentDOM,offset:o?sn(o.dom)+1:0}}else{let o,s=!0;for(;o=r<this.children.length?this.children[r]:null,!(!o||o.dom.parentNode==this.contentDOM);r++,s=!1);return o&&s&&!o.border&&!o.domAtom?o.domFromPos(0,t):{node:this.contentDOM,offset:o?sn(o.dom):this.contentDOM.childNodes.length}}}parseRange(e,t,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,o=-1;for(let s=r,l=0;;l++){const a=this.children[l],u=s+a.size;if(i==-1&&e<=u){const c=s+a.border;if(e>=c&&t<=u-a.border&&a.node&&a.contentDOM&&this.contentDOM.contains(a.contentDOM))return a.parseRange(e,t,c);e=s;for(let f=l;f>0;f--){const d=this.children[f-1];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(1)){i=sn(d.dom)+1;break}e-=d.size}i==-1&&(i=0)}if(i>-1&&(u>t||l==this.children.length-1)){t=u;for(let c=l+1;c<this.children.length;c++){const f=this.children[c];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(-1)){o=sn(f.dom);break}t+=f.size}o==-1&&(o=this.contentDOM.childNodes.length);break}s=u}return{node:this.contentDOM,from:e,to:t,fromOffset:i,toOffset:o}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;const t=this.children[e<0?0:this.children.length-1];return t.size==0||t.emptyChildAt(e)}domAfterPos(e){const{node:t,offset:r}=this.domFromPos(e,0);if(t.nodeType!=1||r==t.childNodes.length)throw new RangeError("No node after pos "+e);return t.childNodes[r]}setSelection(e,t,r,i=!1){var d;const o=Math.min(e,t),s=Math.max(e,t);for(let p=0,h=0;p<this.children.length;p++){const m=this.children[p],k=h+m.size;if(o>h&&s<k)return m.setSelection(e-h-m.border,t-h-m.border,r,i);h=k}let l=this.domFromPos(e,e?-1:1),a=t==e?l:this.domFromPos(t,t?-1:1);const u=r.getSelection();let c=!1;if((Ce.gecko||Ce.safari)&&e==t){const{node:p,offset:h}=l;if(p.nodeType==3){if(c=!!(h&&((d=p.nodeValue)==null?void 0:d[h-1])==`
`),c&&h==p.nodeValue.length)for(let m=p,k;m;m=m.parentNode){if(k=m.nextSibling){k.nodeName=="BR"&&(l=a={node:k.parentNode,offset:sn(k)+1});break}const g=m.pmViewDesc;if(g&&g.node&&g.node.isBlock)break}}else{const m=p.childNodes[h-1];c=m&&(m.nodeName=="BR"||m.contentEditable=="false")}}if(Ce.gecko&&u.focusNode&&u.focusNode!=a.node&&u.focusNode.nodeType==1){const p=u.focusNode.childNodes[u.focusOffset];p&&p.contentEditable=="false"&&(i=!0)}if(!(i||c&&Ce.safari)&&_l(l.node,l.offset,u.anchorNode,u.anchorOffset)&&_l(a.node,a.offset,u.focusNode,u.focusOffset))return;let f=!1;if((u.extend||e==t)&&!c){u.collapse(l.node,l.offset);try{e!=t&&u.extend(a.node,a.offset),f=!0}catch{}}if(!f){if(e>t){const h=l;l=a,a=h}const p=document.createRange();p.setEnd(a.node,a.offset),p.setStart(l.node,l.offset),u.removeAllRanges(),u.addRange(p)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let r=0,i=0;i<this.children.length;i++){const o=this.children[i],s=r+o.size;if(r==s?e<=s&&t>=r:e<s&&t>r){const l=r+o.border,a=s-o.border;if(e>=l&&t<=a){this.dirty=e==r||t==s?Ts:Xp,e==l&&t==a&&(o.contentLost||o.dom.parentNode!=this.contentDOM)?o.dirty=Jo:o.markDirty(e-l,t-l);return}else o.dirty=o.dom==o.contentDOM&&o.dom.parentNode==this.contentDOM&&!o.children.length?Ts:Jo}r=s}this.dirty=Ts}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){const r=e==1?Ts:Xp;t.dirty<r&&(t.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}}class cd extends es{constructor(e,t,r){super(e,[],r,null),this.widget=t,this.widget=t}matchesWidget(e){return this.dirty==ai&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){const t=this.widget.spec.stopEvent;return t?t(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}get domAtom(){return!0}get side(){return this.widget.type.side}}class LM extends es{constructor(e,t,r,i){super(e,[],t,null),this.textDOM=r,this.text=i}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class $M extends es{constructor(e,t,r,i,o){super(e,t,i,o),this.mark=r}parseRule(){return this.dirty&Jo||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=Jo&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),this.dirty!=ai){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=ai}}}class fd extends es{constructor(e,t,r,i,o,s,l,a){super(e,t,s,l),this.node=r,this.outerDeco=i,this.innerDeco=o,this.nodeDOM=a}updateOuterDeco(){}parseRule(){if(this.node.type.spec.reparseInView)return null;const e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let t=this.children.length-1;t>=0;t--){const r=this.children[t];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>v.empty)}return e}matchesNode(e,t,r){return this.dirty==ai&&e.eq(this.node)&&VM(t,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}update(e,t,r,i){return!0}selectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable")}get domAtom(){return this.node.isAtom}}class BM extends fd{constructor(e,t,r,i,o,s,l){super(e,t,r,i,o,s,null,l)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,r,i){return!0}inParent(){const e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,r){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}markDirty(e,t){super.markDirty(e,t),this.dom!=this.nodeDOM&&(e==0||t==this.nodeDOM.nodeValue.length)&&(this.dirty=Jo)}get domAtom(){return!1}}class dd extends es{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==ai&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}function VM(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].type.eq(e[t].type))return!1;return!0}function JM(n){const e={};for(const[r,i]of n.entries()){let o=function(s,l){for(const a of i){let u=!1;if(li.unstable_batchedUpdates(()=>{u=!!a.call(this,s,l)}),u||l.defaultPrevented)return!0}return!1};e[r]=o}return new Ft({key:new Ho("@nytimes/react-prosemirror/componentEventListeners"),props:{handleDOMEvents:e}})}function _M(){const[n,e]=C.useState(new Map),t=C.useCallback((o,s)=>{const l=n.get(o)??[];l.unshift(s),n.has(o)||(n.set(o,l),e(new Map(n)))},[n]),r=C.useCallback((o,s)=>{const l=n.get(o);l==null||l.splice(l.indexOf(s),1)},[n]),i=C.useMemo(()=>JM(n),[n]);return{registerEventListener:t,unregisterEventListener:r,componentEventListenersPlugin:i}}function F1(){const[,n]=C.useReducer(e=>e+1,0);return n}class WM extends kv{constructor(e,t){super(e,{state:cn.create({schema:t.state.schema,plugins:t.state.plugins}),plugins:t.plugins}),this.shouldUpdatePluginViews=!1,this.shouldUpdatePluginViews=!0,this._props=t,this.oldProps={state:t.state},this.state=t.state,this.domObserver.stop(),this.domObserver=new FM(this),this.domObserver.start(),this.docView.dom.replaceChildren(),this.docView=t.docView}pureSetProps(e){this._props={...this._props,...e},this.state=this._props.state}runPendingEffects(){const e=this.props;this._props=this.oldProps,this.state=this._props.state,this.update(e)}update(e){super.update(e),this.oldProps=e}updatePluginViews(e){this.shouldUpdatePluginViews&&super.updatePluginViews(e)}destroy(){this.dom=document.createElement("div"),super.destroy()}}const UM=new Cm({nodes:{doc:{content:"text*"},text:{inline:!0}}}),HM=cn.create({schema:UM});function jM(n,e){const[t,r]=C.useState(null),[i,o]=C.useState(null),s=F1(),l=e.defaultState??HM,[a,u]=C.useState(l),c=e.state??a,{componentEventListenersPlugin:f,registerEventListener:d,unregisterEventListener:p}=_M(),h=C.useCallback(x=>{li.flushSync(()=>{o(x)})},[]),m=C.useMemo(()=>[...e.plugins??[],f,SM(h)],[e.plugins,f,h]);function k(x){li.flushSync(()=>{e.state||u(M=>M.apply(x)),e.dispatchTransaction&&e.dispatchTransaction.call(this,x)})}const g=document.createElement("div"),y=C.useRef(new fd(void 0,[],c.doc,[],W.empty,g,null,g)),S={...e,state:c,plugins:m,dispatchTransaction:k,docView:y.current};return C.useEffect(()=>()=>{t==null||t.destroy()},[t]),C.useLayoutEffect(()=>{if(t&&t.dom!==n&&r(null),!!n&&!t){const x=new WM({mount:n},S);r(x),x.dom.addEventListener("compositionend",s);return}}),t==null||t.pureSetProps(S),C.useMemo(()=>({view:t,state:c,registerEventListener:d,unregisterEventListener:p,cursorWrapper:i,docViewDescRef:y}),[t,c,d,p,i])}function KM(n){C.useLayoutEffect(()=>{n==null||n.domObserver.selectionToDOM(),n==null||n.runPendingEffects()},[n,n==null?void 0:n.props])}function qM({children:n}){const e=C.useRef(new Set).current,t=C.useRef(new Set).current,r=C.useRef(!1),i=F1(),o=C.useRef(!0),s=C.useCallback(()=>{o.current||(i(),o.current=!0)},[i]),l=C.useCallback(a=>{let u;const c=()=>{u=a()};return e.add(c),s(),()=>{e.delete(c),u&&(r.current?(t.add(u),s()):u())}},[e,t,s]);return C.useLayoutEffect(()=>(o.current=!1,e.forEach(a=>a()),e.clear(),()=>{t.forEach(a=>a()),t.clear()})),C.useLayoutEffect(()=>(r.current=!0,()=>{r.current=!1}),[]),I.jsx(O1.Provider,{value:l,children:n})}const dt=C.createContext([]);function L1(n,e,t,r,i,o,s){const l=C.useRef(o),a=C.useContext(dt),u=[];return C.useLayoutEffect(()=>{if(!n||!t.current)return;const c=u[0];l.current?(l.current.parent=void 0,l.current.children=u,l.current.node=n,l.current.outerDeco=i,l.current.innerDeco=r,l.current.dom=(e==null?void 0:e.current)??t.current,l.current.dom.pmViewDesc=l.current,l.current.contentDOM=(s==null?void 0:s.current)??l.current.contentDOM??(c==null?void 0:c.dom.parentElement)??null,l.current.nodeDOM=t.current):l.current=new fd(void 0,u,n,i,r,(e==null?void 0:e.current)??t.current,(c==null?void 0:c.dom.parentElement)??null,t.current),a.push(l.current);for(const f of u)f.parent=l.current}),u}function QM(n,e){return n.type.side-e.type.side}function YM(n,e,t,r){const i=e.locals(n);let o=0;if(i.length==0){for(let u=0;u<n.childCount;u++){const c=n.child(u);r(c,i,e.forChild(o,c),o,u),o+=c.nodeSize}return}let s=0;const l=[];let a=null;for(let u=0;;){if(s<i.length&&i[s].to==o){const h=i[s++];let m;for(;s<i.length&&i[s].to==o;)(m||(m=[h])).push(i[s++]);if(m){m.sort(QM);for(let k=0;k<m.length;k++)t(m[k],!(m[k].type instanceof Bo),o,u+k,!!a)}else t(h,!(h.type instanceof Bo),o,u,!!a)}let c,f;if(a)f=-1,c=a,a=null;else if(u<n.childCount)f=u,c=n.child(u++);else break;for(let h=0;h<l.length;h++)l[h].to<=o&&l.splice(h--,1);for(;s<i.length&&i[s].from<=o&&i[s].to>o;)l.push(i[s++]);let d=o+c.nodeSize;if(c.isText){let h=d;s<i.length&&i[s].from<h&&(h=i[s].from);for(let m=0;m<l.length;m++)l[m].to<h&&(h=l[m].to);h<d&&(a=c.cut(h-o),c=c.cut(0,h-o),d=h,f=-1)}const p=c.isInline&&!c.isLeaf?l.filter(h=>!h.inline):l.slice();r(c,p,e.forChild(o,c),o,f),o=d}}function ua(){const{state:n}=C.useContext(Zo);return n}function $1(){const n=ua();return n&&Vo.getState(n)}var B1={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(n){(function(){var e={}.hasOwnProperty;function t(){for(var r=[],i=0;i<arguments.length;i++){var o=arguments[i];if(o){var s=typeof o;if(s==="string"||s==="number")r.push(o);else if(Array.isArray(o)){if(o.length){var l=t.apply(null,o);l&&r.push(l)}}else if(s==="object"){if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]")){r.push(o.toString());continue}for(var a in o)e.call(o,a)&&o[a]&&r.push(a)}}}return r.join(" ")}n.exports?(t.default=t,n.exports=t):window.classNames=t})()})(B1);var GM=B1.exports;const XM=j1(GM);function ZM(n){return n.replaceAll(/-[a-z]/g,e=>{var t;return((t=e[1])==null?void 0:t.toUpperCase())??""})}function eE(n){const e=new CSSStyleSheet;e.insertRule(`* { ${n} }`);const r=e.cssRules[0].style,i={};for(let o=0;o<r.length;o++){const s=r.item(o),l=r.getPropertyValue(s),a=s.startsWith("--")?s:ZM(s);i[a]=l}return i}function V1(n,e){return{...n,...e,className:XM(n.className,e.className),style:{...n.style,...e.style}}}function J1(n){const e={};for(const[t,r]of Object.entries(n))switch(t.toLowerCase()){case"class":{e.className=r;break}case"style":{e.style=eE(r);break}case"autocapitalize":{e.autoCapitalize=r;break}case"contenteditable":{if(r===""||r==="true"){e.contentEditable=!0;break}if(r==="false"){e.contentEditable=!1;break}if(r==="plaintext-only"){e.contentEditable="plaintext-only";break}e.contentEditable=null;break}case"draggable":{e.draggable=r!=null;break}case"enterkeyhint":{e.enterKeyHint=r;break}case"for":{e.htmlFor=r;break}case"hidden":{e.hidden=r;break}case"inputmode":{e.inputMode=r;break}case"itemprop":{e.itemProp=r;break}case"spellcheck":{if(r===""||r==="true"){e.spellCheck=!0;break}if(r==="false"){e.spellCheck=!1;break}e.spellCheck=null;break}case"tabindex":{const i=parseInt(r,10);Number.isNaN(i)||(e.tabIndex=i);break}case"autocomplete":{e.autoComplete=r;break}case"autofocus":{e.autoFocus=r!=null;break}case"formaction":{e.formAction=r;break}case"formenctype":{e.formEnctype=r;break}case"formmethod":{e.formMethod=r;break}case"formnovalidate":{e.formNoValidate=r;break}case"formtarget":{e.formTarget=r;break}case"maxlength":{const i=parseInt(r,10);Number.isNaN(i)||(e.maxLength=r);break}case"minlength":{const i=parseInt(r,10);Number.isNaN(i)||(e.minLength=r);break}case"max":{const i=parseInt(r,10);Number.isNaN(i)||(e.max=r);break}case"min":{const i=parseInt(r,10);Number.isNaN(i)||(e.min=r);break}case"multiple":{e.multiple=r!=null;break}case"readonly":{e.readOnly=r!=null;break}case"required":{e.required=r!=null;break}case"size":{const i=parseInt(r,10);Number.isNaN(i)||(e.size=r);break}case"step":{if(r==="any"){e.step=r;break}const i=parseInt(r,10);!Number.isNaN(i)&&i>0&&(e.step=r);break}case"disabled":{e.disabled=r!=null;break}case"rows":{const i=parseInt(r,10);Number.isNaN(i)||(e.rows=r);break}default:{e[t]=r;break}}return e}const hd=C.forwardRef(function({outputSpec:e,children:t,...r},i){if(typeof e=="string")return I.jsx(I.Fragment,{children:e});if(!Array.isArray(e))throw new Error("@nytimes/react-prosemirror only supports strings and arrays in toDOM");const s=e[0].replace(" ",":"),l=e[1];let a={ref:i,...r},u=1;l&&typeof l=="object"&&l.nodeType==null&&!Array.isArray(l)&&(u=2,a=V1(J1(l),a));const c=[];for(let f=u;f<e.length;f++){const d=e[f];if(d===0){if(f<e.length-1||f>u)throw new RangeError("Content hole must be the only child of its parent node");return C.createElement(s,a,t)}c.push(I.jsx(hd,{ref:void 0,outputSpec:d,children:t}))}return C.createElement(s,a,...c)}),_1=C.forwardRef(function({mark:e,children:t},r){var a,u;const i=C.useContext(dt),o=[],s=C.useRef(null);C.useImperativeHandle(r,()=>s.current,[]);const l=(u=(a=e.type.spec).toDOM)==null?void 0:u.call(a,e,!0);if(!l)throw new Error(`Mark spec for ${e.type.name} is missing toDOM`);return C.useLayoutEffect(()=>{if(!s.current)return;const c=o[0],f=new $M(void 0,o,e,s.current,(c==null?void 0:c.dom.parentElement)??s.current);i.push(f);for(const d of o)d.parent=f}),I.jsx(hd,{ref:s,outputSpec:l,children:I.jsx(dt.Provider,{value:o,children:t})})});function tE({widget:n,pos:e}){const t=C.useContext(dt),r=C.useRef(null),i=C.useRef(e);return i.current=e,D1(o=>{if(!r.current)return;const s=n.type.toDOM;let l=typeof s=="function"?s(o,()=>i.current):s;if(!n.type.spec.raw){if(l.nodeType!=1){const a=document.createElement("span");a.appendChild(l),l=a}l.contentEditable="false",l.classList.add("ProseMirror-widget")}r.current.firstElementChild!==l&&r.current.replaceChildren(l)}),C.useLayoutEffect(()=>{if(!r.current)return;const o=new cd(void 0,n,r.current);t.push(o)}),I.jsx("span",{ref:r})}function W1({outerDeco:n,pos:e,node:t,innerDeco:r,...i}){var D,R;const o=C.useRef(null),s=C.useRef(null),l=C.useRef(null),a=C.useRef(t),u=C.useRef(n),c=C.useRef(r),f=C.useRef(e);f.current=e;const d=C.useRef(null),p=C.useRef(null),h=ua(),{nodeViews:m}=C.useContext(N1),{view:k}=C.useContext(Zo);let g=null;const y=m[t.type.name],S=k==null?void 0:k.someProp("nodeViews",E=>E==null?void 0:E[t.type.name]);C.useLayoutEffect(()=>{if(!p.current||!d.current)return;const{dom:E}=p.current;return s.current=d.current,d.current.appendChild(E),()=>{var b,ne;(ne=(b=p.current)==null?void 0:b.destroy)==null||ne.call(b)}},[]),C.useLayoutEffect(()=>{if(!S||!p.current)return;const{destroy:E,update:b}=p.current;if(((b==null?void 0:b.call(p.current,t,n,r))??!0)||(E==null||E.call(p.current),!d.current))return;a.current=t,u.current=n,c.current=r,p.current=S(a.current,k,()=>f.current,u.current,c.current);const{dom:Lt}=p.current;s.current=d.current,d.current.appendChild(Lt)},[S,k,r,t,n]);const x=L1(t,o,s,r,n,void 0,l);if(y)g=I.jsx(y,{...i,ref:s,nodeProps:{node:t,pos:e,decorations:n,innerDecorations:r,isSelected:(h==null?void 0:h.selection)instanceof z&&h.selection.node===t},children:I.jsx(co,{pos:e,node:t,innerDecorations:r})});else if(S){p.current||(p.current=S(a.current,k,()=>f.current,u.current,c.current));const{contentDOM:E}=p.current;l.current=E??null,g=C.createElement(t.isInline?"span":"div",{ref:d,contentEditable:!!E,suppressContentEditableWarning:!0},E&&li.createPortal(I.jsx(co,{pos:e,node:t,innerDecorations:r}),E))}else{const E=(R=(D=t.type.spec).toDOM)==null?void 0:R.call(D,t);E&&(g=I.jsx(hd,{...i,ref:s,outputSpec:E,children:I.jsx(co,{pos:e,node:t,innerDecorations:r})}))}if(!g)throw new Error(`Node spec for ${t.type.name} is missing toDOM`);const M=C.cloneElement(n.reduce(pd,g),n.some(E=>E.type.attrs.nodeName)?{ref:o}:void 0),O=t.marks.reduce((E,b)=>I.jsx(_1,{mark:b,children:E}),M);return I.jsx(dt.Provider,{value:x,children:C.cloneElement(O,t.marks.length||n.some(E=>E.type.attrs.nodeName)?{ref:o}:void 0)})}function nE(){const n=C.useContext(dt),e=C.useRef(null),[t,r]=C.useState(!1);return C.useLayoutEffect(()=>{var s;const i=n[n.length-1];if((Ce.safari||Ce.chrome)&&((s=i==null?void 0:i.dom)==null?void 0:s.contentEditable)=="false"){r(!0);return}if(!e.current)return;const o=new dd(void 0,[],e.current,null);n.push(o)}),t?I.jsx("img",{ref:e,className:"ProseMirror-separator"}):null}class rE extends C.Component{constructor(){super(...arguments),this.viewDescRef=null}updateEffect(){const{decorations:e,siblingDescriptors:t,node:r}=this.props,i=li.findDOMNode(this);if(!i)return;let o=i;for(;o.firstChild;)o=o.firstChild;!this.viewDescRef||this.viewDescRef instanceof LM?this.viewDescRef=new BM(void 0,[],r,e,W.empty,i,o):(this.viewDescRef.parent=void 0,this.viewDescRef.children=[],this.viewDescRef.node=r,this.viewDescRef.outerDeco=e,this.viewDescRef.innerDeco=W.empty,this.viewDescRef.dom=i,this.viewDescRef.dom.pmViewDesc=this.viewDescRef,this.viewDescRef.nodeDOM=o),t.push(this.viewDescRef)}componentDidMount(){this.updateEffect()}componentDidUpdate(){this.updateEffect()}render(){const{node:e,decorations:t}=this.props;return t.reduce(pd,e.text)}}function iE(){const n=C.useContext(dt),e=C.useRef(null);return C.useLayoutEffect(()=>{if(!e.current)return;const t=new dd(void 0,[],e.current,null);n.push(t)}),I.jsx("br",{ref:e,className:"ProseMirror-trailingBreak"})}function oE({widget:n,pos:e}){const t=C.useContext(dt),r=C.useRef(null);C.useLayoutEffect(()=>{if(!r.current)return;const o=new cd(void 0,n,r.current);t.push(o)});const{Component:i}=n.type;return i&&I.jsx(i,{ref:r,widget:n,pos:e,contentEditable:!1})}function pd(n,e){const{nodeName:t,...r}=e.type.attrs,i=J1(r);return t||typeof n=="string"?C.createElement(t??"span",i,n):C.cloneElement(n,V1(n.props,i))}function Vc({innerPos:n,childViews:e}){const{view:t}=C.useContext(Zo),r=ua(),i=$1(),o=e.reduce((s,l)=>{var c;const a=s[s.length-1];if(!a)return[[l]];const u=a[a.length-1];return u?!l.marks.length&&!u.marks.length||l.marks.length&&u.marks.length&&((c=l.marks[0])!=null&&c.eq(u.marks[0]))?[...s.slice(0,s.length-1),[...a.slice(0,a.length),l]]:[...s,[l]]:[...s.slice(0,s.length),[l]]},[]);return I.jsx(I.Fragment,{children:o.map(s=>{const l=s[0];if(!l)return null;const a=l.marks[0];return a?I.jsx(_1,{mark:a,children:I.jsx(Vc,{innerPos:n,childViews:s.map(u=>({...u,marks:u.marks.slice(1)}))},uo(r==null?void 0:r.doc,n,l,i==null?void 0:i.posToKey))},uo(r==null?void 0:r.doc,n,l,i==null?void 0:i.posToKey)):s.map(u=>{const c=n+u.offset,f=u.type==="widget"?I.jsx(oE,{widget:u.widget,pos:c}):u.type==="native-widget"?I.jsx(tE,{widget:u.widget,pos:c}):u.node.isText?I.jsx(dt.Consumer,{children:d=>I.jsx(rE,{view:t,node:u.node,pos:c,siblingDescriptors:d,decorations:u.outerDeco})}):I.jsx(W1,{node:u.node,pos:c,outerDeco:u.outerDeco,innerDeco:u.innerDeco});return C.cloneElement(f,{key:uo(r==null?void 0:r.doc,n,u,i==null?void 0:i.posToKey)})})})})}function uo(n,e,t,r){const i=e+t.offset,o=r==null?void 0:r.get(i);if(t.type==="widget"||t.type==="native-widget")return t.widget.type.spec.key?t.widget.type.spec.key:(console.warn(`Widget at position ${i} doesn't have a key specified. This has negative performance implications.`),`${o}-${t.index}`);if(o)return o;if(!n)return i;const s=n.resolve(i).start()-1,l=r==null?void 0:r.get(s);return l?`${l}-${t.offset}`:i}function sE(n){const e=n[n.length-1];if((e==null?void 0:e.type)!=="widget"&&(e==null?void 0:e.type)!=="native-widget"||e.widget.type.side>=0)return;let t=null;for(let i=n.length-2;i>=0;i--){const o=n[i];if((o==null?void 0:o.type)==="node"){t=o;break}}if(!t||!t.node.isInline)return;const r=t.marks;e.marks=e.marks.reduce((i,o)=>o.addToSet(i),r)}function lE(n){const e=n[n.length-1];if((e==null?void 0:e.type)!=="node"||!e.node.isInline)return;const t=e.marks;for(let r=n.length-2;r>=0;r--){const i=n[r];if((i==null?void 0:i.type)!=="widget"&&(i==null?void 0:i.type)!=="native-widget"||i.widget.type.side<0)break;i.marks=i.marks.reduce((o,s)=>s.addToSet(o),t)}}function aE(n,e,t,r){return n.length?n.every(i=>i.type!=="node"||i.node.isInline)?[I.jsx(Vc,{childViews:n,innerPos:e},uo(t,e,n[0],r))]:n.map(i=>{if(i.type==="node"){const o=e+i.offset,s=(r==null?void 0:r.get(o))??o;return I.jsx(W1,{outerDeco:i.outerDeco,node:i.node,innerDeco:i.innerDeco,pos:o},s)}else return I.jsx(Vc,{childViews:[i],innerPos:e},uo(t,e,i,r))}):[]}function co({pos:n,node:e,innerDecorations:t}){const r=ua(),i=$1();if(!e)return null;const o=n+1,s=[];YM(e,t,(u,c,f,d)=>{const p=u.type.spec.marks??[];c?s.push({type:"native-widget",widget:u,marks:p,offset:f,index:d}):s.push({type:"widget",widget:u,marks:p,offset:f,index:d}),sE(s)},(u,c,f,d)=>{s.push({type:"node",node:u,marks:u.marks,innerDeco:f,outerDeco:c,offset:d}),lE(s)});const l=aE(s,o,r==null?void 0:r.doc,i==null?void 0:i.posToKey),a=s[s.length-1];return(!a||a.type!=="node"||a.node.isInline&&!a.node.isText||/\n$/.test(a.node.text))&&l.push(I.jsx(nE,{},"trailing-hack-img"),I.jsx(iE,{},"trailing-hack-br")),I.jsx(I.Fragment,{children:l})}const uE=C.forwardRef(function({className:e,node:t,innerDeco:r,outerDeco:i,as:o,viewDesc:s,...l},a){const u=C.useRef(null);C.useImperativeHandle(a,()=>u.current,[]);const c=L1(t,u,u,r,i,s),f={...l,ref:u,className:e,suppressContentEditableWarning:!0},d=o?C.cloneElement(o,f,I.jsx(dt.Provider,{value:c,children:I.jsx(co,{pos:-1,node:t,innerDecorations:r})})):C.createElement("div",f,I.jsx(dt.Provider,{value:c,children:I.jsx(co,{pos:-1,node:t,innerDecorations:r})}));if(!t)return d;const p=i.filter(m=>!m.inline);return p.length?p.reduce(pd,d):d}),U1=C.createContext(null);function cE({as:n,...e},t){const r=C.useRef(null),{setMount:i,...o}=C.useContext(U1);return C.useImperativeHandle(t,()=>r.current,[]),I.jsx(dt.Provider,{value:[],children:I.jsx(uE,{ref:s=>{r.current=s,i(s)},...e,...o,as:n})})}const fE=C.forwardRef(cE);function dE({className:n,children:e,nodeViews:t={},customNodeViews:r,...i}){var c;const[o,s]=C.useState(null),l=jM(o,{...i,nodeViews:r});KM(l.view);const a=l.view?aM(l.view,l.cursorWrapper):W.empty,u=l.view?iM(l.view):[];return I.jsx(Zo.Provider,{value:l,children:I.jsx(N1.Provider,{value:{nodeViews:t},children:I.jsx(U1.Provider,{value:{className:n,setMount:s,node:(c=l.view)==null?void 0:c.state.doc,innerDeco:a,outerDeco:u,viewDesc:l.docViewDescRef.current},children:e})})})}function hE(n){return I.jsx(qM,{children:I.jsx(dE,{...n})})}const J=new Cm({nodes:{doc:{content:"block+"},paragraph:{group:"block",content:"inline*",toDOM(){return["p",0]}},...Cx({cellContent:"inline*",cellAttributes:{},tableGroup:"block"}),footnote:{group:"inline",content:"text*",inline:!0,atom:!0,attrs:{number:{default:0}}},list:{group:"block",content:"list_item+",toDOM(){return["ul",0]}},list_item:{content:"paragraph+",toDOM(){return["li",0]}},image:{group:"block",toDOM(){return["div",["img",{src:"https://smoores.gitlab.io/storyteller/img/Storyteller_Logo.png",height:150,width:150}]]}},text:{group:"inline"}},marks:{em:{toDOM(){return["em",0]}},strong:{toDOM(){return["strong",0]}}}}),pE=cn.create({schema:J,doc:J.nodes.doc.create({},[J.nodes.paragraph.create({},[J.text("This ",[J.marks.em.create()]),J.text("is",[J.marks.em.create(),J.marks.strong.create()]),J.text(" the first paragraph")]),J.nodes.paragraph.create({},[J.text("This is the second paragraph"),J.nodes.footnote.create({number:1},J.text("Footnote"))]),J.nodes.paragraph.create(),J.nodes.image.create(),J.nodes.image.create(),J.nodes.paragraph.create({},J.text("This is the third paragraph 🫵")),J.nodes.table.create({},[J.nodes.table_row.create({},[J.nodes.table_header.create({},J.text("h1")),J.nodes.table_header.create({},J.text("h2"))]),J.nodes.table_row.create({},[J.nodes.table_cell.create({},J.text("c1")),J.nodes.table_cell.create({},J.text("c2"))])])]),plugins:[yM(),Jv({rules:[_v(/^\s*([-+*])\s$/,J.nodes.list)]}),_x(),eC()]}),mE=C.forwardRef(function({children:e,nodeProps:t,...r},i){return I.jsx("p",{ref:i,...r,children:e})}),gE=C.forwardRef(function({children:e,nodeProps:t,...r},i){return I.jsx("ul",{ref:i,...r,children:e})}),yE=C.forwardRef(function({children:e,nodeProps:t,...r},i){return I.jsx("li",{ref:i,...r,children:e})}),SE=C.forwardRef(function({nodeProps:e,...t},r){return I.jsx("span",{ref:r,...t,suppressContentEditableWarning:!0,contentEditable:"false",children:I.jsx("button",{children:e.node.attrs.number})})}),kE=C.forwardRef(function({widget:e,pos:t,...r},i){return I.jsx("span",{...r,ref:i,style:{display:"block",backgroundColor:"blue",width:"4px",height:"4px",position:"absolute",transform:"translateX(-2px)"},children:"Widget"})}),wE=new Ft({view(n){const e=n.coordsAtPos(n.state.selection.from),t=document.createElement("div");return t.style.width="4px",t.style.height="4px",t.style.position="absolute",t.style.top=`${e.top-2}px`,t.style.left=`${e.left-2}px`,t.style.backgroundColor="blue",document.body.appendChild(t),{update(r){const i=r.coordsAtPos(r.state.selection.from);t.style.top=`${i.top-2}px`,t.style.left=`${i.left-2}px`},destroy(){document.body.removeChild(t)}}}});new Ft({props:{decorations(n){return W.create(n.doc,[T1(n.selection.from,kE,{side:0,key:"widget-plugin-widget"})])}},view(n){const e=n.coordsAtPos(n.state.selection.from),t=document.createElement("div");return t.style.width="4px",t.style.height="4px",t.style.position="absolute",t.style.top=`${e.top-2}px`,t.style.left=`${e.left-2}px`,t.style.backgroundColor="blue",document.body.appendChild(t),{update(r){const i=r.coordsAtPos(r.state.selection.from);t.style.top=`${i.top-2}px`,t.style.left=`${i.left-2}px`},destroy(){document.body.removeChild(t)}}}});const vE=[jv({...Ik,"Mod-i":Fd(J.marks.em),"Mod-b":Fd(J.marks.strong)}),wE,Nv()],xE={paragraph:()=>{const n=document.createElement("p");return{dom:n,contentDOM:n}}};function CE(){const[n,e]=C.useState(pE),[t,r]=C.useState(!0);return I.jsxs("main",{children:[I.jsx("h1",{children:"React ProseMirror Demo"}),I.jsxs("button",{onClick:()=>{t?r(i=>!i):window.location.reload()},children:["Switch to"," ",t?"ProseMirror node views":"React node views (requires reload)"]}),I.jsx(hE,{className:"ProseMirror",state:n,dispatchTransaction:function(i){e(o=>o.apply(i))},plugins:vE,nodeViews:t?{paragraph:mE,list:gE,list_item:yE,footnote:SE}:void 0,customNodeViews:t?void 0:xE,children:I.jsx(fE,{as:I.jsx("article",{})})},`${t}`)]})}const NE=C1(document.getElementById("root"));NE.render(I.jsx(CE,{}));
